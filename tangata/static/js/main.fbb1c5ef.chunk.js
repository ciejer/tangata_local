(this.webpackJsonpsqlgui=this.webpackJsonpsqlgui||[]).push([[0],{153:function(e,t,n){},298:function(e,t,n){},636:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(12),o=n.n(r),c=(n(298),n(8)),i=n(142),l=n(78),d=n(79),u=n(82),j=n(81),h=n(16),b=n(66),p=n(288),m=(n(153),n(154),n(10)),O=n(18),f=n(184),x=n(649),g=n(642),v=n(6),y=n.n(v),C=n(9);function k(){return(k=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/users/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/users",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return N.apply(this,arguments)}function N(){return(N=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/refresh_metadata",{method:"POST",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return T.apply(this,arguments)}function T(){return(T=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_user_config/",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=n(1);function L(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),s=n[0],r=n[1],o=Object(a.useState)(""),c=Object(m.a)(o,2),i=c[0],l=c[1],d=Object(a.useState)(""),u=Object(m.a)(d,2),j=u[0],b=u[1],p=Object(a.useState)(""),v=Object(m.a)(p,2),y=v[0],C=v[1],N=Object(h.g)();return("python"===e.hostVersion||Object.keys(e.user).length>0)&&N.push("/"),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("nav",{class:"navbar-dark bg-brand position-fixed w-100 z-100 navbar navbar-expand-xl navbar-light",children:Object(_.jsx)("div",{class:"navbar-brand",children:"T\u0100NGATA"})}),Object(_.jsxs)("div",{className:"Login",children:[Object(_.jsxs)(x.a,{defaultActiveKey:"login",id:"loginOrRegister",children:[Object(_.jsx)(g.a,{eventKey:"login",title:"Login",children:Object(_.jsxs)(O.a,{onSubmit:function(t){t.preventDefault(),function(e){return k.apply(this,arguments)}({user:{email:s,password:i}}).then((function(t){e.setUser(t),sessionStorage.setItem("user",JSON.stringify(t)),w(t.user),M(t.user).then((function(t){e.setUserConfig(t.user)}))}))},children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"loginEmail",children:[Object(_.jsx)(O.a.Label,{children:"Email"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"email",value:s,onChange:function(e){return r(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"loginPassword",children:[Object(_.jsx)(O.a.Label,{children:"Password"}),Object(_.jsx)(O.a.Control,{type:"password",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(_.jsx)(f.a,{block:!0,size:"lg",type:"submit",disabled:!(s.length>0&&i.length>0),children:"Login"})]})}),Object(_.jsx)(g.a,{eventKey:"register",title:"Sign Up",children:Object(_.jsxs)(O.a,{onSubmit:function(t){t.preventDefault(),function(e){return S.apply(this,arguments)}({user:{email:s,password:i,config:{firstname:j,lastname:y}}}).then((function(t){e.setUser(t),sessionStorage.setItem("user",JSON.stringify(t)),w(t.user),M(t.user).then((function(t){e.setUserConfig(t.user)}))}))},children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"registerEmail",children:[Object(_.jsx)(O.a.Label,{children:"Email"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"email",value:s,onChange:function(e){return r(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"registerPassword",children:[Object(_.jsx)(O.a.Label,{children:"Password"}),Object(_.jsx)(O.a.Control,{type:"password",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"First Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:j,onChange:function(e){return b(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"lastname",children:[Object(_.jsx)(O.a.Label,{children:"Last Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:y,onChange:function(e){return C(e.target.value)}})]}),Object(_.jsx)(f.a,{block:!0,size:"lg",type:"submit",disabled:!(s.length>0&&i.length>0&&j.length>0),children:"Sign Up"})]})})]}),Object(_.jsxs)("div",{className:"container md-3 text-center col-md-5 mt-3",children:[Object(_.jsx)("blockquote",{children:Object(_.jsxs)("p",{children:["\u201cHutia te rito o te harakeke",Object(_.jsx)("br",{}),"Kei whea to k\u014dmako e k\u014d?",Object(_.jsx)("br",{}),"Ki mai ki ahau",Object(_.jsx)("br",{}),"He aha te mea nui o te Ao?",Object(_.jsx)("br",{}),"Maku e k\u012b atu,",Object(_.jsx)("br",{}),Object(_.jsx)("b",{children:"he t\u0101ngata, he t\u0101ngata, he t\u0101ngata"}),'..."']})}),Object(_.jsxs)("p",{children:["If the heart of the harakeke ",Object(_.jsx)("em",{children:"(flax plant)"})," was removed,",Object(_.jsx)("br",{}),"where would the bellbird sing?",Object(_.jsx)("br",{}),"If I was asked what was the most important thing in the world",Object(_.jsx)("br",{}),"I would be compelled to reply,",Object(_.jsx)("br",{}),"it is people, it is people, it is people.",Object(_.jsx)("br",{}),Object(_.jsx)("em",{children:"Ngaroto"})]}),Object(_.jsxs)("p",{children:["In te ao M\u0101ori (the M\u0101ori world view), T\u0101ngata (",Object(_.jsx)("em",{children:"TAHNG-uh-tuh"}),") describes something much larger than an addressed group of people: it describes ",Object(_.jsx)("em",{children:"whakapapa"}),", the surrounding network of ancestors and descendants we are connected to.",Object(_.jsx)("br",{}),"With this work we intend to follow these principles to put our people first: not just the data & analytics engineers, but those around our workplaces that know the deep details of how our businesses actually run.",Object(_.jsx)("br",{}),"These people are the lifeblood of what we do - and to keep moving forward, we need their context far more than ever."]})]})]})]})}n(340);function D(e,t){return A.apply(this,arguments)}function A(){return(A=Object(C.a)(y.a.mark((function e(t,n){var a,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete(a=Object(c.a)({},n))._id,delete a.email,delete a.token,e.next=6,fetch("/api/v1/set_user_config",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+t.token},body:JSON.stringify(a)});case 6:return s=e.sent,e.next=9,s;case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){return I.apply(this,arguments)}function I(){return(I=Object(C.a)(y.a.mark((function e(t,n,a){var s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/file_upload",{method:"POST",headers:{Authorization:"Token "+a.token,UploadType:n},body:t});case 2:return s=e.sent,e.next=5,s;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_dbt_cloud_accounts",{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return(R=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_dbt_cloud_jobs/"+n,{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return a=e.sent,e.next=5,a;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),s=n[0],r=n[1],o=Object(a.useState)("LiveDB"),i=Object(m.a)(o,2),l=(i[0],i[1],Object(a.useState)({})),d=Object(m.a)(l,2),u=d[0],j=d[1],h=Object(a.useState)({}),b=Object(m.a)(h,2),p=b[0],v=b[1],y=Object(a.useRef)(null),C=Object(a.useRef)(null),k=Object(a.useRef)(null),S=Object(a.useRef)(null);function N(t,n){var a=Object(c.a)({},e.userConfig);a[n]=t,e.setUserConfig(a),D(e.user,a)}function M(t,n){if(t.length>0){var a=new FormData;a.append("file",t[0]),F(a,n,e.user).then((function(t){!0===t.ok?e.toastSender(n+" Upload Successful.","success"):t.text().then((function(t){e.toastSender(n+" Upload Failed: \n"+t,"error")}))}))}}function T(){(function(e){return P.apply(this,arguments)})(e.user).then((function(e){return e.json()})).then((function(e){j(e),L()}))}function L(){(function(e,t){return R.apply(this,arguments)})(e.user,k.current.value).then((function(e){return e.json()})).then((function(e){v(e)}))}return Object(_.jsxs)("div",{className:"container mt-3",children:[Object(_.jsx)("h1",{children:"Config"}),Object(_.jsxs)(x.a,{defaultActiveKey:"userdetails",id:"config",children:[Object(_.jsx)(g.a,{eventKey:"userdetails",title:"User Details",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"First Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.firstname,onChange:function(e){return N(e.target.value,"firstname")}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"lastname",children:[Object(_.jsx)(O.a.Label,{children:"Last Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.lastname,onChange:function(e){return N(e.target.value,"lastname")}})]})]})}),Object(_.jsx)(g.a,{eventKey:"gitConfig",title:"Git Config",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"gitSSHKey",children:[Object(_.jsx)(O.a.Label,{children:"SSH Key"}),Object(_.jsx)("br",{}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(t){t.stopPropagation(),e.setSSHKey()},className:"m-1",children:"Get current SSH public key"}),Object(_.jsx)(f.a,{variant:"warning",className:"m-1",onClick:function(t){t.stopPropagation(),"New Key"===prompt("This will delete any current SSH keys. Please type 'New Key' to continue")&&e.generateSSHKey()},children:"Create new SSH Key"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"textarea",rows:2,value:e.sshKey,ref:y}),document.queryCommandSupported("copy")&&Object(_.jsxs)("div",{children:[Object(_.jsx)(f.a,{variant:"primary",onClick:function(e){y.current.select(),document.execCommand("copy"),e.target.focus(),r("Copied!")},className:"m-1",children:"Copy"}),s]}),Object(_.jsxs)(O.a.Text,{id:"gitSSHHelpBlock",muted:!0,children:["Where to add your key:",Object(_.jsx)("br",{}),Object(_.jsx)("a",{href:"https://github.com/settings/ssh/new",children:"GitHub SSH Keys - Add New"}),Object(_.jsx)("br",{}),Object(_.jsx)("a",{href:"https://gitlab.com/profile/keys",children:"GitLab SSH Keys - Add an SSH key"}),Object(_.jsx)("br",{})]})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"gitrepo",children:[Object(_.jsx)(O.a.Label,{children:"Git SSH URL"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.gitrepo||"",onChange:function(e){return N(e.target.value,"gitrepo")}}),Object(_.jsxs)(O.a.Text,{id:"gitSSHHelpBlock",muted:!0,children:["Examples:",Object(_.jsx)("br",{}),"git@github.com:yourname/yourproject.git",Object(_.jsx)("br",{}),"git@gitlab.com:yourname/yourproject.git"]})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),e.openGitConnection()},children:"Clone Git Repository"})]})}),Object(_.jsx)(g.a,{eventKey:"dbtConfig",title:"DBT Config",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbtConfigMethod",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Config Method"}),Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"Live Database Connection",type:"radio",id:"LiveDB",checked:"LiveDB"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),N("LiveDB","dbtmethod")}}),Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"Upload Compiled Metadata",type:"radio",id:"UploadMetadata",checked:"UploadMetadata"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),N("UploadMetadata","dbtmethod")}}),Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"dbt_ Cloud API",type:"radio",id:"Cloud",checked:"Cloud"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),N("Cloud","dbtmethod")}})]},"custom-inline-radio")]}),Object(_.jsx)("hr",{}),Object(_.jsxs)("div",{className:"LiveDB"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadProfilesYML",children:[Object(_.jsx)(O.a.Label,{children:"Upload Profiles.YML"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"profilesYMLUpload",onChange:function(e){return M(e.target.files,"ProfilesYML")},id:"profilesYMLUpload",feedbackTooltip:!0}),Object(_.jsxs)(O.a.Text,{id:"profilesYMLHelpBlock",muted:!0,children:["To connect to your database, DBT requires a profiles.yml file. See ",Object(_.jsx)("a",{href:"https://docs.getdbt.com/dbt-cli/configure-your-profile",children:"the dbt_ docs"})," for setup details."]})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),e.checkDBTConnection()},children:"Check DBT Connection"})]}),Object(_.jsxs)("div",{className:"UploadMetadata"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsx)("p",{children:Object(_.jsxs)("i",{children:["To run without connecting to your database, the catalog requires metadata from dbt_.",Object(_.jsx)("br",{}),"Run ",Object(_.jsx)("code",{children:"dbt docs generate"})," in your dbt_ project, and upload the Manifest and Catalog from /target."]})}),Object(_.jsx)("p",{children:Object(_.jsxs)("i",{children:["To automate this upload, download ",Object(_.jsx)("code",{children:"tangata_refresh.py"})," from the Tangata git repository, and run it in the root of your project."]})}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadManifestJSON",children:[Object(_.jsx)(O.a.Label,{children:"Upload manifest.json"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"manifestJSONUpload",onChange:function(e){return M(e.target.files,"ManifestJSON")},id:"manifestJSONUpload",feedbackTooltip:!0})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadCatalogJSON",children:[Object(_.jsx)(O.a.Label,{children:"Upload catalog.json"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"catalogJSONUpload",onChange:function(e){return M(e.target.files,"CatalogJSON")},id:"catalogJSONUpload",feedbackTooltip:!0})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),w(e.user)},children:"Load Metadata"})]}),Object(_.jsxs)("div",{className:"Cloud"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud API Key"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",placeholder:"Change dbt_ Cloud Key",ref:C})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),function(t){if(t.length>0){var n=new FormData,a=new Blob([t],{type:"text/plain"});n.append("file",a),F(n,"dbt_ Cloud Key",e.user).then((function(t){!0===t.ok?e.toastSender("dbt_ Cloud Key Upload Successful.","success"):t.text().then((function(t){e.toastSender("dbt_ Cloud Key Upload Failed: \n"+t,"error")}))}))}}(C.current.value),T()},children:"Load dbt_ Cloud Accounts"}),u.length>0?Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbt_cloud_accounts",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud Accounts"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"select",custom:!0,ref:k,onChange:function(e){return L()},children:u.map((function(e,t){return Object(_.jsxs)("option",{value:e.id,children:[e.id,": ",e.name]},"dbt account "+t)}))})]}):null,p.length>0?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbt_cloud_jobs",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud Jobs"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"select",custom:!0,ref:S,children:p.map((function(e,t){return Object(_.jsxs)("option",{value:e.id,children:[e.id,": ",e.name]},"dbt job "+t)}))})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),function(){var t=Object(c.a)({},e.userConfig);t.dbt_cloud_account=k.current.value,t.dbt_cloud_job=S.current.value,D(e.user,t),e.setUserConfig(t)}()},children:"Save"})]}):null]})]})})]})]})}var U=n(11),H=n(643),z=n(645),B=n(289),E=n(141),G=n(646),J=n(100),V=n(648),q=n(139);function Q(e){var t=e.model,n=e.modelIndex,s=e.saveEditedModel,r=e.models,o=e.toggleJoinModal,i=e.showJoinModal,l=Object(a.useState)(t),d=Object(m.a)(l,2),u=d[0],j=d[1],h=Object(q.a)(),b=h.register,p=h.handleSubmit;if(0===n)return null;var x=function(){return o(-1)},g=function(e,t,n){return!1===n?Object(_.jsx)("tr",{className:"row",children:Object(_.jsx)("td",{className:"col w-100",children:e.fullName})},"joinCondition_"+t):Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"p-2",children:e.fullName}),Object(_.jsx)("td",{className:"w-md-auto p-2",children:Object(_.jsx)(f.a,{variant:"secondary",onClick:function(){return function(e){j(Object(c.a)(Object(c.a)({},u),{},{joinConditions:u.joinConditions.filter((function(t){return t!==e}))}))}(e)},children:"Remove"})})]},"joinCondition_"+t)},v=function(e){return u.joinConditions.map((function(t,n){return g(t,n,e)}))},y=function(e,t,n,a){for(var s={},r=0;r<e.response.models.length;r++)e.response.models[r].name===t&&(s=e.response.models[r]);if(null===s)return null;if(0===s.columns.length)return null;var o=s.columns.map((function(e,t){return function(e,t){return Object(_.jsx)("option",{children:e},t)}(e,t)}));return Object(_.jsx)(O.a.Control,{as:"select",name:a,ref:n,children:o})};return Object(_.jsxs)("div",{children:[Object(_.jsx)(f.a,{variant:"primary",onClick:function(){j(JSON.parse(JSON.stringify(t))),o(n)},children:"Edit Join"}),Object(_.jsx)("table",{className:"table",children:Object(_.jsx)("tbody",{children:v(!1)})}),Object(_.jsxs)(V.a,{show:i===n,onHide:x,size:"lg",children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:"Edit Join "})}),Object(_.jsxs)(V.a.Body,{children:[Object(_.jsxs)(H.a,{children:[Object(_.jsx)("h5",{children:"Join Conditions"}),Object(_.jsx)("table",{className:"table-striped table-bordered w-100",children:Object(_.jsx)("tbody",{children:v(!0)})})]}),Object(_.jsxs)(H.a,{className:"mt-3",children:[Object(_.jsx)("h5",{children:"Add new Join Condition"}),Object(_.jsx)(O.a,{onSubmit:p((function(e){var a={conditionField1:{model:t.name,column:e.condition1Field},conditionOperator:e.conditionOperator,conditionField2:{model:r.response.models[n-1].name,column:e.condition2Field},fullName:t.name+"."+e.condition1Field+" "+e.conditionOperator+" "+r.response.models[n-1].name+"."+e.condition2Field};j(Object(c.a)(Object(c.a)({},u),{},{joinConditions:u.joinConditions.concat(a)}))})),children:Object(_.jsxs)("div",{className:"row text-center ",children:[Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:t.name}),y(r,t.name,b,"condition1Field")]})}),Object(_.jsx)("div",{className:"col-md-auto",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:"Operator type"}),Object(_.jsxs)(O.a.Control,{name:"conditionOperator",as:"select",ref:b,children:[Object(_.jsx)("option",{children:"="}),Object(_.jsx)("option",{children:">="}),Object(_.jsx)("option",{children:"<="})]})]})}),Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:r.response.models[n-1].name}),y(r,r.response.models[n-1].name,b,"condition2Field")]})}),Object(_.jsx)("div",{className:"col-md-auto",children:Object(_.jsx)(f.a,{variant:"primary",type:"submit",className:"joinConditionAddButton",children:"Add"})})]})})]})]}),Object(_.jsxs)(V.a.Footer,{children:[Object(_.jsx)(f.a,{variant:"secondary",onClick:x,children:"Close"}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(){s(t,u),x()},children:"Save Changes"})]})]})]})}var Y=n(647),W=n(644);function X(e){var t=e.models,n=e.modelDragEnd,s=e.showColumns,r=e.saveEditedModel,o=e.toggleJoinModal,i=e.showJoinModal,l=e.highlightedColumns,d=e.openContextMenu,u=e.contextMenuOpen,j=e.editSelect,h=Object(a.useState)({x:null,y:null,display:!1}),b=Object(m.a)(h,2),p=b[0],O=b[1];if(0===t.length)return null;!1===u&&!0===p.display&&O({x:null,y:null,display:!1});var f=function(e,n,a,s,o,i,l){var u=function(t,n){var a=t.map((function(t,n){return function(t,n){for(var a=function(e){"click"===e.type?(O({x:null,y:null,display:!1}),d(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===p.display?(O({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),d(!0)):(O({x:null,y:null,display:!1}),d(!1)))},s=!1,r=0;r<i.length;r++)e.name===i[r].model&&t===i[r].column&&(s=!0);return Object(_.jsxs)("tr",{className:n%2===0?"odd":"even",onClick:function(e){return a(e)},onContextMenu:function(e){return a(e)},"data-model":e.name,"data-column":t,children:[Object(_.jsx)("td",{className:"col-md-auto "+(s?"highlightColumn":null),children:n+1}),Object(_.jsx)("td",{className:"col "+(s?"highlightColumn":null),children:t})]},n)}(t,n)}));return Object(_.jsx)("tbody",{children:a})};return Object(_.jsx)(J.b,{draggableId:e.name,index:n,children:function(i,l){return Object(_.jsxs)("div",Object(c.a)(Object(c.a)(Object(c.a)({ref:i.innerRef},i.draggableProps),i.dragHandleProps),{},{className:"col removeFocusOutline",children:[Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center font-weight-bold",children:e.name}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center font-italic mb-3",children:e.description}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center",children:Object(_.jsx)(Q,{model:e,saveEditedModel:r,models:t,showJoinModal:s,toggleJoinModal:o,modelIndex:n})}),Object(_.jsx)("table",{className:"table table-bordered table-striped table-hover w-100",children:!0===a?u(e.columns):null})]}))}},"model_"+e.name)},x=function(e,t,n,a){return e.response.models.map((function(e,s){return f(e,s,t,n,a,l)}))};return Object(_.jsxs)("div",{className:"text-center",children:[Object(_.jsx)("h2",{children:"Models"}),Object(_.jsx)("div",{className:"container",children:Object(_.jsx)(J.a,{onDragEnd:n,children:Object(_.jsx)(J.c,{droppableId:"droppable",children:function(e,n){return Object(_.jsxs)("div",Object(c.a)(Object(c.a)({},e.droppableProps),{},{ref:e.innerRef,children:[x(t,s,i,o),e.placeholder]}))}})})}),function(e,t){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsx)("tbody",{children:Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t={inputColumns:[{model:e.target.parentNode.dataset.model,column:e.target.parentNode.dataset.column}],alias:e.target.parentNode.dataset.column},j(null,t),void d(!1);var t},children:"Add to Output"})})})})})})})}(p)]})}var Z=n(30),$=n(291),ee=n.n($),te=n(185),ne=n.n(te),ae=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).isTrigger=s.isTrigger.bind(Object(Z.a)(s)),s.getMatch=s.getMatch.bind(Object(Z.a)(s)),s.handleChange=s.handleChange.bind(Object(Z.a)(s)),s.handleKeyDown=s.handleKeyDown.bind(Object(Z.a)(s)),s.handleResize=s.handleResize.bind(Object(Z.a)(s)),s.handleSelection=s.handleSelection.bind(Object(Z.a)(s)),s.updateCaretPosition=s.updateCaretPosition.bind(Object(Z.a)(s)),s.updateHelper=s.updateHelper.bind(Object(Z.a)(s)),s.resetHelper=s.resetHelper.bind(Object(Z.a)(s)),s.renderAutocompleteList=s.renderAutocompleteList.bind(Object(Z.a)(s)),s.state={helperVisible:!1,left:0,matchLength:0,matchStart:0,options:[],fullOptions:[],selection:0,top:0,value:null},s.recentValue=e.defaultValue,s.enableSpaceRemovers=!1,s.refInput=Object(a.createRef)(),s}return Object(d.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentDidUpdate",value:function(e){var t=this.props.options,n=this.props.fullOptions,a=this.state.caret;t.length!==e.options.length&&this.updateHelper(this.recentValue,a,t,n)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"getMatch",value:function(e,t,n,a){for(var s=this,r=this.props,o=r.trigger,c=r.matchAny,i=r.regex,l=new RegExp(i),d=o.length,u=o.match(l),j=t-1;j>=0;--j){var h=e.substring(j,t).match(l),b=-1;if(d>0){var p=u?j:j-d+1;if(p<0)return null;if(this.isTrigger(e,p)&&(b=p+d),!h&&b<0)return null}else{if(h&&j>0)continue;if(t-(b=0===j&&h?0:j+1)===0)return null}if(b>=0){var m,O,f=function(){var a=e.substring(b,t),r=n.filter((function(e){var t=e.toLowerCase().indexOf(a.toLowerCase());return-1!==t&&(c||0===t)}));for(m=[],O=0;O<n.length;O++){var o=n[O].toLowerCase().indexOf(a.toLowerCase());-1===o||!c&&0!==o||m.push(s.props.fullOptions[O])}s.setState({fullOptions:m});var i=a.length;return{v:{matchStart:b,matchLength:i,options:r}}}();if("object"===typeof f)return f.v}}return null}},{key:"isTrigger",value:function(e,t){var n=this.props.trigger;return!n||!n.length||e.substr(t,n.length)===n}},{key:"handleChange",value:function(e){var t=this.props,n=t.onChange,a=t.options,s=t.fullOptions,r=t.spaceRemovers,o=t.spacer,c=t.value,i=this.recentValue,l=e.target.value,d=ne()(e.target).end;if(l.length||this.setState({helperVisible:!1}),this.recentValue=l,this.setState({caret:d,value:e.target.value}),!l.length||!d)return n(e.target.value);if(this.enableSpaceRemovers&&r.length&&l.length>2&&o.length){for(var u=0;u<Math.max(i.length,l.length);++u)if(i[u]!==l[u]){if(u>=2&&l[u-1]===o&&-1===r.indexOf(l[u-2])&&-1!==r.indexOf(l[u])&&this.getMatch(l.substring(0,u-2),d-3,a,s)){var j="".concat(l.slice(0,u-1)).concat(l.slice(u,u+1)).concat(l.slice(u-1,u)).concat(l.slice(u+1));return this.updateCaretPosition(u+1),this.refInput.current.value=j,c||this.setState({value:j}),n(j)}break}this.enableSpaceRemovers=!1}return this.updateHelper(l,d,a,s),c||this.setState({value:e.target.value}),n(e.target.value)}},{key:"handleKeyDown",value:function(e){var t=this.state,n=t.helperVisible,a=t.options,s=t.selection,r=this.props,o=r.onKeyDown,c=r.passThroughEnter;if(n)switch(e.keyCode){case 27:e.preventDefault(),this.resetHelper();break;case 38:e.preventDefault(),this.setState({selection:(a.length+s-1)%a.length});break;case 40:e.preventDefault(),this.setState({selection:(s+1)%a.length});break;case 14:case 13:c||e.preventDefault(),this.handleSelection(s);break;case 9:this.handleSelection(s);break;default:o(e)}else o(e)}},{key:"handleResize",value:function(){this.setState({helperVisible:!1})}},{key:"handleSelection",value:function(e){var t=this.state,n=t.matchStart,a=t.matchLength,s=t.fullOptions,r=this.props,o=r.spacer,c=r.onSelect,i=s[e],l=this.recentValue,d=l.substring(0,n),u=l.substring(n+a),j={target:this.refInput.current};j.target.value="".concat(d).concat(i).concat(o).concat(u),this.handleChange(j),c(j.target.value),this.resetHelper(),this.updateCaretPosition(d.length+i.length+1),this.enableSpaceRemovers=!0}},{key:"updateCaretPosition",value:function(e){var t=this;this.setState({caret:e},(function(){return Object(te.setCaretPosition)(t.refInput.current,e)}))}},{key:"updateHelper",value:function(e,t,n,a){var s=this.refInput.current,r=this.getMatch(e,t,n,a);if(r){var o=ee()(s,t),i=s.getBoundingClientRect(),l=o.top+s.offsetTop,d=Math.min(o.left+s.offsetLeft-10,s.offsetLeft+i.width-100),u=this.props,j=u.minChars,h=u.onRequestOptions,b=u.requestOnlyIfNoOptions;r.matchLength>=j&&(r.options.length>1||1===r.options.length&&r.options[0].length!==r.matchLength)?this.setState(Object(c.a)({helperVisible:!0,top:l,left:d},r)):(b&&r.options.length||h(e.substr(r.matchStart,r.matchLength)),this.resetHelper())}else this.resetHelper()}},{key:"resetHelper",value:function(){this.setState({helperVisible:!1,selection:0})}},{key:"renderAutocompleteList",value:function(){var e=this,t=this.state,n=t.helperVisible,a=t.left,s=t.matchStart,r=t.matchLength,o=t.options,c=(t.fullOptions,t.selection),i=t.top,l=t.value;if(!n)return null;var d=this.props,u=d.maxOptions,j=d.offsetX,h=d.offsetY;if(0===o.length)return null;if(c>=o.length)return this.setState({selection:0}),null;var b=0===u?o.length:u,p=o.slice(0,b).map((function(t,n){var a=t.toLowerCase().indexOf(l.substr(s,r).toLowerCase());return Object(_.jsxs)("li",{className:n===c?"active":null,onClick:function(){e.handleSelection(n)},onMouseEnter:function(){e.setState({selection:n})},children:[t.slice(0,a),Object(_.jsx)("strong",{children:t.substr(a,r)}),t.slice(a+r)]},t)}));return Object(_.jsx)("ul",{className:"react-autocomplete-input",style:{left:a+j,top:i+h},children:p})}},{key:"render",value:function(){var e=this.props,t=e.Component,n=e.defaultValue,a=e.disabled,s=e.onBlur,r=e.value,o=Object(i.a)(e,["Component","defaultValue","disabled","onBlur","value"]),l=this.state.value,d=Object.assign({},o);Object.keys(this.constructor.propTypes).forEach((function(e){delete d[e]}));var u="";return"undefined"!==typeof r&&null!==r?u=r:l?u=l:n&&(u=n),Object(_.jsxs)("span",{children:[Object(_.jsx)(t,Object(c.a)({disabled:a,onBlur:s,onChange:this.handleChange,onKeyDown:this.handleKeyDown,ref:this.refInput,value:u},d)),this.renderAutocompleteList()]})}}]),n}(s.a.Component);ae.defaultProps={Component:"textarea",defaultValue:"",disabled:!1,maxOptions:6,onBlur:function(){},onChange:function(){},onKeyDown:function(){},onRequestOptions:function(){},onSelect:function(){},options:[],fullOptions:[],regex:"^[A-Za-z0-9\\-_]+$",matchAny:!1,minChars:0,requestOnlyIfNoOptions:!0,spaceRemovers:[",",".","!","?"],spacer:" ",trigger:"@",offsetX:0,offsetY:0,value:null,passThroughEnter:!1};var se=ae,re=function(e){var t=e.models,n=e.conditions,r=e.editCondition,o=e.openContextMenu,c=e.contextMenuOpen,i=Object(a.useState)({x:null,y:null,display:!1}),l=Object(m.a)(i,2),d=l[0],u=l[1],j=Object(a.useState)({show:!1,conditionToEdit:null}),h=Object(m.a)(j,2),b=h[0],p=h[1],x=Object(q.a)();x.register,x.handleSubmit;if(!1===c&&!0===d.display&&u({x:null,y:null,display:!1}),0===t.length)return null;return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"text-center",children:"Conditions"}),Object(_.jsxs)("div",{children:[function(e,t,n){if(0===e.length)return null;for(var a=function(e){"click"===e.type?(u({x:null,y:null,display:!1}),n(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===d.display?(u({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),n(!0)):(u({x:null,y:null,display:!1}),n(!1)))},s=function(e,t,n){return Object(_.jsx)("tr",{className:"componentRow ",onClick:n,onContextMenu:n,children:Object(_.jsx)("td",{md:"auto",className:"fullSize",children:Object(_.jsx)("div",{className:"componentContent",children:e})})},t)},r=[],o=0;o<e.length;o++)r.push(s(e[o],o,a));return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center",children:"Add / Remove Conditions to filter results"}),Object(_.jsx)(W.a,{striped:!0,bordered:!0,children:Object(_.jsx)("tbody",{children:r})})]})}(n,0,o),function(e){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return e.target.firstChild.data,p({show:!0,conditionToEdit:e.target.firstChild.data}),void o(!1)},children:Object(_.jsx)("div",{children:"Edit Condition"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.firstChild.data,r(t,null),void o(!1);var t},children:"Delete Condition"})})]})})})})})}(d),function(e,n,a){if(!1===e.menuOpen)return null;var r=s.a.createRef();return Object(_.jsx)("div",{children:Object(_.jsxs)(V.a,{show:e.show,onHide:n,children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:"Edit Join "})}),Object(_.jsxs)(V.a.Body,{children:["Join Conditions:",Object(_.jsx)(O.a,{children:Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:"Condition Criteria"}),Object(_.jsx)(se,{className:"form-control",rows:3,ref:r,options:function(){for(var e=[],n=0;n<t.response.models.length;n++)for(var a=0;a<t.response.models[n].columns.length;a++)e.push(t.response.models[n].columns[a]),e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]);return e}(),fullOptions:function(){for(var e=[],n=0;n<t.response.models.length;n++)for(var a=0;a<t.response.models[n].columns.length;a++)e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]),e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]);return e}(),trigger:"",defaultValue:e.conditionToEdit})]})})})})]}),Object(_.jsxs)(V.a.Footer,{children:[Object(_.jsx)(f.a,{variant:"secondary",onClick:n,children:"Close"}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(){a(e.conditionToEdit,r.current.recentValue),n()},children:"Save Changes"})]})]})})}(b,(function(){return p({show:!1,conditionToEdit:null})}),r)]}),Object(_.jsx)("div",{className:"pt-2 text-center",children:Object(_.jsx)(f.a,{variant:"primary",onClick:function(){return p({show:!0,conditionToEdit:null})},children:"Add Condition"})})]})};function oe(e){var t=e.models,n=e.openContextMenu,s=e.contextMenuOpen,r=e.selects,o=e.editSelect,i=e.highlightColumn,l=e.outputModel,d=(e.editOutputModel,Object(a.useState)({x:null,y:null,display:!1})),u=Object(m.a)(d,2),j=u[0],h=u[1],b=Object(a.useState)(-1),p=Object(m.a)(b,2),f=p[0],x=p[1],g=Object(a.useState)(-1),v=Object(m.a)(g,2),y=v[0],C=v[1];if(0===t.length)return null;!1===s&&!0===j.display&&h({x:null,y:null,display:!1});return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"text-center",children:"Output"}),Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center",children:l.name}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center font-italic mb-3",children:l.description?l.description:"New Model"}),Object(_.jsx)("table",{className:"table table-striped table-hover w-100",children:Object(_.jsx)("tbody",{children:function(e,t,n,a){for(var s=function(e){"click"===e.type?(h({x:null,y:null,display:!1}),a(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===j.display?(h({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),a(!0)):(h({x:null,y:null,display:!1}),a(!1)))},r=function(e){e.preventDefault(),x(-1),o(t[f],Object(c.a)(Object(c.a)({},t[f]),{},{alias:e.target.value}))},i=function(e){e.preventDefault(),C(-1),o(t[y],Object(c.a)(Object(c.a)({},t[y]),{},{description:e.target.value}))},l=function(e,t){return f===t?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(O.a,{onSubmit:function(e){return e.preventDefault()},children:Object(_.jsx)(O.a.Group,{children:Object(_.jsx)(O.a.Control,{type:"text",defaultValue:null!==e[t].alias&&void 0!==e[t].alias?e[t].alias:e[t].column,onBlur:function(e){return r(e)},placeholder:"Add name for output field",autoFocus:!0})})})}):Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:"w-100 text-dark text-right","data-selectindex":t,children:null!==e[t].alias&&void 0!==e[t].alias?e[t].alias:e[t].column})})},d=function(e,t){return y===t?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(O.a,{onSubmit:function(e){return e.preventDefault()},children:Object(_.jsx)(O.a.Group,{children:Object(_.jsx)(O.a.Control,{type:"text",defaultValue:null!==e[t].description&&void 0!==e[t].description?e[t].description:null,onBlur:function(e){return i(e)},placeholder:"Add description for output field",autoFocus:!0})})})}):null!==e[t].description&&void 0!==e[t].description?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:"w-100 text-dark text-right font-italic","data-selectindex":t,children:e[t].description})}):null},u=function(e){var t=[];if(void 0!==e&null!==e)for(var a=0;a<e.inputColumns.length;a++)t.push(e.inputColumns[a]);n(t)},b=[],p=function(e){b.push(Object(_.jsx)("tr",{onMouseEnter:function(){return u(t[e])},onMouseLeave:function(){return u()},onClick:function(e){return s(e)},onContextMenu:function(e){return s(e)},children:Object(_.jsxs)("td",{"data-selectindex":e,children:[l(t,e),d(t,e)]})},e))},m=0;m<t.length;m++)p(m);return b}(0,r,i,n)})}),function(e,t){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"left-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.dataset.selectindex,x(parseInt(t)),void n(!1);var t},children:Object(_.jsx)("div",{children:"Edit Name"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.dataset.selectindex,C(parseInt(t)),void n(!1);var t},children:Object(_.jsx)("div",{children:"Edit Description"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return a=t[e.target.dataset.selectindex],o(a,null),void n(!1);var a},children:"Delete Field"})})]})})})})})}(j,r)]})}function ce(){return(ce=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/model_old/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(e){if(0===e.length)return null;for(var t=e[0].fullName,n=1;n<e.length;n++)t+="\n  AND "+e[n].fullName;return t},le=function(e){var t="SELECT\n",n=function(e){return function(e){return"definition"in e?e.definition:e.inputColumns[0].model+"."+e.inputColumns[0].column}(e)+" AS "+e.alias};if(0!==e.selects.length){t+="  "+n(e.selects[0])+"\n";for(var a=1;a<e.selects.length;a++)t+="  , "+n(e.selects[a])+"\n"}else t+="  *\n";return t},de=function(e){var t="",n=function(e){return'{{ ref("'+e.name+'") }} AS '+e.name};if(0!==e.models.length){t+="FROM "+n(e.models.response.models[0])+"\n";for(var a=1;a<e.models.response.models.length;a++)t+="LEFT JOIN "+n(e.models.response.models[a])+"\n  ON "+ie(e.models.response.models[a].joinConditions)+"\n"}else t+="FROM "+e.outputModel;return t},ue=function(e){var t="";if(0!==e.models.length){t+="WHERE "+e.conditions[0]+"\n";for(var n=1;n<e.conditions.length;n++)t+="  AND "+e.conditions[n]+"\n"}else t+="FROM "+e.outputModel;return t},je=function(e){var t=e.state;return Object(_.jsxs)("div",{children:["Generated SQL:",Object(_.jsxs)("div",{className:"sqlContent",children:[le(t),de(t),ue(t)]})]})},he=(a.Component,n(650));function be(){return(be=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/model_search/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pe=function(e){e.addModel;var t=e.hostVersion,n=e.logState,s=(e.openSQLPanel,e.openModelBuilder,e.openCatalog,e.openConfig,e.appState,e.contextMenuOpen),r=e.openContextMenu,o=(e.selectModel,e.user),c=e.setUser,i=e.userConfig,l=e.setUserConfig,d=Object(a.useState)(!1),u=Object(m.a)(d,2),j=u[0],b=u[1],p=Object(a.useState)([]),O=Object(m.a)(p,2),f=O[0],x=O[1],g=Object(h.g)(),v=Object(a.useRef)(null);!1===s&&!0===j&&b(!1);var y,C=function(e,t){return Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col-sm",children:Object(_.jsxs)("div",{className:"container",onClick:function(e){return function(e,t){r(!1),b(!1),e.stopPropagation(),g.push("/catalog/"+f[t].nodeID)}(e,t)},children:[Object(_.jsxs)("div",{className:"row",children:[Object(_.jsx)("div",{className:"col font-weight-bold",children:e.modelName.toLowerCase()}),Object(_.jsx)("div",{className:"col font-weight-light font-italic text-right",children:e.nodeID.toLowerCase()})]}),Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col font-italic",children:e.modelDescription})}),"column_name"===e.type||"column_description"===e.type?Object(_.jsxs)("div",{className:"row",children:[Object(_.jsxs)("div",{className:"col",children:["Column: ",e.columnName]}),Object(_.jsx)("div",{className:"col",children:e.columnDescription})]}):null,"tag_name"===e.type?Object(_.jsx)("div",{className:"row",children:Object(_.jsxs)("div",{className:"col",children:["Tag: ",e.tagName]})}):null]})})},"searchRow"+t)},k=function(e){if(0===e.target.value.trim().length)return x([]),null;r(!0),b(!0),function(e,t){return be.apply(this,arguments)}(v.current.value,o).then((function(e){if(0===e.length||e.error)return x([]),null;if(e.searchString===v.current.value){var t=e.results.slice(0,15);x(t)}}))},S=function(){fetch("/api/v1/users/logout",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+o.token}}),c({user:{}}),sessionStorage.removeItem("user"),l({}),sessionStorage.removeItem("userconfig")};return Object(_.jsxs)(he.a,{className:"navbar-dark bg-brand position-fixed w-100 z-100",expand:"lg",children:[Object(_.jsx)(he.a.Brand,{href:"/",children:"T\u0100NGATA"}),Object(_.jsx)(he.a.Toggle,{"aria-controls":"navbarContent"}),Object(_.jsxs)(he.a.Collapse,{id:"navbarContent",className:"justify-content-between",children:[Object(_.jsxs)("div",{className:"navbar-nav p-2 bg-brand",children:[Object(_.jsx)("div",{className:"nav-item nav-link bg-brand "+(g.location.pathname.includes("/catalog")?"active":null),role:"button",onClick:function(){return g.push("/catalog")},children:"Catalog"}),Object(_.jsx)("div",{className:"nav-item nav-link bg-brand "+(g.location.pathname.includes("/config")?"active":null),role:"button",onClick:function(){return g.push("/config")},children:"Config"})]}),Object(_.jsxs)("div",{className:"navbar-nav p2",children:[Object(_.jsx)("form",{className:"form-inline",children:Object(_.jsx)("input",{className:"form-control mr-sm-2",type:"search",ref:v,onClick:function(e){return function(e){e.target.value.length>0&&(e.stopPropagation(),r(!0))}(e)},onChange:function(e){return k(e)},onFocus:function(){return b(e=!0),void r(e);var e},placeholder:"Search Models","aria-label":"Search Models"})}),function(){if(0===f.length||!j)return null;var e=f.map((function(e,t){return C(e,t)}));return Object(_.jsx)(Y.a,{target:v,show:j,placement:"bottom",children:Object(_.jsx)("div",{className:"container searchbox z-200",children:e})})}()]}),Object(_.jsxs)("div",{className:"navbar-nav p-2",children:[Object(_.jsx)("div",{className:"nav-item nav-link mr-sm-2"+("UploadMetadata"!==i.dbtmethod?null:" d-none"),role:"button",onClick:function(){fetch("/api/v1/reload_dbt",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+o.token}})},children:"Refresh dbt_ catalog"}),function(e,t){return"node"===e?Object(_.jsx)("div",{className:"nav-item nav-link mr-sm-2",role:"button",onClick:function(){return t()},children:"Submit changes"}):null}(t,(function(){var e={prTitle:prompt("Please describe your changes:","Added descriptions to models x, y")};fetch("/api/v1/create_pr",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+o.token},body:JSON.stringify(e)})})),(y="production","development"===y?Object(_.jsx)("div",{className:"nav-item nav-link",role:"button",onClick:function(){return n()},children:"Show state in console "}):null),function(e,t){return"node"===e?Object(_.jsxs)("div",{className:"nav-item nav-link mr-sm-2",role:"button",onClick:function(){return S()},children:["Logout ",t.firstname]}):null}(t,i)]})]})]})},me=n(22),Oe=n(651),fe=n(652),xe=n(101),ge=(n(446),n(84)),ve=n(186),ye=n.n(ve),Ce=new ye.a.graphlib.Graph;Ce.setDefaultEdgeLabel((function(){return{}}));var ke=200,Se=function(e){var t=Object(h.g)(),n=Object(a.useState)({x:null,y:null,display:!1}),s=Object(m.a)(n,2),r=s[0],o=s[1],c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LR";return Ce.setGraph({rankdir:t}),e.forEach((function(e){Object(ge.d)(e)?Ce.setNode(e.id,{width:ke,height:33}):Ce.setEdge(e.source,e.target)})),ye.a.layout(Ce),e.map((function(e){if(Object(ge.d)(e)){var t=Ce.node(e.id);e.targetPosition="left",e.sourcePosition="right",e.position={x:t.x-100+Math.random()/1e3,y:t.y-16.5}}return e}))}(e.lineageArray.lineage),i=Object(a.useState)(c),l=Object(m.a)(i,2),d=l[0],u=(l[1],function(){return Object(_.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.2)",zIndex:1500},onClick:function(){return o({x:null,y:null,display:!1})},onContextMenu:function(){return o({x:null,y:null,display:!1})}})});return Object(_.jsxs)("div",{className:"layoutflow lineagebox",children:[Object(_.jsx)(ge.b,{children:Object(_.jsx)(ge.c,{elements:d,connectionLineType:"smoothstep",onLoad:function(e){e.fitView({padding:.1,includeHiddenNodes:!0})},onNodeContextMenu:function(e,t){e.preventDefault(),o({x:e.pageX,y:e.pageY,display:!0,target:e.target,nodeID:t.id})},minZoom:"0.1",children:Object(_.jsx)(ge.a,{})})}),function(e){return!1===e.display?null:Object(_.jsxs)("div",{children:[Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{style:{zIndex:1051},children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t.push("/catalog/"+e.nodeID)},children:"Open Model in Current Tab"})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return window.open("/catalog/"+e.nodeID)},children:"Open Model in New Tab"})})]})})})}),Object(_.jsx)(u,{show:e.display})]})}(r)]})};function we(){return(we=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/models/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(){return(Ne=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/model_tree",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me=n(145),Te=n.n(Me),_e=n(292),Le=(n(624),n(293)),De=n(146),Ae=n.n(De);function Fe(e){var t=Object(h.g)(),n=Object(a.useState)({}),s=Object(m.a)(n,2),r=s[0],o=s[1],i=Object(a.useState)(),l=Object(m.a)(i,2),d=l[0],u=l[1],j=Object(a.useState)(),b=Object(m.a)(j,2),p=b[0],O=b[1],v=Object(a.useRef)(),y=Object(h.i)(),C=y.path;y.url;Object(a.useEffect)((function(){(function(e){return Ne.apply(this,arguments)})(e.user).then((function(e){e.error||(u(e),O(k(e)))}))}),[]);var k=function(e){return[S(e,"model","model")].concat([S(e,"source","source")])},S=function e(t,n,a){var s,o=[];if(s=n?t[n]:t,Object.keys(s)&&Object.keys(s)&&Object.keys(s).length>0){for(var c in s)a+"."+c===r.nodeID?(console.log("matched"),console.log(a+"."+c),o.unshift(e(s,c,a+"."+c))):o.push(e(s,c,a+"."+c));return{label:n,key:a,nodes:o}}return{label:n,key:a}};function w(t){var n={};switch(t.target.dataset.metadatafield){case"Description":n={updateMethod:"yamlModelProperty",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,property_name:"description",new_value:t.target.innerText};break;case"Tags":if("None"===t.target.innerText){n=null;break}n={updateMethod:"yamlModelTags",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,property_name:"tags",new_value:t.target.innerText.split(",").map((function(e){return e.trim()}))};break;case"ColumnDescription":n={updateMethod:"yamlModelColumnProperty",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,column:t.target.dataset.columnname,property_name:"description",new_value:t.target.innerText};break;case"ColumnTest":n={updateMethod:"yamlModelColumnTest",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,column:t.column,new_value:t.tests}}n&&fetch("/api/v1/update_metadata",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+e.user.token},body:JSON.stringify(n)})}function N(e,t){function n(e){var t=Object(a.useState)(!1),n=Object(m.a)(t,2),s=n[0],o=n[1],c=function(){return o(!1)};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(f.a,{className:"tealButton",onClick:function(){return o(!0)},children:"Show Lineage"}),Object(_.jsxs)(V.a,{show:s,onHide:c,size:"xl",children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:r.name})}),Object(_.jsx)(V.a.Body,{className:"lineagebox",children:Object(_.jsx)(Se,{className:"lineagebox",lineageArray:e})}),Object(_.jsx)(V.a.Footer,{children:Object(_.jsx)(f.a,{variant:"secondary",onClick:c,children:"Close"})})]})]})}return Object(_.jsx)(n,{lineage:e})}function M(){if("node"===r.model_type&&r.created_by)return Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsxs)("div",{className:"col col-md-auto",children:["Created: ",r.created_by+(r.created_relative_date?", "+r.created_relative_date:null)]})})}function T(e){if(e){var t="",n=e.split(".");for(var a in n)t+=e.substring(0,e.indexOf(n[a])+n[a].length)+"/";return t.slice(0,-1)}return null}function L(){var n=Object(h.h)().catalogPage;if(0===Object.keys(r).length||r.nodeID!==n)return function(e,t){return we.apply(this,arguments)}(n,e.user).then((function(e){e.error||(o(e),d&&O(k(d)))})),Object(_.jsx)(_.Fragment,{});var a=r.tags.length>0?r.tags.join(", "):null;return Object(_.jsxs)(H.a,{className:"catalogContainer display-block",children:[Object(_.jsxs)("div",{className:"row justify-content-md-left",children:[Object(_.jsx)("div",{className:"col col-md-auto pr-md-3",children:Object(_.jsx)("h3",{className:"mb-md-0",children:r.name.toLowerCase()})}),Object(_.jsx)("div",{className:"col font-italic align-self-end pl-md-0",children:r.materialization}),Object(_.jsxs)("div",{className:"col align-self-end pl-md-0 text-right",children:["tags: ",Object(_.jsx)("i",{children:Object(_.jsx)(Te.a,{innerRef:a,html:a,onBlur:w,"data-metadatafield":"Tags",placeholder:"Add comma-separated Tags",style:{display:"inline",minWidth:"100px"}})})]})]}),Object(_.jsxs)("div",{className:"row justify-content-between pt-md-1",children:[Object(_.jsxs)("div",{className:"col col-md-auto",children:[r.database.toLowerCase(),".",r.schema.toLowerCase(),".",r.name.toLowerCase()]}),Object(_.jsx)("div",{className:"col col-md-auto",children:r.row_count?Number(r.row_count).toLocaleString()+" rows":null})]}),M(),Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(Te.a,{innerRef:r.description,html:r.description?r.description:null,onBlur:w,"data-metadatafield":"Description",placeholder:"Add a description"})})}),Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:N(r.lineage,e.selectModel)})}),Object(_.jsxs)(Oe.a,{className:"mt-md-3",defaultActiveKey:"0",children:[Object(_.jsxs)(fe.a,{children:[Object(_.jsx)(fe.a.Header,{children:Object(_.jsx)(Oe.a.Toggle,{as:f.a,variant:"link",eventKey:"0",children:"Columns"})}),Object(_.jsx)(Oe.a.Collapse,{eventKey:"0",children:Object(_.jsx)("div",{className:"container",children:Object.keys(r.columns).length>0?Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)("table",{className:"table table-sm",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Name"}),Object(_.jsx)("th",{children:"Type"}),Object(_.jsx)("th",{children:"Description"}),Object(_.jsx)("th",{children:"Tests"})]})}),Object(_.jsx)("tbody",{children:Object.entries(r.columns).map((function(e,t){var n=[{value:"not_null",label:"Not Null",column:e[1].name,color:"#FF0000"},{value:"unique",label:"Unique",column:e[1].name,color:"#FF0000"}],a={control:function(e){return Object(c.a)(Object(c.a)({},e),{},{backgroundColor:"white"})},option:function(e,t){var n=t.data,a=t.isDisabled,s=t.isFocused,r=t.isSelected,o=Ae()(n.color);return Object(c.a)(Object(c.a)({},e),{},{backgroundColor:a?null:r?n.color:s?o.alpha(.1).css():null,color:a?"#ccc":r?Ae.a.contrast(o,"white")>2?"white":"black":n.color,cursor:a?"not-allowed":"default",":active":Object(c.a)(Object(c.a)({},e[":active"]),{},{backgroundColor:!a&&(r?n.color:o.alpha(.3).css())})})},multiValue:function(e,t){var n=t.data,a=Ae()(n.color);return Object(c.a)(Object(c.a)({},e),{},{backgroundColor:a.alpha(.1).css()})},multiValueLabel:function(e,t){var n=t.data;return Object(c.a)(Object(c.a)({},e),{},{color:n.color})},multiValueRemove:function(e,t){var n=t.data;return Object(c.a)(Object(c.a)({},e),{},{color:n.color,":hover":{backgroundColor:n.color,color:"white"}})}};return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"catalogColumnName",children:e[0].toLowerCase().replaceAll("_","_\u200b")}),Object(_.jsx)("td",{className:"catalogColumnType",children:e[1].type.toLowerCase()}),Object(_.jsx)("td",{children:Object(_.jsx)(Te.a,{html:e[1].description,onBlur:w,"data-metadatafield":"ColumnDescription",className:"catalogColumnDescription","data-columnName":e[0].toLowerCase(),placeholder:"Add a description"})}),Object(_.jsx)("td",{style:{width:"230px"},children:Object(_.jsx)(Le.a,{options:n,value:function(t){var n=[];for(var a in t){var s="#000000",r="",o="";"ERROR"===e[1].tests[a].severity?s="#FF0000":"WARNING"===e[1].tests[a].severity&&(s="#FFFF00"),"relationships"===e[1].tests[a].type?(r="relationships",o=Object(_.jsx)("span",{title:e[1].tests[a].related_model+"."+e[1].tests[a].related_field,children:"Relationship"})):"not_null"===e[1].tests[a].type?(r="not_null",o="Not Null"):"unique"===e[1].tests[a].type&&(r="unique",o="Unique"),n.push({value:r,label:o,color:s})}return n}(r.columns[e[0]].tests),isMulti:!0,onChange:function(t,n){var a=[];if("select-option"===n.action){var s={};for(var i in"unique"===n.option.value||"not_null"===n.option.value?(s={type:n.option.value,severity:"ERROR"},a.push(n.option.value)):n.option.value,o(Object(c.a)(Object(c.a)({},r),{},{columns:Object(c.a)(Object(c.a)({},r.columns),{},Object(me.a)({},n.option.column,Object(c.a)(Object(c.a)({},r.columns[n.option.column]),{},{tests:[].concat(Object(U.a)(r.columns[n.option.column].tests),[s])})))})),r.columns[e[0]].tests)"relationships"===r.columns[e[0]].tests[i].type?a.push(Object(me.a)({},r.columns[e[0]].tests[i].type,{to:"ref('"+r.columns[e[0]].tests[i].related_model+"')",field:r.columns[e[0]].tests[i].related_field})):a.push(r.columns[e[0]].tests[i].type)}else if("remove-value"===n.action){var l=r.columns[e[0]].tests.indexOf(n.removedValue.value),d=[].concat(Object(U.a)(r.columns[e[0]].tests.slice(0,l)),Object(U.a)(r.columns[e[0]].tests.slice(0,l+1)));for(var i in o(Object(c.a)(Object(c.a)({},r),{},{columns:Object(c.a)(Object(c.a)({},r.columns),{},Object(me.a)({},e[0],Object(c.a)(Object(c.a)({},r.columns[e[0]]),{},{tests:d})))})),d)"relationships"===d[i].type?a.push(Object(me.a)({},d[i].type,{to:"ref('"+d[i].related_model+"')",field:d[i].related_field})):a.push(d[i].type)}w({column:e[0],tests:a,target:{dataset:{metadatafield:"ColumnTest"}}})},styles:a,menuPortalTarget:document.body})})]},"columnRow"+e[0])}))})]})})}):Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col col-md-auto",children:"This model does not appear to contain any rows."})})})})]}),Object(_.jsxs)(fe.a,{children:[Object(_.jsx)(fe.a.Header,{children:Object(_.jsx)(Oe.a.Toggle,{as:f.a,variant:"link",eventKey:"1",children:"SQL"})}),Object(_.jsx)(Oe.a.Collapse,{eventKey:"1",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsxs)(x.a,{defaultActiveKey:"raw",id:"uncontrolled-tab-example",className:"ml-md-1",children:[Object(_.jsx)(g.a,{eventKey:"raw",title:"raw SQL",className:"py-md-3 catalogSQL",children:r.raw_sql}),Object(_.jsx)(g.a,{eventKey:"processed",title:"processed SQL",className:"py-md-3 catalogSQL",children:r.compiled_sql})]})})})})})]}),Object(_.jsxs)(fe.a,{children:[Object(_.jsx)(fe.a.Header,{children:Object(_.jsx)(Oe.a.Toggle,{as:f.a,variant:"link",eventKey:"2",children:"Code Change History"})}),Object(_.jsx)(Oe.a.Collapse,{eventKey:"2",children:Object(_.jsxs)("div",{className:"container",children:[Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:r.all_contributors.length>1?Object(_.jsx)(_.Fragment,{children:r.all_contributors.map((function(e,t){return Object(_.jsxs)("div",{title:e,children:[0===t?Object(_.jsxs)("b",{children:["Contributors:",Object(_.jsx)("br",{})]}):null,e]},"nodeContributor"+t)}))}):null})}),Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)("table",{className:"table",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{scope:"col",children:"Date"}),Object(_.jsx)("th",{scope:"col",children:"Author"}),Object(_.jsx)("th",{scope:"col",children:"Commit Message"})]})}),Object(_.jsx)("tbody",{children:r.all_commits.map((function(e,t){return Object(_.jsxs)("tr",{title:e.hash,children:[Object(_.jsx)("td",{title:e.authorDate,children:e.authorDateRel}),Object(_.jsx)("td",{children:e.authorName}),Object(_.jsx)("td",{children:Object(_.jsx)("a",{href:null!==e.originURL?e.originURL:null,target:"_blank",children:e.subject})})]},"catalogFileCommit "+t)}))})]})})})})]})})]}),Object(_.jsxs)(fe.a,{children:[Object(_.jsx)(fe.a.Header,{children:Object(_.jsx)(Oe.a.Toggle,{as:f.a,variant:"link",eventKey:"3",children:"Depends On"})}),Object(_.jsx)(Oe.a.Collapse,{eventKey:"3",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsxs)(_.Fragment,{children:[r.depends_on?r.depends_on.nodes.map((function(e,n){return Object(_.jsxs)("div",{title:e,children:[0===n?Object(_.jsxs)("b",{children:["Models:",Object(_.jsx)("br",{})]}):null,Object(_.jsx)("a",{href:"#",onClick:function(n){n.preventDefault(),t.push("/catalog/"+e)},children:e.split(".").pop()})]},"catalogDependsOnModel"+n)})):null,r.depends_on?r.depends_on.macros.map((function(e,t){return Object(_.jsxs)("div",{title:e,children:[0===t?Object(_.jsxs)("b",{children:["Macros:",Object(_.jsx)("br",{})]}):null,e.split(".").pop()]},"catalogDependsOnMacro"+t)})):null]})})})})})]}),Object(_.jsxs)(fe.a,{children:[Object(_.jsx)(fe.a.Header,{children:Object(_.jsx)(Oe.a.Toggle,{as:f.a,variant:"link",eventKey:"4",children:"Dependencies"})}),Object(_.jsx)(Oe.a.Collapse,{eventKey:"4",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(_.Fragment,{children:r.referenced_by.map((function(e,n){return Object(_.jsxs)("div",{title:e,children:[0===n?Object(_.jsxs)("b",{children:["Models:",Object(_.jsx)("br",{})]}):null,Object(_.jsx)("a",{href:"#",onClick:function(n){n.preventDefault(),t.push("/catalog/"+e)},children:e.split(".").pop()})]},"catalogDependentModel"+n)}))})})})})})]})]})]})}return Object(_.jsx)(H.a,{fluid:!0,children:Object(_.jsxs)(z.a,{className:"flex-xl-nowrap",children:[Object(_.jsx)(B.a,{as:function(e){var n=Object(a.useState)(!1),s=Object(m.a)(n,2),o=s[0],i=s[1];return Object(_.jsxs)(xe.Drawer,Object(c.a)(Object(c.a)({},e),{},{children:[Object(_.jsx)(xe.Drawer.Toggle,{onClick:function(){return i(!o)}}),Object(_.jsx)(E.a,{in:o,children:Object(_.jsx)(xe.Drawer.Overflow,{children:Object(_.jsx)(xe.Drawer.Nav,{children:Object(_.jsx)(_e.a,{data:p,initialActiveKey:T(r.nodeID),initialOpenNodes:function(e){if(e){var t=[],n=e.split(".");for(var a in n)t.push(T(e.substring(0,e.indexOf(n[a])+n[a].length)));return t}return null}(r.nodeID),onClickItem:function(e){!1===e.hasNodes?t.push("/catalog/"+e.key.split("/").pop()):(v.current.resetOpenNodes(v.current.state.openNodes,T(r.nodeID)),v.current.toggleNode(e.key))},ref:v,hasSearch:!1})})})})]}))},xs:12,md:4,lg:3}),Object(_.jsx)(B.a,{children:Object(_.jsxs)(h.d,{children:[Object(_.jsx)(h.b,{exact:!0,path:C}),Object(_.jsx)(h.b,{path:"".concat(C,"/:catalogPage"),children:Object(_.jsx)(L,{})})]})})]})})}function Ie(){return(Ie=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_ssh",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(){return(Pe=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/generate_ssh",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(){return(Re=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/open_git_connection",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(){return(Ke=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/check_dbt_connection",{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue=n(68),He=(n(635),function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).handleAllClicks=function(e){!0===a.state.contextMenuOpen&&a.setState({contextMenuOpen:!1})},a.openContextMenu=function(e){!0===e?a.setState({contextMenuOpen:!0}):a.setState({contextMenuOpen:!1})},a.logState=function(){a.setState({logState:!0})},a.openSQLPanel=function(){a.setState({openSQLPanel:!0})},a.addModel=function(){},a.openModelBuilder=function(){a.setState({appState:"ModelBuilder"})},a.openCatalog=function(){a.setState({appState:"Catalog"})},a.openConfig=function(){a.setState({appState:"Config"})},a.setUser=function(e){a.setState({user:e.user})},a.setUserConfig=function(e){a.setState({userConfig:e})},a.setSSHKey=function(){(function(e){return Ie.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){a.setState({sshKey:e})}))},a.generateSSHKey=function(){(function(e){return Pe.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){a.setState({sshKey:e})}))},a.openGitConnection=function(){(function(e){return Re.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){return e}))},a.checkDBTConnection=function(){(function(e){return Ke.apply(this,arguments)})(a.state.user).then((function(e){!0===e.ok?Ue.b.success("DBT_ Connection Successful."):e.text().then((function(e){Ue.b.error("DBT_ Connection Failed: "+e,{autoClose:1e4})}))}))},a.toastSender=function(e,t){"error"===t?Ue.b.error(e):"success"===t?Ue.b.success(e):Object(Ue.b)(e)},a.clearUserMessages=function(){a.setState({userMessages:[]})},a.LoginRoute=function(e){var t=e.children,n=Object(i.a)(e,["children"]);return Object(_.jsx)(h.b,Object(c.a)(Object(c.a)({},n),{},{render:function(e){e.location;return"python"===a.state.hostVersion||Object.keys(a.state.user).length>0?t:Object(_.jsx)(h.a,{to:{pathname:"/login"}})}}))},a.modelBuilder=s.a.createRef();var r="",o={};return"8080"===window.location.port?(r="python",o={token:""}):(r="node",sessionStorage.getItem("user")&&(M(JSON.parse(sessionStorage.getItem("user")).user).then((function(e){a.setState({userConfig:e.user})})),o=JSON.parse(sessionStorage.getItem("user")).user)),document.title="T\u0101ngata",a.state={appState:"Catalog",hostVersion:r,modelBuilder:{models:[{name:"humans"},{name:"abductions"}],logState:!1,openSQLPanel:!1,addModel:{}},contextMenuOpen:!1,catalogModel:{},sshKey:"",user:o,userConfig:{},userMessages:[]},a}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(){!0===this.state.logState&&(console.log("App State:"),console.log(this.state),this.setState({logState:!1})),!0===this.state.openSQLPanel&&this.setState({openSQLPanel:!1})}},{key:"render",value:function(){var e=this,t=null;return(t=Object(p.io)({auth:function(t){t({token:e.state.user})}})).on("connect",(function(){t.send("Hello!")})),t.on("toast",(function(t){e.toastSender(t.message,t.type)})),Object(_.jsx)(b.a,{children:Object(_.jsxs)("div",{id:"main",children:[Object(_.jsxs)(h.d,{children:[Object(_.jsx)(h.b,{exact:!0,path:"/",children:Object(_.jsx)(h.a,{to:"/catalog"})}),Object(_.jsx)(h.b,{path:"/login",children:Object(_.jsx)(L,{setUser:this.setUser,setUserConfig:this.setUserConfig,user:this.state.user,appState:this.state.appState})}),Object(_.jsxs)(this.LoginRoute,{path:"/catalog",children:[Object(_.jsx)(pe,{addModel:this.addModel,hostVersion:this.state.hostVersion,logState:this.logState,openSQLPanel:this.openSQLPanel,openModelBuilder:this.openModelBuilder,openCatalog:this.openCatalog,openConfig:this.openConfig,appState:this.state.appState,openContextMenu:this.openContextMenu,contextMenuOpen:this.state.contextMenuOpen,selectModel:this.selectModel,user:this.state.user,setUser:this.setUser,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig}),Object(_.jsx)("div",{className:"body",children:Object(_.jsx)(Fe,{appState:this.state.appState,catalogModel:this.state.catalogModel,selectModel:this.selectModel,user:this.state.user,hostVersion:this.state.hostVersion})})]}),Object(_.jsxs)(this.LoginRoute,{path:"/config",children:[Object(_.jsx)(pe,{addModel:this.addModel,logState:this.logState,openSQLPanel:this.openSQLPanel,openModelBuilder:this.openModelBuilder,openCatalog:this.openCatalog,openConfig:this.openConfig,appState:this.state.appState,openContextMenu:this.openContextMenu,contextMenuOpen:this.state.contextMenuOpen,selectModel:this.selectModel,user:this.state.user,setUser:this.setUser,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig}),Object(_.jsx)("div",{className:"body",children:Object(_.jsx)(K,{appState:this.state.appState,user:this.state.user,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig,sshKey:this.state.sshKey,setSSHKey:this.setSSHKey,generateSSHKey:this.generateSSHKey,openGitConnection:this.openGitConnection,checkDBTConnection:this.checkDBTConnection,toastSender:this.toastSender})})]})]}),Object(_.jsx)(Ue.a,{position:"bottom-center",autoClose:8e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})}}]),n}(a.Component)),ze=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,653)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),r(e),o(e)}))};o.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(He,{})}),document.getElementById("root")),ze()}},[[636,1,2]]]);
//# sourceMappingURL=main.fbb1c5ef.chunk.js.map