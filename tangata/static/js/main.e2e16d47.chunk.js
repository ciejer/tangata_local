(this.webpackJsonpsqlgui=this.webpackJsonpsqlgui||[]).push([[0],{153:function(e,t,n){},299:function(e,t,n){},637:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(12),c=n.n(r),o=(n(299),n(4)),i=n(142),l=n(47),u=n(48),d=n(51),j=n(49),h=n(17),b=n(70),p=n(289),m=(n(153),n(154),n(9)),O=n(19),f=n(184),x=n(649),g=n(642),v=n(7),y=n.n(v),C=n(10);function S(){return(S=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/users/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/users",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return w.apply(this,arguments)}function w(){return(w=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/refresh_metadata",{method:"POST",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return T.apply(this,arguments)}function T(){return(T=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_user_config/",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=n(1);function L(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(""),o=Object(m.a)(c,2),i=o[0],l=o[1],u=Object(a.useState)(""),d=Object(m.a)(u,2),j=d[0],b=d[1],p=Object(a.useState)(""),v=Object(m.a)(p,2),y=v[0],C=v[1],w=Object(h.g)();return("python"===e.hostVersion||Object.keys(e.user).length>0)&&w.push("/"),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("nav",{class:"navbar-dark bg-brand position-fixed w-100 z-100 navbar navbar-expand-xl navbar-light",children:Object(_.jsx)("div",{class:"navbar-brand",children:"T\u0100NGATA"})}),Object(_.jsxs)("div",{className:"Login",children:[Object(_.jsxs)(x.a,{defaultActiveKey:"login",id:"loginOrRegister",children:[Object(_.jsx)(g.a,{eventKey:"login",title:"Login",children:Object(_.jsxs)(O.a,{onSubmit:function(t){t.preventDefault(),function(e){return S.apply(this,arguments)}({user:{email:s,password:i}}).then((function(t){e.setUser(t),sessionStorage.setItem("user",JSON.stringify(t)),N(t.user),M(t.user).then((function(t){e.setUserConfig(t.user)}))}))},children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"loginEmail",children:[Object(_.jsx)(O.a.Label,{children:"Email"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"email",value:s,onChange:function(e){return r(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"loginPassword",children:[Object(_.jsx)(O.a.Label,{children:"Password"}),Object(_.jsx)(O.a.Control,{type:"password",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(_.jsx)(f.a,{block:!0,size:"lg",type:"submit",disabled:!(s.length>0&&i.length>0),children:"Login"})]})}),Object(_.jsx)(g.a,{eventKey:"register",title:"Sign Up",children:Object(_.jsxs)(O.a,{onSubmit:function(t){t.preventDefault(),function(e){return k.apply(this,arguments)}({user:{email:s,password:i,config:{firstname:j,lastname:y}}}).then((function(t){e.setUser(t),sessionStorage.setItem("user",JSON.stringify(t)),N(t.user),M(t.user).then((function(t){e.setUserConfig(t.user)}))}))},children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"registerEmail",children:[Object(_.jsx)(O.a.Label,{children:"Email"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"email",value:s,onChange:function(e){return r(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"registerPassword",children:[Object(_.jsx)(O.a.Label,{children:"Password"}),Object(_.jsx)(O.a.Control,{type:"password",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"First Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:j,onChange:function(e){return b(e.target.value)}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"lastname",children:[Object(_.jsx)(O.a.Label,{children:"Last Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:y,onChange:function(e){return C(e.target.value)}})]}),Object(_.jsx)(f.a,{block:!0,size:"lg",type:"submit",disabled:!(s.length>0&&i.length>0&&j.length>0),children:"Sign Up"})]})})]}),Object(_.jsxs)("div",{className:"container md-3 text-center col-md-5 mt-3",children:[Object(_.jsx)("blockquote",{children:Object(_.jsxs)("p",{children:["\u201cHutia te rito o te harakeke",Object(_.jsx)("br",{}),"Kei whea to k\u014dmako e k\u014d?",Object(_.jsx)("br",{}),"Ki mai ki ahau",Object(_.jsx)("br",{}),"He aha te mea nui o te Ao?",Object(_.jsx)("br",{}),"Maku e k\u012b atu,",Object(_.jsx)("br",{}),Object(_.jsx)("b",{children:"he t\u0101ngata, he t\u0101ngata, he t\u0101ngata"}),'..."']})}),Object(_.jsxs)("p",{children:["If the heart of the harakeke ",Object(_.jsx)("em",{children:"(flax plant)"})," was removed,",Object(_.jsx)("br",{}),"where would the bellbird sing?",Object(_.jsx)("br",{}),"If I was asked what was the most important thing in the world",Object(_.jsx)("br",{}),"I would be compelled to reply,",Object(_.jsx)("br",{}),"it is people, it is people, it is people.",Object(_.jsx)("br",{}),Object(_.jsx)("em",{children:"Ngaroto"})]}),Object(_.jsxs)("p",{children:["In te ao M\u0101ori (the M\u0101ori world view), T\u0101ngata (",Object(_.jsx)("em",{children:"TAHNG-uh-tuh"}),") describes something much larger than an addressed group of people: it describes ",Object(_.jsx)("em",{children:"whakapapa"}),", the surrounding network of ancestors and descendants we are connected to.",Object(_.jsx)("br",{}),"With this work we intend to follow these principles to put our people first: not just the data & analytics engineers, but those around our workplaces that know the deep details of how our businesses actually run.",Object(_.jsx)("br",{}),"These people are the lifeblood of what we do - and to keep moving forward, we need their context far more than ever."]})]})]})]})}n(341);function R(e,t){return D.apply(this,arguments)}function D(){return(D=Object(C.a)(y.a.mark((function e(t,n){var a,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete(a=Object(o.a)({},n))._id,delete a.email,delete a.token,e.next=6,fetch("/api/v1/set_user_config",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+t.token},body:JSON.stringify(a)});case 6:return s=e.sent,e.next=9,s;case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){return A.apply(this,arguments)}function A(){return(A=Object(C.a)(y.a.mark((function e(t,n,a){var s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/file_upload",{method:"POST",headers:{Authorization:"Token "+a.token,UploadType:n},body:t});case 2:return s=e.sent,e.next=5,s;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_dbt_cloud_accounts",{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_dbt_cloud_jobs/"+n,{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return a=e.sent,e.next=5,a;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)("LiveDB"),i=Object(m.a)(c,2),l=(i[0],i[1],Object(a.useState)({})),u=Object(m.a)(l,2),d=u[0],j=u[1],h=Object(a.useState)({}),b=Object(m.a)(h,2),p=b[0],v=b[1],y=Object(a.useRef)(null),C=Object(a.useRef)(null),S=Object(a.useRef)(null),k=Object(a.useRef)(null);function w(t,n){var a=Object(o.a)({},e.userConfig);a[n]=t,e.setUserConfig(a),R(e.user,a)}function M(t,n){if(t.length>0){var a=new FormData;a.append("file",t[0]),F(a,n,e.user).then((function(t){!0===t.ok?e.toastSender(n+" Upload Successful.","success"):t.text().then((function(t){e.toastSender(n+" Upload Failed: \n"+t,"error")}))}))}}function T(){(function(e){return I.apply(this,arguments)})(e.user).then((function(e){return e.json()})).then((function(e){j(e),L()}))}function L(){(function(e,t){return K.apply(this,arguments)})(e.user,S.current.value).then((function(e){return e.json()})).then((function(e){v(e)}))}return Object(_.jsxs)("div",{className:"container mt-3",children:[Object(_.jsx)("h1",{children:"Config"}),Object(_.jsxs)(x.a,{defaultActiveKey:"userdetails",id:"config",children:[Object(_.jsx)(g.a,{eventKey:"userdetails",title:"User Details",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"First Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.firstname,onChange:function(e){return w(e.target.value,"firstname")}})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"lastname",children:[Object(_.jsx)(O.a.Label,{children:"Last Name"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.lastname,onChange:function(e){return w(e.target.value,"lastname")}})]})]})}),Object(_.jsx)(g.a,{eventKey:"gitConfig",title:"Git Config",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"gitSSHKey",children:[Object(_.jsx)(O.a.Label,{children:"SSH Key"}),Object(_.jsx)("br",{}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(t){t.stopPropagation(),e.setSSHKey()},className:"m-1",children:"Get current SSH public key"}),Object(_.jsx)(f.a,{variant:"warning",className:"m-1",onClick:function(t){t.stopPropagation(),"New Key"===prompt("This will delete any current SSH keys. Please type 'New Key' to continue")&&e.generateSSHKey()},children:"Create new SSH Key"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"textarea",rows:2,value:e.sshKey,ref:y}),document.queryCommandSupported("copy")&&Object(_.jsxs)("div",{children:[Object(_.jsx)(f.a,{variant:"primary",onClick:function(e){y.current.select(),document.execCommand("copy"),e.target.focus(),r("Copied!")},className:"m-1",children:"Copy"}),s]}),Object(_.jsxs)(O.a.Text,{id:"gitSSHHelpBlock",muted:!0,children:["Where to add your key:",Object(_.jsx)("br",{}),Object(_.jsx)("a",{href:"https://github.com/settings/ssh/new",children:"GitHub SSH Keys - Add New"}),Object(_.jsx)("br",{}),Object(_.jsx)("a",{href:"https://gitlab.com/profile/keys",children:"GitLab SSH Keys - Add an SSH key"}),Object(_.jsx)("br",{})]})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"gitrepo",children:[Object(_.jsx)(O.a.Label,{children:"Git SSH URL"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",value:e.userConfig.gitrepo||"",onChange:function(e){return w(e.target.value,"gitrepo")}}),Object(_.jsxs)(O.a.Text,{id:"gitSSHHelpBlock",muted:!0,children:["Examples:",Object(_.jsx)("br",{}),"git@github.com:yourname/yourproject.git",Object(_.jsx)("br",{}),"git@gitlab.com:yourname/yourproject.git"]})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),e.openGitConnection()},children:"Clone Git Repository"})]})}),Object(_.jsx)(g.a,{eventKey:"dbtConfig",title:"DBT Config",className:"border-right border-left border-bottom p-3",children:Object(_.jsxs)(O.a,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbtConfigMethod",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Config Method"}),Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"Live Database Connection",type:"radio",id:"LiveDB",checked:"LiveDB"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),w("LiveDB","dbtmethod")}}),Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"Upload Compiled Metadata",type:"radio",id:"UploadMetadata",checked:"UploadMetadata"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),w("UploadMetadata","dbtmethod")}}),Object(_.jsx)(O.a.Check,{custom:!0,inline:!0,label:"dbt_ Cloud API",type:"radio",id:"Cloud",checked:"Cloud"===e.userConfig.dbtmethod,onClick:function(e){e.stopPropagation(),w("Cloud","dbtmethod")}})]},"custom-inline-radio")]}),Object(_.jsx)("hr",{}),Object(_.jsxs)("div",{className:"LiveDB"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadProfilesYML",children:[Object(_.jsx)(O.a.Label,{children:"Upload Profiles.YML"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"profilesYMLUpload",onChange:function(e){return M(e.target.files,"ProfilesYML")},id:"profilesYMLUpload",feedbackTooltip:!0}),Object(_.jsxs)(O.a.Text,{id:"profilesYMLHelpBlock",muted:!0,children:["To connect to your database, DBT requires a profiles.yml file. See ",Object(_.jsx)("a",{href:"https://docs.getdbt.com/dbt-cli/configure-your-profile",children:"the dbt_ docs"})," for setup details."]})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),e.checkDBTConnection()},children:"Check DBT Connection"})]}),Object(_.jsxs)("div",{className:"UploadMetadata"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsx)("p",{children:Object(_.jsxs)("i",{children:["To run without connecting to your database, the catalog requires metadata from dbt_.",Object(_.jsx)("br",{}),"Run ",Object(_.jsx)("code",{children:"dbt docs generate"})," in your dbt_ project, and upload the Manifest and Catalog from /target."]})}),Object(_.jsx)("p",{children:Object(_.jsxs)("i",{children:["To automate this upload, download ",Object(_.jsx)("code",{children:"tangata_refresh.py"})," from the Tangata git repository, and run it in the root of your project."]})}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadManifestJSON",children:[Object(_.jsx)(O.a.Label,{children:"Upload manifest.json"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"manifestJSONUpload",onChange:function(e){return M(e.target.files,"ManifestJSON")},id:"manifestJSONUpload",feedbackTooltip:!0})]}),Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"uploadCatalogJSON",children:[Object(_.jsx)(O.a.Label,{children:"Upload catalog.json"}),Object(_.jsx)(O.a.File,{className:"position-relative",required:!0,name:"catalogJSONUpload",onChange:function(e){return M(e.target.files,"CatalogJSON")},id:"catalogJSONUpload",feedbackTooltip:!0})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),N(e.user)},children:"Load Metadata"})]}),Object(_.jsxs)("div",{className:"Cloud"===e.userConfig.dbtmethod?null:"d-none",children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"firstname",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud API Key"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,type:"text",placeholder:"Change dbt_ Cloud Key",ref:C})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),function(t){if(t.length>0){var n=new FormData,a=new Blob([t],{type:"text/plain"});n.append("file",a),F(n,"dbt_ Cloud Key",e.user).then((function(t){!0===t.ok?e.toastSender("dbt_ Cloud Key Upload Successful.","success"):t.text().then((function(t){e.toastSender("dbt_ Cloud Key Upload Failed: \n"+t,"error")}))}))}}(C.current.value),T()},children:"Load dbt_ Cloud Accounts"}),d.length>0?Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbt_cloud_accounts",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud Accounts"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"select",custom:!0,ref:S,onChange:function(e){return L()},children:d.map((function(e,t){return Object(_.jsxs)("option",{value:e.id,children:[e.id,": ",e.name]},"dbt account "+t)}))})]}):null,p.length>0?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(O.a.Group,{size:"lg",controlId:"dbt_cloud_jobs",children:[Object(_.jsx)(O.a.Label,{children:"dbt_ Cloud Jobs"}),Object(_.jsx)(O.a.Control,{autoFocus:!0,as:"select",custom:!0,ref:k,children:p.map((function(e,t){return Object(_.jsxs)("option",{value:e.id,children:[e.id,": ",e.name]},"dbt job "+t)}))})]}),Object(_.jsx)(f.a,{variant:"primary",className:"m-1",onClick:function(t){t.stopPropagation(),function(){var t=Object(o.a)({},e.userConfig);t.dbt_cloud_account=S.current.value,t.dbt_cloud_job=k.current.value,R(e.user,t),e.setUserConfig(t)}()},children:"Save"})]}):null]})]})})]})]})}var H=n(11),z=n(643),B=n(645),U=n(290),E=n(141),G=n(646),J=n(100),V=n(648),q=n(139);function Q(e){var t=e.model,n=e.modelIndex,s=e.saveEditedModel,r=e.models,c=e.toggleJoinModal,i=e.showJoinModal,l=Object(a.useState)(t),u=Object(m.a)(l,2),d=u[0],j=u[1],h=Object(q.a)(),b=h.register,p=h.handleSubmit;if(0===n)return null;var x=function(){return c(-1)},g=function(e,t,n){return!1===n?Object(_.jsx)("tr",{className:"row",children:Object(_.jsx)("td",{className:"col w-100",children:e.fullName})},"joinCondition_"+t):Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"p-2",children:e.fullName}),Object(_.jsx)("td",{className:"w-md-auto p-2",children:Object(_.jsx)(f.a,{variant:"secondary",onClick:function(){return function(e){j(Object(o.a)(Object(o.a)({},d),{},{joinConditions:d.joinConditions.filter((function(t){return t!==e}))}))}(e)},children:"Remove"})})]},"joinCondition_"+t)},v=function(e){return d.joinConditions.map((function(t,n){return g(t,n,e)}))},y=function(e,t,n,a){for(var s={},r=0;r<e.response.models.length;r++)e.response.models[r].name===t&&(s=e.response.models[r]);if(null===s)return null;if(0===s.columns.length)return null;var c=s.columns.map((function(e,t){return function(e,t){return Object(_.jsx)("option",{children:e},t)}(e,t)}));return Object(_.jsx)(O.a.Control,{as:"select",name:a,ref:n,children:c})};return Object(_.jsxs)("div",{children:[Object(_.jsx)(f.a,{variant:"primary",onClick:function(){j(JSON.parse(JSON.stringify(t))),c(n)},children:"Edit Join"}),Object(_.jsx)("table",{className:"table",children:Object(_.jsx)("tbody",{children:v(!1)})}),Object(_.jsxs)(V.a,{show:i===n,onHide:x,size:"lg",children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:"Edit Join "})}),Object(_.jsxs)(V.a.Body,{children:[Object(_.jsxs)(z.a,{children:[Object(_.jsx)("h5",{children:"Join Conditions"}),Object(_.jsx)("table",{className:"table-striped table-bordered w-100",children:Object(_.jsx)("tbody",{children:v(!0)})})]}),Object(_.jsxs)(z.a,{className:"mt-3",children:[Object(_.jsx)("h5",{children:"Add new Join Condition"}),Object(_.jsx)(O.a,{onSubmit:p((function(e){var a={conditionField1:{model:t.name,column:e.condition1Field},conditionOperator:e.conditionOperator,conditionField2:{model:r.response.models[n-1].name,column:e.condition2Field},fullName:t.name+"."+e.condition1Field+" "+e.conditionOperator+" "+r.response.models[n-1].name+"."+e.condition2Field};j(Object(o.a)(Object(o.a)({},d),{},{joinConditions:d.joinConditions.concat(a)}))})),children:Object(_.jsxs)("div",{className:"row text-center ",children:[Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:t.name}),y(r,t.name,b,"condition1Field")]})}),Object(_.jsx)("div",{className:"col-md-auto",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:"Operator type"}),Object(_.jsxs)(O.a.Control,{name:"conditionOperator",as:"select",ref:b,children:[Object(_.jsx)("option",{children:"="}),Object(_.jsx)("option",{children:">="}),Object(_.jsx)("option",{children:"<="})]})]})}),Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:r.response.models[n-1].name}),y(r,r.response.models[n-1].name,b,"condition2Field")]})}),Object(_.jsx)("div",{className:"col-md-auto",children:Object(_.jsx)(f.a,{variant:"primary",type:"submit",className:"joinConditionAddButton",children:"Add"})})]})})]})]}),Object(_.jsxs)(V.a.Footer,{children:[Object(_.jsx)(f.a,{variant:"secondary",onClick:x,children:"Close"}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(){s(t,d),x()},children:"Save Changes"})]})]})]})}var Y=n(647),W=n(644);function X(e){var t=e.models,n=e.modelDragEnd,s=e.showColumns,r=e.saveEditedModel,c=e.toggleJoinModal,i=e.showJoinModal,l=e.highlightedColumns,u=e.openContextMenu,d=e.contextMenuOpen,j=e.editSelect,h=Object(a.useState)({x:null,y:null,display:!1}),b=Object(m.a)(h,2),p=b[0],O=b[1];if(0===t.length)return null;!1===d&&!0===p.display&&O({x:null,y:null,display:!1});var f=function(e,n,a,s,c,i,l){var d=function(t,n){var a=t.map((function(t,n){return function(t,n){for(var a=function(e){"click"===e.type?(O({x:null,y:null,display:!1}),u(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===p.display?(O({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),u(!0)):(O({x:null,y:null,display:!1}),u(!1)))},s=!1,r=0;r<i.length;r++)e.name===i[r].model&&t===i[r].column&&(s=!0);return Object(_.jsxs)("tr",{className:n%2===0?"odd":"even",onClick:function(e){return a(e)},onContextMenu:function(e){return a(e)},"data-model":e.name,"data-column":t,children:[Object(_.jsx)("td",{className:"col-md-auto "+(s?"highlightColumn":null),children:n+1}),Object(_.jsx)("td",{className:"col "+(s?"highlightColumn":null),children:t})]},n)}(t,n)}));return Object(_.jsx)("tbody",{children:a})};return Object(_.jsx)(J.b,{draggableId:e.name,index:n,children:function(i,l){return Object(_.jsxs)("div",Object(o.a)(Object(o.a)(Object(o.a)({ref:i.innerRef},i.draggableProps),i.dragHandleProps),{},{className:"col removeFocusOutline",children:[Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center font-weight-bold",children:e.name}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center font-italic mb-3",children:e.description}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center",children:Object(_.jsx)(Q,{model:e,saveEditedModel:r,models:t,showJoinModal:s,toggleJoinModal:c,modelIndex:n})}),Object(_.jsx)("table",{className:"table table-bordered table-striped table-hover w-100",children:!0===a?d(e.columns):null})]}))}},"model_"+e.name)},x=function(e,t,n,a){return e.response.models.map((function(e,s){return f(e,s,t,n,a,l)}))};return Object(_.jsxs)("div",{className:"text-center",children:[Object(_.jsx)("h2",{children:"Models"}),Object(_.jsx)("div",{className:"container",children:Object(_.jsx)(J.a,{onDragEnd:n,children:Object(_.jsx)(J.c,{droppableId:"droppable",children:function(e,n){return Object(_.jsxs)("div",Object(o.a)(Object(o.a)({},e.droppableProps),{},{ref:e.innerRef,children:[x(t,s,i,c),e.placeholder]}))}})})}),function(e,t){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsx)("tbody",{children:Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t={inputColumns:[{model:e.target.parentNode.dataset.model,column:e.target.parentNode.dataset.column}],alias:e.target.parentNode.dataset.column},j(null,t),void u(!1);var t},children:"Add to Output"})})})})})})})}(p)]})}var Z=n(30),$=n(292),ee=n.n($),te=n(185),ne=n.n(te),ae=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).isTrigger=s.isTrigger.bind(Object(Z.a)(s)),s.getMatch=s.getMatch.bind(Object(Z.a)(s)),s.handleChange=s.handleChange.bind(Object(Z.a)(s)),s.handleKeyDown=s.handleKeyDown.bind(Object(Z.a)(s)),s.handleResize=s.handleResize.bind(Object(Z.a)(s)),s.handleSelection=s.handleSelection.bind(Object(Z.a)(s)),s.updateCaretPosition=s.updateCaretPosition.bind(Object(Z.a)(s)),s.updateHelper=s.updateHelper.bind(Object(Z.a)(s)),s.resetHelper=s.resetHelper.bind(Object(Z.a)(s)),s.renderAutocompleteList=s.renderAutocompleteList.bind(Object(Z.a)(s)),s.state={helperVisible:!1,left:0,matchLength:0,matchStart:0,options:[],fullOptions:[],selection:0,top:0,value:null},s.recentValue=e.defaultValue,s.enableSpaceRemovers=!1,s.refInput=Object(a.createRef)(),s}return Object(u.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentDidUpdate",value:function(e){var t=this.props.options,n=this.props.fullOptions,a=this.state.caret;t.length!==e.options.length&&this.updateHelper(this.recentValue,a,t,n)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"getMatch",value:function(e,t,n,a){for(var s=this,r=this.props,c=r.trigger,o=r.matchAny,i=r.regex,l=new RegExp(i),u=c.length,d=c.match(l),j=t-1;j>=0;--j){var h=e.substring(j,t).match(l),b=-1;if(u>0){var p=d?j:j-u+1;if(p<0)return null;if(this.isTrigger(e,p)&&(b=p+u),!h&&b<0)return null}else{if(h&&j>0)continue;if(t-(b=0===j&&h?0:j+1)===0)return null}if(b>=0){var m,O,f=function(){var a=e.substring(b,t),r=n.filter((function(e){var t=e.toLowerCase().indexOf(a.toLowerCase());return-1!==t&&(o||0===t)}));for(m=[],O=0;O<n.length;O++){var c=n[O].toLowerCase().indexOf(a.toLowerCase());-1===c||!o&&0!==c||m.push(s.props.fullOptions[O])}s.setState({fullOptions:m});var i=a.length;return{v:{matchStart:b,matchLength:i,options:r}}}();if("object"===typeof f)return f.v}}return null}},{key:"isTrigger",value:function(e,t){var n=this.props.trigger;return!n||!n.length||e.substr(t,n.length)===n}},{key:"handleChange",value:function(e){var t=this.props,n=t.onChange,a=t.options,s=t.fullOptions,r=t.spaceRemovers,c=t.spacer,o=t.value,i=this.recentValue,l=e.target.value,u=ne()(e.target).end;if(l.length||this.setState({helperVisible:!1}),this.recentValue=l,this.setState({caret:u,value:e.target.value}),!l.length||!u)return n(e.target.value);if(this.enableSpaceRemovers&&r.length&&l.length>2&&c.length){for(var d=0;d<Math.max(i.length,l.length);++d)if(i[d]!==l[d]){if(d>=2&&l[d-1]===c&&-1===r.indexOf(l[d-2])&&-1!==r.indexOf(l[d])&&this.getMatch(l.substring(0,d-2),u-3,a,s)){var j="".concat(l.slice(0,d-1)).concat(l.slice(d,d+1)).concat(l.slice(d-1,d)).concat(l.slice(d+1));return this.updateCaretPosition(d+1),this.refInput.current.value=j,o||this.setState({value:j}),n(j)}break}this.enableSpaceRemovers=!1}return this.updateHelper(l,u,a,s),o||this.setState({value:e.target.value}),n(e.target.value)}},{key:"handleKeyDown",value:function(e){var t=this.state,n=t.helperVisible,a=t.options,s=t.selection,r=this.props,c=r.onKeyDown,o=r.passThroughEnter;if(n)switch(e.keyCode){case 27:e.preventDefault(),this.resetHelper();break;case 38:e.preventDefault(),this.setState({selection:(a.length+s-1)%a.length});break;case 40:e.preventDefault(),this.setState({selection:(s+1)%a.length});break;case 14:case 13:o||e.preventDefault(),this.handleSelection(s);break;case 9:this.handleSelection(s);break;default:c(e)}else c(e)}},{key:"handleResize",value:function(){this.setState({helperVisible:!1})}},{key:"handleSelection",value:function(e){var t=this.state,n=t.matchStart,a=t.matchLength,s=t.fullOptions,r=this.props,c=r.spacer,o=r.onSelect,i=s[e],l=this.recentValue,u=l.substring(0,n),d=l.substring(n+a),j={target:this.refInput.current};j.target.value="".concat(u).concat(i).concat(c).concat(d),this.handleChange(j),o(j.target.value),this.resetHelper(),this.updateCaretPosition(u.length+i.length+1),this.enableSpaceRemovers=!0}},{key:"updateCaretPosition",value:function(e){var t=this;this.setState({caret:e},(function(){return Object(te.setCaretPosition)(t.refInput.current,e)}))}},{key:"updateHelper",value:function(e,t,n,a){var s=this.refInput.current,r=this.getMatch(e,t,n,a);if(r){var c=ee()(s,t),i=s.getBoundingClientRect(),l=c.top+s.offsetTop,u=Math.min(c.left+s.offsetLeft-10,s.offsetLeft+i.width-100),d=this.props,j=d.minChars,h=d.onRequestOptions,b=d.requestOnlyIfNoOptions;r.matchLength>=j&&(r.options.length>1||1===r.options.length&&r.options[0].length!==r.matchLength)?this.setState(Object(o.a)({helperVisible:!0,top:l,left:u},r)):(b&&r.options.length||h(e.substr(r.matchStart,r.matchLength)),this.resetHelper())}else this.resetHelper()}},{key:"resetHelper",value:function(){this.setState({helperVisible:!1,selection:0})}},{key:"renderAutocompleteList",value:function(){var e=this,t=this.state,n=t.helperVisible,a=t.left,s=t.matchStart,r=t.matchLength,c=t.options,o=(t.fullOptions,t.selection),i=t.top,l=t.value;if(!n)return null;var u=this.props,d=u.maxOptions,j=u.offsetX,h=u.offsetY;if(0===c.length)return null;if(o>=c.length)return this.setState({selection:0}),null;var b=0===d?c.length:d,p=c.slice(0,b).map((function(t,n){var a=t.toLowerCase().indexOf(l.substr(s,r).toLowerCase());return Object(_.jsxs)("li",{className:n===o?"active":null,onClick:function(){e.handleSelection(n)},onMouseEnter:function(){e.setState({selection:n})},children:[t.slice(0,a),Object(_.jsx)("strong",{children:t.substr(a,r)}),t.slice(a+r)]},t)}));return Object(_.jsx)("ul",{className:"react-autocomplete-input",style:{left:a+j,top:i+h},children:p})}},{key:"render",value:function(){var e=this.props,t=e.Component,n=e.defaultValue,a=e.disabled,s=e.onBlur,r=e.value,c=Object(i.a)(e,["Component","defaultValue","disabled","onBlur","value"]),l=this.state.value,u=Object.assign({},c);Object.keys(this.constructor.propTypes).forEach((function(e){delete u[e]}));var d="";return"undefined"!==typeof r&&null!==r?d=r:l?d=l:n&&(d=n),Object(_.jsxs)("span",{children:[Object(_.jsx)(t,Object(o.a)({disabled:a,onBlur:s,onChange:this.handleChange,onKeyDown:this.handleKeyDown,ref:this.refInput,value:d},u)),this.renderAutocompleteList()]})}}]),n}(s.a.Component);ae.defaultProps={Component:"textarea",defaultValue:"",disabled:!1,maxOptions:6,onBlur:function(){},onChange:function(){},onKeyDown:function(){},onRequestOptions:function(){},onSelect:function(){},options:[],fullOptions:[],regex:"^[A-Za-z0-9\\-_]+$",matchAny:!1,minChars:0,requestOnlyIfNoOptions:!0,spaceRemovers:[",",".","!","?"],spacer:" ",trigger:"@",offsetX:0,offsetY:0,value:null,passThroughEnter:!1};var se=ae,re=function(e){var t=e.models,n=e.conditions,r=e.editCondition,c=e.openContextMenu,o=e.contextMenuOpen,i=Object(a.useState)({x:null,y:null,display:!1}),l=Object(m.a)(i,2),u=l[0],d=l[1],j=Object(a.useState)({show:!1,conditionToEdit:null}),h=Object(m.a)(j,2),b=h[0],p=h[1],x=Object(q.a)();x.register,x.handleSubmit;if(!1===o&&!0===u.display&&d({x:null,y:null,display:!1}),0===t.length)return null;return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"text-center",children:"Conditions"}),Object(_.jsxs)("div",{children:[function(e,t,n){if(0===e.length)return null;for(var a=function(e){"click"===e.type?(d({x:null,y:null,display:!1}),n(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===u.display?(d({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),n(!0)):(d({x:null,y:null,display:!1}),n(!1)))},s=function(e,t,n){return Object(_.jsx)("tr",{className:"componentRow ",onClick:n,onContextMenu:n,children:Object(_.jsx)("td",{md:"auto",className:"fullSize",children:Object(_.jsx)("div",{className:"componentContent",children:e})})},t)},r=[],c=0;c<e.length;c++)r.push(s(e[c],c,a));return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center",children:"Add / Remove Conditions to filter results"}),Object(_.jsx)(W.a,{striped:!0,bordered:!0,children:Object(_.jsx)("tbody",{children:r})})]})}(n,0,c),function(e){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return e.target.firstChild.data,p({show:!0,conditionToEdit:e.target.firstChild.data}),void c(!1)},children:Object(_.jsx)("div",{children:"Edit Condition"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.firstChild.data,r(t,null),void c(!1);var t},children:"Delete Condition"})})]})})})})})}(u),function(e,n,a){if(!1===e.menuOpen)return null;var r=s.a.createRef();return Object(_.jsx)("div",{children:Object(_.jsxs)(V.a,{show:e.show,onHide:n,children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:"Edit Join "})}),Object(_.jsxs)(V.a.Body,{children:["Join Conditions:",Object(_.jsx)(O.a,{children:Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)(O.a.Group,{children:[Object(_.jsx)(O.a.Label,{children:"Condition Criteria"}),Object(_.jsx)(se,{className:"form-control",rows:3,ref:r,options:function(){for(var e=[],n=0;n<t.response.models.length;n++)for(var a=0;a<t.response.models[n].columns.length;a++)e.push(t.response.models[n].columns[a]),e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]);return e}(),fullOptions:function(){for(var e=[],n=0;n<t.response.models.length;n++)for(var a=0;a<t.response.models[n].columns.length;a++)e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]),e.push(t.response.models[n].name+"."+t.response.models[n].columns[a]);return e}(),trigger:"",defaultValue:e.conditionToEdit})]})})})})]}),Object(_.jsxs)(V.a.Footer,{children:[Object(_.jsx)(f.a,{variant:"secondary",onClick:n,children:"Close"}),Object(_.jsx)(f.a,{variant:"primary",onClick:function(){a(e.conditionToEdit,r.current.recentValue),n()},children:"Save Changes"})]})]})})}(b,(function(){return p({show:!1,conditionToEdit:null})}),r)]}),Object(_.jsx)("div",{className:"pt-2 text-center",children:Object(_.jsx)(f.a,{variant:"primary",onClick:function(){return p({show:!0,conditionToEdit:null})},children:"Add Condition"})})]})};function ce(e){var t=e.models,n=e.openContextMenu,s=e.contextMenuOpen,r=e.selects,c=e.editSelect,i=e.highlightColumn,l=e.outputModel,u=(e.editOutputModel,Object(a.useState)({x:null,y:null,display:!1})),d=Object(m.a)(u,2),j=d[0],h=d[1],b=Object(a.useState)(-1),p=Object(m.a)(b,2),f=p[0],x=p[1],g=Object(a.useState)(-1),v=Object(m.a)(g,2),y=v[0],C=v[1];if(0===t.length)return null;!1===s&&!0===j.display&&h({x:null,y:null,display:!1});return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"text-center",children:"Output"}),Object(_.jsx)("div",{className:"w-100 bg-secondary text-white text-center",children:l.name}),Object(_.jsx)("div",{className:"w-100 bg-light text-dark text-center font-italic mb-3",children:l.description?l.description:"New Model"}),Object(_.jsx)("table",{className:"table table-striped table-hover w-100",children:Object(_.jsx)("tbody",{children:function(e,t,n,a){for(var s=function(e){"click"===e.type?(h({x:null,y:null,display:!1}),a(!1)):"contextmenu"===e.type&&(e.preventDefault(),!1===j.display?(h({x:e.pageX,y:e.pageY,display:!0,clickTargetType:"Condition",target:e.target}),a(!0)):(h({x:null,y:null,display:!1}),a(!1)))},r=function(e){e.preventDefault(),x(-1),c(t[f],Object(o.a)(Object(o.a)({},t[f]),{},{alias:e.target.value}))},i=function(e){e.preventDefault(),C(-1),c(t[y],Object(o.a)(Object(o.a)({},t[y]),{},{description:e.target.value}))},l=function(e,t){return f===t?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(O.a,{onSubmit:function(e){return e.preventDefault()},children:Object(_.jsx)(O.a.Group,{children:Object(_.jsx)(O.a.Control,{type:"text",defaultValue:null!==e[t].alias&&void 0!==e[t].alias?e[t].alias:e[t].column,onBlur:function(e){return r(e)},placeholder:"Add name for output field",autoFocus:!0})})})}):Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:"w-100 text-dark text-right","data-selectindex":t,children:null!==e[t].alias&&void 0!==e[t].alias?e[t].alias:e[t].column})})},u=function(e,t){return y===t?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(O.a,{onSubmit:function(e){return e.preventDefault()},children:Object(_.jsx)(O.a.Group,{children:Object(_.jsx)(O.a.Control,{type:"text",defaultValue:null!==e[t].description&&void 0!==e[t].description?e[t].description:null,onBlur:function(e){return i(e)},placeholder:"Add description for output field",autoFocus:!0})})})}):null!==e[t].description&&void 0!==e[t].description?Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:"w-100 text-dark text-right font-italic","data-selectindex":t,children:e[t].description})}):null},d=function(e){var t=[];if(void 0!==e&null!==e)for(var a=0;a<e.inputColumns.length;a++)t.push(e.inputColumns[a]);n(t)},b=[],p=function(e){b.push(Object(_.jsx)("tr",{onMouseEnter:function(){return d(t[e])},onMouseLeave:function(){return d()},onClick:function(e){return s(e)},onContextMenu:function(e){return s(e)},children:Object(_.jsxs)("td",{"data-selectindex":e,children:[l(t,e),u(t,e)]})},e))},m=0;m<t.length;m++)p(m);return b}(0,r,i,n)})}),function(e,t){if(!1===e.display)return null;return Object(_.jsx)("div",{children:Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"left-start",children:Object(_.jsx)("div",{children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.dataset.selectindex,x(parseInt(t)),void n(!1);var t},children:Object(_.jsx)("div",{children:"Edit Name"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t=e.target.dataset.selectindex,C(parseInt(t)),void n(!1);var t},children:Object(_.jsx)("div",{children:"Edit Description"})})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return a=t[e.target.dataset.selectindex],c(a,null),void n(!1);var a},children:"Delete Field"})})]})})})})})}(j,r)]})}function oe(){return(oe=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/model_old/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(e){if(0===e.length)return null;for(var t=e[0].fullName,n=1;n<e.length;n++)t+="\n  AND "+e[n].fullName;return t},le=function(e){var t="SELECT\n",n=function(e){return function(e){return"definition"in e?e.definition:e.inputColumns[0].model+"."+e.inputColumns[0].column}(e)+" AS "+e.alias};if(0!==e.selects.length){t+="  "+n(e.selects[0])+"\n";for(var a=1;a<e.selects.length;a++)t+="  , "+n(e.selects[a])+"\n"}else t+="  *\n";return t},ue=function(e){var t="",n=function(e){return'{{ ref("'+e.name+'") }} AS '+e.name};if(0!==e.models.length){t+="FROM "+n(e.models.response.models[0])+"\n";for(var a=1;a<e.models.response.models.length;a++)t+="LEFT JOIN "+n(e.models.response.models[a])+"\n  ON "+ie(e.models.response.models[a].joinConditions)+"\n"}else t+="FROM "+e.outputModel;return t},de=function(e){var t="";if(0!==e.models.length){t+="WHERE "+e.conditions[0]+"\n";for(var n=1;n<e.conditions.length;n++)t+="  AND "+e.conditions[n]+"\n"}else t+="FROM "+e.outputModel;return t},je=function(e){var t=e.state;return Object(_.jsxs)("div",{children:["Generated SQL:",Object(_.jsxs)("div",{className:"sqlContent",children:[le(t),ue(t),de(t)]})]})},he=(a.Component,n(650)),be=function(e){e.addModel;var t=e.hostVersion,n=e.logState,s=(e.openSQLPanel,e.openModelBuilder,e.openCatalog,e.openConfig,e.appState,e.contextMenuOpen,e.openContextMenu,e.selectModel,e.user),r=e.setUser,c=e.userConfig,o=e.setUserConfig,i=Object(h.g)(),l=Object(a.useRef)(null);var u,d=function(e){return 0===e.target.value.trim().length||function(){var e;clearTimeout(e),e=setTimeout((function(){i.push("/catalog/search/"+l.current.value)}),500)}(),null},j=function(){fetch("/api/v1/users/logout",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+s.token}}),r({user:{}}),sessionStorage.removeItem("user"),o({}),sessionStorage.removeItem("userconfig")};return Object(_.jsxs)(he.a,{className:"navbar-dark bg-brand position-fixed w-100 z-100",expand:"lg",children:[Object(_.jsx)(he.a.Brand,{href:"/",children:"T\u0100NGATA"}),Object(_.jsx)(he.a.Toggle,{"aria-controls":"navbarContent"}),Object(_.jsxs)(he.a.Collapse,{id:"navbarContent",className:"justify-content-between",children:[Object(_.jsxs)("div",{className:"navbar-nav p-2 bg-brand",children:[Object(_.jsx)("div",{className:"nav-item nav-link bg-brand "+(i.location.pathname.includes("/catalog")?"active":null),role:"button",onClick:function(){return i.push("/catalog")},children:"Catalog"}),function(e,t){return"node"===e?Object(_.jsx)("div",{className:"nav-item nav-link bg-brand "+(i.location.pathname.includes("/config")?"active":null),role:"button",onClick:function(){return i.push("/config")},children:"Config"}):null}(t)]}),Object(_.jsx)("div",{className:"navbar-nav p2",children:Object(_.jsx)("form",{className:"form-inline",children:Object(_.jsx)("input",{className:"form-control mr-sm-2",type:"search",ref:l,onFocus:function(){i.push("/catalog/search/"+l.current.value)},onChange:function(e){return d(e)},placeholder:"Search Models","aria-label":"Search Models"})})}),Object(_.jsxs)("div",{className:"navbar-nav p-2",children:[Object(_.jsx)("div",{className:"nav-item nav-link mr-sm-2"+("UploadMetadata"!==c.dbtmethod?null:" d-none"),role:"button",onClick:function(){fetch("/api/v1/reload_dbt",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+s.token}})},children:"Refresh dbt_ catalog"}),function(e,t){return"node"===e?Object(_.jsx)("div",{className:"nav-item nav-link mr-sm-2",role:"button",onClick:function(){return t()},children:"Submit changes"}):null}(t,(function(){var e={prTitle:prompt("Please describe your changes:","Added descriptions to models x, y")};fetch("/api/v1/create_pr",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+s.token},body:JSON.stringify(e)})})),(u="production","development"===u?Object(_.jsx)("div",{className:"nav-item nav-link",role:"button",onClick:function(){return n()},children:"Show state in console "}):null),function(e,t){return"node"===e?Object(_.jsxs)("div",{className:"nav-item nav-link mr-sm-2",role:"button",onClick:function(){return j()},children:["Logout ",t.firstname]}):null}(t,c)]})]})]})},pe=n(16),me=n(651),Oe=n(652),fe=n(101),xe=(n(447),n(84)),ge=n(186),ve=n.n(ge),ye=new ve.a.graphlib.Graph;ye.setDefaultEdgeLabel((function(){return{}}));var Ce=200,Se=function(e){var t=Object(h.g)(),n=Object(a.useState)({x:null,y:null,display:!1}),s=Object(m.a)(n,2),r=s[0],c=s[1],o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LR";return ye.setGraph({rankdir:t}),e.forEach((function(e){Object(xe.d)(e)?ye.setNode(e.id,{width:Ce,height:33}):ye.setEdge(e.source,e.target)})),ve.a.layout(ye),e.map((function(e){if(Object(xe.d)(e)){var t=ye.node(e.id);e.targetPosition="left",e.sourcePosition="right",e.position={x:t.x-100+Math.random()/1e3,y:t.y-16.5}}return e}))}(e.lineageArray.lineage),i=Object(a.useState)(o),l=Object(m.a)(i,2),u=l[0],d=(l[1],function(){return Object(_.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.2)",zIndex:1500},onClick:function(){return c({x:null,y:null,display:!1})},onContextMenu:function(){return c({x:null,y:null,display:!1})}})});return Object(_.jsxs)("div",{className:"layoutflow lineagebox",children:[Object(_.jsx)(xe.b,{children:Object(_.jsx)(xe.c,{elements:u,connectionLineType:"smoothstep",onLoad:function(e){e.fitView({padding:.1,includeHiddenNodes:!0})},onNodeContextMenu:function(e,t){e.preventDefault(),c({x:e.pageX,y:e.pageY,display:!0,target:e.target,nodeID:t.id})},minZoom:"0.1",children:Object(_.jsx)(xe.a,{})})}),function(e){return!1===e.display?null:Object(_.jsxs)("div",{children:[Object(_.jsx)(Y.a,{target:e.target,show:e.display,placement:"right-start",children:Object(_.jsx)("div",{style:{zIndex:1051},children:Object(_.jsx)(W.a,{bordered:!0,variant:"dark",children:Object(_.jsxs)("tbody",{children:[Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return t.push("/catalog/"+e.nodeID)},children:"Open Model in Current Tab"})}),Object(_.jsx)("tr",{children:Object(_.jsx)("td",{onClick:function(){return window.open("/catalog/"+e.nodeID)},children:"Open Model in New Tab"})})]})})})}),Object(_.jsx)(d,{show:e.display})]})}(r)]})},ke=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.searchResults,t=this.props.resultSelectFunction,n=function(){if(0===e.results.length)return Object(_.jsx)("div",{className:"container searchbox z-200",children:Object(_.jsx)(B.a,{children:Object(_.jsx)(U.a,{children:Object(_.jsx)("h5",{className:"text-center",children:"No search results"})})})});var n=e.results.map((function(e,n){return function(e,n){return Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col-sm",children:Object(_.jsxs)("div",{className:"container",onClick:function(e){return t(e,n)},children:[Object(_.jsxs)("div",{className:"row",children:[Object(_.jsx)("div",{className:"col font-weight-bold",children:e.modelName.toLowerCase()}),Object(_.jsx)("div",{className:"col font-weight-light font-italic text-right",children:e.nodeID.toLowerCase()})]}),Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col font-italic",children:e.modelDescription})}),"column_name"===e.type||"column_description"===e.type?Object(_.jsxs)("div",{className:"row",children:[Object(_.jsxs)("div",{className:"col",children:["Column: ",e.columnName]}),Object(_.jsx)("div",{className:"col",children:e.columnDescription})]}):null,"tag_name"===e.type?Object(_.jsx)("div",{className:"row",children:Object(_.jsxs)("div",{className:"col",children:["Tag: ",e.tagName]})}):null]})})},"searchRow"+n)}(e,n)}));return Object(_.jsxs)("div",{className:"container searchbox z-200",children:[Object(_.jsx)(B.a,{children:Object(_.jsx)(U.a,{children:Object(_.jsxs)("h5",{className:"text-center",children:[e.results.length," search results:"]})})}),n]})};return Object(_.jsx)("div",{children:Object(_.jsx)(n,{})})}}]),n}(a.Component);function Ne(e,t){return we.apply(this,arguments)}function we(){return(we=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/model_search/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e,t){return Te.apply(this,arguments)}function Te(){return(Te=Object(C.a)(y.a.mark((function e(t,n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/models/"+t,{headers:{Authorization:"Token "+n.token}});case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _e=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(l.a)(this,n),(s=t.call(this,e)).selectColumn=function(e){s.props.selectModelColumn(s.state.selectedModel.modelName,e)},s.clearColumns=function(){s.setState({refColumns:{}})},s.CatalogColumns=function(){return Object.keys(s.state.refColumns).length>0?Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsxs)("div",{className:"col",children:["Choose Column:",Object(_.jsxs)("table",{className:"table table-sm",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Name"}),Object(_.jsx)("th",{children:"Type"}),Object(_.jsx)("th",{children:"Description"}),Object(_.jsx)("th",{children:"Tests"})]})}),Object(_.jsx)("tbody",{children:Object.entries(s.state.refColumns).map((function(e,t){return Object(_.jsxs)("tr",{onClick:function(){return s.selectColumn(e[0])},children:[Object(_.jsx)("td",{className:"catalogColumnName",children:e[0].toLowerCase().replaceAll("_","_\u200b")}),Object(_.jsx)("td",{className:"catalogColumnType",children:e[1].type.toLowerCase()}),Object(_.jsx)("td",{children:Object(_.jsx)("div",{children:e[1].description})})]},"columnRow"+e[0])}))})]})]})}):Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col col-md-auto",children:"This model does not appear to contain any columns."})})},s.state={refSearchResults:{},refColumns:{},selectedModel:{}},s.refSearchBox=Object(a.createRef)(),s}return Object(u.a)(n,[{key:"debounceRefSearchResults",value:function(e){var t,n=this;clearTimeout(t),t=setTimeout((function(){Ne(n.refSearchBox.current.value,n.props.user).then((function(e){if(0===e.length||e.error)return null;n.setState({refSearchResults:{searchResults:e}})}))}),1e3)}},{key:"render",value:function(){var e=this;if(0===Object.keys(this.state.refColumns).length&&this.state.refSearchResults&&this.state.refSearchResults.searchResults&&this.state.refSearchResults.searchResults.results&&this.state.refSearchResults.searchResults.results.length>0){return Object(_.jsxs)("div",{children:[Object(_.jsx)("input",{className:"form-control mr-sm-2",type:"search",ref:this.refSearchBox,onFocus:function(){return e.clearColumns()},onChange:function(t){return e.debounceRefSearchResults(t)},placeholder:"Search Models","aria-label":"Search Models"}),Object(_.jsx)(ke,{searchResults:this.state.refSearchResults.searchResults,resultSelectFunction:function(t,n){Me(e.state.refSearchResults.searchResults.results[n].nodeID,e.props.user).then((function(t){t.error||e.setState({refColumns:t.columns,selectedModel:e.state.refSearchResults.searchResults.results[n]})}))}})]})}return Object.keys(this.state.refColumns).length>0?Object(_.jsxs)("div",{children:[Object(_.jsx)("input",{className:"form-control mr-sm-2",type:"search",ref:this.refSearchBox,onFocus:function(){return e.clearColumns()},onChange:function(t){return e.debounceRefSearchResults(t)},placeholder:"Search Models","aria-label":"Search Models"}),Object(_.jsx)(this.CatalogColumns,{})]}):Object(_.jsx)("div",{children:Object(_.jsx)("input",{className:"form-control mr-sm-2",type:"search",ref:this.refSearchBox,onFocus:function(){return e.clearColumns()},onChange:function(t){return e.debounceRefSearchResults(t)},placeholder:"Search Models","aria-label":"Search Models"})})}}]),n}(a.Component);function Le(){return(Le=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/model_tree",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e){return De.apply(this,arguments)}function De(){return(De=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/db_tree",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fe=n(145),Ae=n.n(Fe),Ie=n(187),Ke=(n(625),n(293)),Pe=n(146),He=n.n(Pe);function ze(e){var t=Object(h.g)(),n=Object(a.useState)({}),s=Object(m.a)(n,2),r=s[0],c=s[1],i=Object(a.useState)(),l=Object(m.a)(i,2),u=l[0],d=l[1],j=Object(a.useState)(),b=Object(m.a)(j,2),p=(b[0],b[1]),O=Object(a.useState)(),v=Object(m.a)(O,2),y=v[0],C=v[1],S=Object(a.useState)(),k=Object(m.a)(S,2),N=k[0],w=k[1],M=Object(a.useState)(),T=Object(m.a)(M,2),L=(T[0],T[1],Object(h.i)("/catalog/search/:searchQuery"),Object(a.useState)("databases")),R=Object(m.a)(L,2),D=R[0],F=R[1],A=Object(a.useState)(),I=Object(m.a)(A,2),K=I[0],P=I[1],G=Object(a.useState)(),J=Object(m.a)(G,2),q=J[0],Q=J[1],Y=Object(a.useRef)(),W=Object(a.useRef)(),X=Object(h.i)(),Z=X.path;X.url;function $(){var t=function(){w(null)};return Object(_.jsxs)(V.a,{show:N,onHide:t,children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:"Reference Test Setup"})}),Object(_.jsxs)(V.a.Body,{children:["Model to reference:",Object(_.jsx)(_e,{user:e.user,selectModelColumn:function(e,n){var a=[],s={type:"relationships",severity:"ERROR",related_model:e,related_field:n};for(var i in a.push({relationships:{to:"ref('"+e+"')",field:n}}),c(Object(o.a)(Object(o.a)({},r),{},{columns:Object(o.a)(Object(o.a)({},r.columns),{},Object(pe.a)({},N.column.name,Object(o.a)(Object(o.a)({},r.columns[N.column.name]),{},{tests:[].concat(Object(H.a)(r.columns[N.column.name].tests),[s])})))})),r.columns[N.column.name].tests)"relationships"===r.columns[N.column.name].tests[i].type?a.push(Object(pe.a)({},r.columns[N.column.name].tests[i].type,{to:"ref('"+r.columns[N.column.name].tests[i].related_model+"')",field:r.columns[N.column.name].tests[i].related_field})):a.push(r.columns[N.column.name].tests[i].type);se({column:N.column.name,tests:a,target:{dataset:{metadatafield:"ColumnTest"}}}),t()}})]})]})}Object(a.useEffect)((function(){(function(e){return Le.apply(this,arguments)})(e.user).then((function(e){e.error||(d(e),P(ee(e)),console.log(ee(e)))})),Re(e.user).then((function(e){e.error||(p(e),Q(ne(e)),console.log(ne(e)))}))}),[]);var ee=function(e){return[te(e,"model","model")].concat([te(e,"source","source")])},te=function e(t,n,a){var s,r=[];if(s=n?t[n]:t,Object.keys(s)&&Object.keys(s)&&Object.keys(s).length>0){for(var c in s)r.push(e(s,c,a+"."+c));return{label:n,key:a,nodes:r}}return{label:n,key:a}},ne=function(e){return ae(e.db_models)},ae=function(e){var t=[];for(var n in e){0!==t.filter((function(t){return t.label===e[n].database})).length&&0!==t.filter((function(t){return t.label===e[n].database}))[0].length||t.push({label:e[n].database,key:e[n].database,nodes:[]});var a=t.filter((function(t){return t.key===e[n].database}))[0].nodes;a&&0!==a.length&&0!==a.filter((function(t){return t.label===e[n].schema})).length||a.push({label:e[n].schema,key:e[n].schema,nodes:[]}),a.filter((function(t){return t.key===e[n].schema}))[0].nodes.push({label:e[n].name,key:e[n].nodeID})}return t};function se(t){var n={};switch(t.target.dataset.metadatafield){case"Description":n={updateMethod:"yamlModelProperty",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,property_name:"description",new_value:t.target.innerText},c(Object(o.a)(Object(o.a)({},r),{},{description:t.target.innerText}));break;case"Tags":if("None"===t.target.innerText){n=null;break}n={updateMethod:"yamlModelTags",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,property_name:"tags",new_value:t.target.innerText.split(",").map((function(e){return e.trim()}))},c(Object(o.a)(Object(o.a)({},r),{},{tags:t.target.innerText.split(",").map((function(e){return e.trim()}))}));break;case"ColumnDescription":n={updateMethod:"yamlModelColumnProperty",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,column:t.target.dataset.columnname,property_name:"description",new_value:t.target.innerText},c(Object(o.a)(Object(o.a)({},r),{},{columns:Object(o.a)(Object(o.a)({},r.columns),{},Object(pe.a)({},t.target.dataset.columnname,Object(o.a)(Object(o.a)({},r.columns[t.target.dataset.columnname]),{},{description:t.target.innerText})))}));break;case"ColumnTest":n={updateMethod:"yamlModelColumnTest",yaml_path:r.yaml_path,model_path:r.model_path,model:r.name,node_id:r.nodeID,column:t.column,new_value:t.tests}}n&&fetch("/api/v1/update_metadata",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+e.user.token},body:JSON.stringify(n)})}function re(e,t){function n(e){var t=Object(a.useState)(!1),n=Object(m.a)(t,2),s=n[0],c=n[1],o=function(){return c(!1)};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(f.a,{className:"tealButton",onClick:function(){return c(!0)},children:"Show Lineage"}),Object(_.jsxs)(V.a,{show:s,onHide:o,size:"xl",children:[Object(_.jsx)(V.a.Header,{closeButton:!0,children:Object(_.jsx)(V.a.Title,{children:r.name})}),Object(_.jsx)(V.a.Body,{className:"lineagebox",children:Object(_.jsx)(Se,{className:"lineagebox",lineageArray:e})}),Object(_.jsx)(V.a.Footer,{children:Object(_.jsx)(f.a,{variant:"secondary",onClick:o,children:"Close"})})]})]})}return Object(_.jsx)(n,{lineage:e})}function ce(){if("node"===r.model_type&&r.created_by)return Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsxs)("div",{className:"col col-md-auto",children:["Created: ",r.created_by+(r.created_relative_date?", "+r.created_relative_date:null)]})})}function oe(e){if(e){var t="",n=e.split(".");for(var a in n)t+=e.substring(0,e.indexOf(n[a])+n[a].length)+"/";var s=t.slice(0,-1);return console.log(s),s}return null}function ie(){var n=Object(h.h)().searchQuery;if(y&&y.searchString===n){return Object(_.jsx)(ke,{searchResults:y,resultSelectFunction:function(e,n){t.push("/catalog/"+y.results[n].nodeID)}})}return Ne(n,e.user).then((function(e){if(0===e.length||e.error)return C([]),null;e.searchString===window.location.href.split("/").pop()&&C(e)})),Object(_.jsx)("div",{children:"Loading Search Results..."})}function le(){var n=Object(h.h)().catalogPage;if(0===Object.keys(r).length||r.nodeID!==n)return Me(n,e.user).then((function(e){e.error||(c(e),u&&P(ee(u)))})),Re(e.user).then((function(e){e.error||(p(e),Q(ne(e)),console.log(ne(e)))})),Object(_.jsx)("div",{children:"No Model Found"});var a=r.tags.length>0?r.tags.join(", "):null;return Object(_.jsxs)(z.a,{className:"catalogContainer display-block",children:[Object(_.jsxs)("div",{className:"row justify-content-md-left",children:[Object(_.jsx)("div",{className:"col col-md-auto pr-md-3",children:Object(_.jsx)("h3",{className:"mb-md-0",children:r.name.toLowerCase()})}),Object(_.jsx)("div",{className:"col font-italic align-self-end pl-md-0",children:r.materialization}),Object(_.jsxs)("div",{className:"col align-self-end pl-md-0 text-right",children:["tags: ",Object(_.jsx)("i",{children:Object(_.jsx)(Ae.a,{innerRef:a,html:a,onBlur:se,"data-metadatafield":"Tags",placeholder:"Add comma-separated Tags",style:{display:"inline",minWidth:"100px"}})})]})]}),Object(_.jsxs)("div",{className:"row justify-content-between pt-md-1",children:[Object(_.jsxs)("div",{className:"col col-md-auto",children:[r.database.toLowerCase(),".",r.schema.toLowerCase(),".",r.name.toLowerCase()]}),Object(_.jsx)("div",{className:"col col-md-auto",children:r.row_count?Number(r.row_count).toLocaleString()+" rows":null})]}),ce(),Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(Ae.a,{innerRef:r.description,html:r.description?r.description:null,onBlur:se,"data-metadatafield":"Description",placeholder:"Add a description"})})}),Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:re(r.lineage,e.selectModel)})}),Object(_.jsxs)(me.a,{className:"mt-md-3",defaultActiveKey:"0",children:[Object(_.jsxs)(Oe.a,{children:[Object(_.jsx)(Oe.a.Header,{children:Object(_.jsx)(me.a.Toggle,{as:f.a,variant:"link",eventKey:"0",children:"Columns"})}),Object(_.jsx)(me.a.Collapse,{eventKey:"0",children:Object(_.jsx)("div",{className:"container",children:Object.keys(r.columns).length>0?Object(_.jsx)("div",{className:"row mt-md-3",children:Object(_.jsx)("div",{className:"col",children:Object(_.jsxs)("table",{className:"table table-sm",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Name"}),Object(_.jsx)("th",{children:"Type"}),Object(_.jsx)("th",{children:"Description"}),Object(_.jsx)("th",{children:"Tests"})]})}),Object(_.jsx)("tbody",{children:Object.entries(r.columns).map((function(e,t){var n=[{value:"not_null",label:"Not Null",column:e[1].name,color:"#FF0000"},{value:"unique",label:"Unique",column:e[1].name,color:"#FF0000"},{value:"relationships",label:"Relationship",column:e[1].name,color:"#FF0000"}],a={control:function(e){return Object(o.a)(Object(o.a)({},e),{},{backgroundColor:"white"})},option:function(e,t){var n=t.data,a=t.isDisabled,s=t.isFocused,r=t.isSelected,c=He()(n.color);return Object(o.a)(Object(o.a)({},e),{},{backgroundColor:a?null:r?n.color:s?c.alpha(.1).css():null,color:a?"#ccc":r?He.a.contrast(c,"white")>2?"white":"black":n.color,cursor:a?"not-allowed":"default",":active":Object(o.a)(Object(o.a)({},e[":active"]),{},{backgroundColor:!a&&(r?n.color:c.alpha(.3).css())})})},multiValue:function(e,t){var n=t.data,a=He()(n.color);return Object(o.a)(Object(o.a)({},e),{},{backgroundColor:a.alpha(.1).css()})},multiValueLabel:function(e,t){var n=t.data;return Object(o.a)(Object(o.a)({},e),{},{color:n.color})},multiValueRemove:function(e,t){var n=t.data;return Object(o.a)(Object(o.a)({},e),{},{color:n.color,":hover":{backgroundColor:n.color,color:"white"}})}};return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{className:"catalogColumnName",children:e[0].toLowerCase().replaceAll("_","_\u200b")}),Object(_.jsx)("td",{className:"catalogColumnType",children:e[1].type.toLowerCase()}),Object(_.jsx)("td",{children:Object(_.jsx)(Ae.a,{html:e[1].description,onBlur:se,"data-metadatafield":"ColumnDescription",className:"catalogColumnDescription","data-columnName":e[0].toLowerCase(),placeholder:"Add a description"})}),Object(_.jsx)("td",{style:{width:"230px"},children:Object(_.jsx)(Ke.a,{options:n,value:function(t){var n=[];for(var a in t){var s="#000000",r="",c="";"ERROR"===e[1].tests[a].severity?s="#FF0000":"WARNING"===e[1].tests[a].severity&&(s="#FFFF00"),"relationships"===e[1].tests[a].type?(r="relationships",c=Object(_.jsx)("span",{title:e[1].tests[a].related_model+"."+e[1].tests[a].related_field,children:"Relationship"})):"not_null"===e[1].tests[a].type?(r="not_null",c="Not Null"):"unique"===e[1].tests[a].type&&(r="unique",c="Unique"),n.push({value:r,label:c,color:s})}return n}(r.columns[e[0]].tests),isMulti:!0,onChange:function(t,n){var a=[];if("select-option"===n.action){var s={};for(var i in"unique"===n.option.value||"not_null"===n.option.value?(s={type:n.option.value,severity:"ERROR"},a.push(n.option.value),c(Object(o.a)(Object(o.a)({},r),{},{columns:Object(o.a)(Object(o.a)({},r.columns),{},Object(pe.a)({},n.option.column,Object(o.a)(Object(o.a)({},r.columns[n.option.column]),{},{tests:[].concat(Object(H.a)(r.columns[n.option.column].tests),[s])})))}))):"relationships"===n.option.value&&(w({column:e[1]}),c(r)),r.columns[e[0]].tests)"relationships"===r.columns[e[0]].tests[i].type?a.push(Object(pe.a)({},r.columns[e[0]].tests[i].type,{to:"ref('"+r.columns[e[0]].tests[i].related_model+"')",field:r.columns[e[0]].tests[i].related_field})):a.push(r.columns[e[0]].tests[i].type)}else if("remove-value"===n.action){var l=r.columns[e[0]].tests.indexOf(n.removedValue.value),u=[].concat(Object(H.a)(r.columns[e[0]].tests.slice(0,l)),Object(H.a)(r.columns[e[0]].tests.slice(0,l+1)));for(var i in c(Object(o.a)(Object(o.a)({},r),{},{columns:Object(o.a)(Object(o.a)({},r.columns),{},Object(pe.a)({},e[0],Object(o.a)(Object(o.a)({},r.columns[e[0]]),{},{tests:u})))})),u)"relationships"===u[i].type?a.push(Object(pe.a)({},u[i].type,{to:"ref('"+u[i].related_model+"')",field:u[i].related_field})):a.push(u[i].type)}se({column:e[0],tests:a,target:{dataset:{metadatafield:"ColumnTest"}}})},styles:a,menuPortalTarget:document.body})})]},"columnRow"+e[0])}))})]})})}):Object(_.jsx)("div",{className:"row",children:Object(_.jsx)("div",{className:"col col-md-auto",children:"This model does not appear to contain any columns."})})})})]}),Object(_.jsxs)(Oe.a,{children:[Object(_.jsx)(Oe.a.Header,{children:Object(_.jsx)(me.a.Toggle,{as:f.a,variant:"link",eventKey:"1",children:"SQL"})}),Object(_.jsx)(me.a.Collapse,{eventKey:"1",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsxs)(x.a,{defaultActiveKey:"raw",id:"uncontrolled-tab-example",className:"ml-md-1",children:[Object(_.jsx)(g.a,{eventKey:"raw",title:"raw SQL",className:"py-md-3 catalogSQL",children:r.raw_sql}),Object(_.jsx)(g.a,{eventKey:"processed",title:"processed SQL",className:"py-md-3 catalogSQL",children:r.compiled_sql})]})})})})})]}),Object(_.jsxs)(Oe.a,{children:[Object(_.jsx)(Oe.a.Header,{children:Object(_.jsx)(me.a.Toggle,{as:f.a,variant:"link",eventKey:"2",children:"Code Change History"})}),Object(_.jsx)(me.a.Collapse,{eventKey:"2",children:Object(_.jsxs)("div",{className:"container",children:[Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:r.all_contributors.length>1?Object(_.jsx)(_.Fragment,{children:r.all_contributors.map((function(e,t){return Object(_.jsxs)("div",{title:e,children:[0===t?Object(_.jsxs)("b",{children:["Contributors:",Object(_.jsx)("br",{})]}):null,e]},"nodeContributor"+t)}))}):null})}),Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)("table",{className:"table",children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{scope:"col",children:"Date"}),Object(_.jsx)("th",{scope:"col",children:"Author"}),Object(_.jsx)("th",{scope:"col",children:"Commit Message"})]})}),Object(_.jsx)("tbody",{children:r.all_commits.map((function(e,t){return Object(_.jsxs)("tr",{title:e.hash,children:[Object(_.jsx)("td",{title:e.authorDate,children:e.authorDateRel}),Object(_.jsx)("td",{children:e.authorName}),Object(_.jsx)("td",{children:Object(_.jsx)("a",{href:null!==e.originURL?e.originURL:null,target:"_blank",children:e.subject})})]},"catalogFileCommit "+t)}))})]})})})})]})})]}),Object(_.jsxs)(Oe.a,{children:[Object(_.jsx)(Oe.a.Header,{children:Object(_.jsx)(me.a.Toggle,{as:f.a,variant:"link",eventKey:"3",children:"Depends On"})}),Object(_.jsx)(me.a.Collapse,{eventKey:"3",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsxs)(_.Fragment,{children:[r.depends_on?r.depends_on.nodes.map((function(e,n){return Object(_.jsxs)("div",{title:e,children:[0===n?Object(_.jsxs)("b",{children:["Models:",Object(_.jsx)("br",{})]}):null,Object(_.jsx)("a",{href:"#",onClick:function(n){n.preventDefault(),t.push("/catalog/"+e)},children:e.split(".").pop()})]},"catalogDependsOnModel"+n)})):null,r.depends_on?r.depends_on.macros.map((function(e,t){return Object(_.jsxs)("div",{title:e,children:[0===t?Object(_.jsxs)("b",{children:["Macros:",Object(_.jsx)("br",{})]}):null,e.split(".").pop()]},"catalogDependsOnMacro"+t)})):null]})})})})})]}),Object(_.jsxs)(Oe.a,{children:[Object(_.jsx)(Oe.a.Header,{children:Object(_.jsx)(me.a.Toggle,{as:f.a,variant:"link",eventKey:"4",children:"Dependencies"})}),Object(_.jsx)(me.a.Collapse,{eventKey:"4",children:Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row mt-md-3 mb-md-3",children:Object(_.jsx)("div",{className:"col col-md-auto",children:Object(_.jsx)(_.Fragment,{children:r.referenced_by.map((function(e,n){return Object(_.jsxs)("div",{title:e,children:[0===n?Object(_.jsxs)("b",{children:["Models:",Object(_.jsx)("br",{})]}):null,Object(_.jsx)("a",{href:"#",onClick:function(n){n.preventDefault(),t.push("/catalog/"+e)},children:e.split(".").pop()})]},"catalogDependentModel"+n)}))})})})})})]})]}),Object(_.jsx)($,{})]})}return Object(_.jsx)(z.a,{fluid:!0,children:Object(_.jsxs)(B.a,{className:"flex-xl-nowrap",children:[Object(_.jsx)(U.a,{as:function(e){var n=Object(a.useState)(!1),s=Object(m.a)(n,2),c=s[0],i=s[1],l=function(e){console.log(e),!1===e.hasNodes?t.push("/catalog/"+e.key.split("/").pop()):(Y.current.resetOpenNodes(Y.current.state.openNodes,oe(r.nodeID)),Y.current.toggleNode(e.key),W.current.resetOpenNodes(W.current.state.openNodes,[r.database,r.database+"/"+r.schema]),W.current.toggleNode(e.key))};return Object(_.jsxs)(fe.Drawer,Object(o.a)(Object(o.a)({},e),{},{children:[Object(_.jsx)(fe.Drawer.Toggle,{onClick:function(){return i(!c)}}),Object(_.jsx)(E.a,{in:c,children:Object(_.jsx)(fe.Drawer.Overflow,{children:Object(_.jsx)(fe.Drawer.Nav,{children:Object(_.jsxs)(x.a,{activeKey:D,id:"treemenu",onSelect:function(e){return F(e)},className:"treeTabs nav nav-tabs nav-justified",children:[Object(_.jsx)(g.a,{eventKey:"folders",title:"Project View",children:Object(_.jsx)(Ie.a,{data:K,initialActiveKey:oe(r.nodeID),initialOpenNodes:function(e){if(e){var t=[],n=e.split(".");for(var a in n)t.push(oe(e.substring(0,e.indexOf(n[a])+n[a].length)));return console.log(t),t}return null}(r.nodeID),onClickItem:l,ref:Y,hasSearch:!1})}),Object(_.jsx)(g.a,{eventKey:"databases",title:"Database View",children:Object(_.jsx)(Ie.a,{data:q,initialActiveKey:r.database+"/"+r.schema+"/"+r.nodeID,initialOpenNodes:[r.database,r.database+"/"+r.schema],onClickItem:l,ref:W,hasSearch:!1})})]})})})})]}))},xs:12,md:4,lg:3}),Object(_.jsx)(U.a,{children:Object(_.jsxs)(h.d,{children:[Object(_.jsx)(h.b,{exact:!0,path:Z}),Object(_.jsx)(h.b,{path:"".concat(Z,"/search/:searchQuery"),children:Object(_.jsx)(ie,{})}),Object(_.jsx)(h.b,{path:"".concat(Z,"/search/"),children:Object(_.jsx)(ie,{})}),Object(_.jsx)(h.b,{path:"".concat(Z,"/:catalogPage"),children:Object(_.jsx)(le,{})})]})})]})})}function Be(){return(Be=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/get_ssh",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(){return(Ue=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/generate_ssh",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return(Ee=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/open_git_connection",{headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=Object(C.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/check_dbt_connection",{method:"GET",headers:{Authorization:"Token "+t.token}});case 2:return n=e.sent,e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Je=n(72),Ve=(n(636),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).handleAllClicks=function(e){!0===a.state.contextMenuOpen&&a.setState({contextMenuOpen:!1})},a.openContextMenu=function(e){!0===e?a.setState({contextMenuOpen:!0}):a.setState({contextMenuOpen:!1})},a.logState=function(){a.setState({logState:!0})},a.openSQLPanel=function(){a.setState({openSQLPanel:!0})},a.addModel=function(){},a.openModelBuilder=function(){a.setState({appState:"ModelBuilder"})},a.openCatalog=function(){a.setState({appState:"Catalog"})},a.openConfig=function(){a.setState({appState:"Config"})},a.setUser=function(e){a.setState({user:e.user})},a.setUserConfig=function(e){a.setState({userConfig:e})},a.setSSHKey=function(){(function(e){return Be.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){a.setState({sshKey:e})}))},a.generateSSHKey=function(){(function(e){return Ue.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){a.setState({sshKey:e})}))},a.openGitConnection=function(){(function(e){return Ee.apply(this,arguments)})(a.state.user).then((function(e){return e.text()})).then((function(e){return e}))},a.checkDBTConnection=function(){(function(e){return Ge.apply(this,arguments)})(a.state.user).then((function(e){!0===e.ok?Je.b.success("DBT_ Connection Successful."):e.text().then((function(e){Je.b.error("DBT_ Connection Failed: "+e,{autoClose:1e4})}))}))},a.toastSender=function(e,t){"error"===t?Je.b.error(e):"success"===t?Je.b.success(e):Object(Je.b)(e)},a.clearUserMessages=function(){a.setState({userMessages:[]})},a.LoginRoute=function(e){var t=e.children,n=Object(i.a)(e,["children"]);return Object(_.jsx)(h.b,Object(o.a)(Object(o.a)({},n),{},{render:function(e){e.location;return"python"===a.state.hostVersion||Object.keys(a.state.user).length>0?t:Object(_.jsx)(h.a,{to:{pathname:"/login"}})}}))},a.modelBuilder=s.a.createRef();var r="",c={};return"8080"===window.location.port?(r="python",c={token:""}):(r="node",sessionStorage.getItem("user")&&(M(JSON.parse(sessionStorage.getItem("user")).user).then((function(e){a.setState({userConfig:e.user})})),c=JSON.parse(sessionStorage.getItem("user")).user)),document.title="T\u0101ngata",a.state={appState:"Catalog",hostVersion:r,modelBuilder:{models:[{name:"humans"},{name:"abductions"}],logState:!1,openSQLPanel:!1,addModel:{}},contextMenuOpen:!1,catalogModel:{},sshKey:"",user:c,userConfig:{},userMessages:[]},a}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(){!0===this.state.logState&&(console.log("App State:"),console.log(this.state),this.setState({logState:!1})),!0===this.state.openSQLPanel&&this.setState({openSQLPanel:!1})}},{key:"render",value:function(){var e=this,t=null;return(t=Object(p.io)({auth:function(t){t({token:e.state.user})}})).on("connect",(function(){t.send("Hello!")})),t.on("toast",(function(t){e.toastSender(t.message,t.type)})),Object(_.jsx)(b.a,{children:Object(_.jsxs)("div",{id:"main",children:[Object(_.jsxs)(h.d,{children:[Object(_.jsx)(h.b,{exact:!0,path:"/",children:Object(_.jsx)(h.a,{to:"/catalog"})}),Object(_.jsx)(h.b,{path:"/login",children:Object(_.jsx)(L,{setUser:this.setUser,setUserConfig:this.setUserConfig,user:this.state.user,appState:this.state.appState})}),Object(_.jsxs)(this.LoginRoute,{path:["/catalog","/search"],children:[Object(_.jsx)(be,{addModel:this.addModel,hostVersion:this.state.hostVersion,logState:this.logState,openSQLPanel:this.openSQLPanel,openModelBuilder:this.openModelBuilder,openCatalog:this.openCatalog,openConfig:this.openConfig,appState:this.state.appState,openContextMenu:this.openContextMenu,contextMenuOpen:this.state.contextMenuOpen,selectModel:this.selectModel,user:this.state.user,setUser:this.setUser,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig}),Object(_.jsx)("div",{className:"body",children:Object(_.jsx)(ze,{appState:this.state.appState,catalogModel:this.state.catalogModel,selectModel:this.selectModel,user:this.state.user,hostVersion:this.state.hostVersion})})]}),Object(_.jsxs)(this.LoginRoute,{path:"/config",children:[Object(_.jsx)(be,{addModel:this.addModel,logState:this.logState,openSQLPanel:this.openSQLPanel,openModelBuilder:this.openModelBuilder,openCatalog:this.openCatalog,openConfig:this.openConfig,appState:this.state.appState,openContextMenu:this.openContextMenu,contextMenuOpen:this.state.contextMenuOpen,selectModel:this.selectModel,user:this.state.user,setUser:this.setUser,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig}),Object(_.jsx)("div",{className:"body",children:Object(_.jsx)(P,{appState:this.state.appState,user:this.state.user,userConfig:this.state.userConfig,setUserConfig:this.setUserConfig,sshKey:this.state.sshKey,setSSHKey:this.setSSHKey,generateSSHKey:this.generateSSHKey,openGitConnection:this.openGitConnection,checkDBTConnection:this.checkDBTConnection,toastSender:this.toastSender})})]})]}),Object(_.jsx)(Je.a,{position:"bottom-center",autoClose:8e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})}}]),n}(a.Component)),qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,653)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))};c.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(Ve,{})}),document.getElementById("root")),qe()}},[[637,1,2]]]);
//# sourceMappingURL=main.e2e16d47.chunk.js.map