{"version":3,"sources":["services/postLoginUser.js","services/postRegisterUser.js","services/refreshMetadata.js","services/getUserConfig.js","services/getServerConfig.js","components/Login.js","services/postUserConfig.js","services/postServerConfig.js","services/postFileUpload.js","services/getDBTCloudAccounts.js","services/getDBTCloudJobs.js","components/Config.js","components/EditJoinPanel.js","components/Models.js","components/AutoComplete.js","components/Conditions.js","components/Selects.js","services/getModelJson.js","components/SQLPanel.js","components/ModelBuilder.js","components/NavBar.js","components/Lineage.js","components/ShowSearchResults.js","services/getModelSearch.js","services/getModel.js","components/RefSearchResults.js","services/getModelTree.js","services/getDBTree.js","components/Catalog.js","services/getSSH.js","services/getGenerateSSH.js","services/getOpenGit.js","services/getCheckDBTConnection.js","App.js","reportWebVitals.js","index.js"],"names":["loginBody","a","fetch","method","headers","body","JSON","stringify","response","json","registerBody","refreshMetadata","user","Authorization","token","getUserConfig","getServerConfig","Login","props","useState","email","setEmail","password","setPassword","firstName","setFirstName","lastName","setLastName","history","useHistory","hostVersion","Object","keys","length","push","class","className","Tabs","defaultActiveKey","id","Tab","eventKey","title","Form","onSubmit","event","preventDefault","postLoginUser","then","setUser","sessionStorage","setItem","setUserConfig","Group","size","controlId","Label","Control","autoFocus","type","value","onChange","e","target","Button","block","disabled","postRegisterUser","setServerConfig","postUserConfig","newConfig","configToSend","_id","postFileUpload","uploadFormData","uploadType","account","Config","copySuccess","setCopySuccess","dbtAccounts","setdbtAccounts","dbtDocsJobs","setdbtDocsJobs","sshKeyRef","useRef","dbtCloudKey","dbtAccountRef","dbtJobRef","updateConfigValue","newValue","updatedField","userConfig","updateServerConfigValue","newServerConfig","serverConfig","postServerConfig","uploadFile","uploadedFiles","uploadData","FormData","append","ok","toastSender","text","responseText","loadDBTAccounts","getDBTCloudAccounts","returnedDBTCloudAccounts","selectAccount","getDBTCloudJobs","current","returnedDBTCloudJobs","console","log","tabClassName","firstname","lastname","variant","onClick","stopPropagation","setSSHKey","prompt","generateSSHKey","as","rows","sshKey","ref","document","queryCommandSupported","select","execCommand","focus","Text","muted","href","gitrepo","openGitConnection","Check","custom","inline","label","checked","dbtmethod","File","required","name","files","feedbackTooltip","checkDBTConnection","placeholder","newKey","keyFile","Blob","updateDBTCloudKey","map","index","job","updateDBTCloudConfig","defaultValue","promotion_tag","demotion_tag","schema_file_settings","use_plus_for_tags","order_schema_yml_by_name","EditJoinPanel","model","modelIndex","saveEditedModel","models","toggleJoinModal","showJoinModal","newModel","setModelState","useForm","register","handleSubmit","handleClose","joinConditionRow","condition","showRemove","fullName","joinConditions","filter","conditions","removeCondition","listJoinConditions","listModelColumns","controlName","listModel","columns","tempListModelColumns","column","columnOption","parse","Modal","show","onHide","Header","closeButton","Title","Body","Container","data","newCondition","condition1Field","conditionOperator","condition2Field","concat","Footer","Models","modelDragEnd","showColumns","highlightedColumns","openContextMenu","contextMenuOpen","editSelect","contextMenu","setContextMenu","display","modelDraw","handleClick","columnRows","columnRowsOutput","pageX","pageY","highlightThisColumn","highlightedColumnIndex","onContextMenu","data-model","data-column","columnRow","draggableId","provided","snapshot","innerRef","draggableProps","dragHandleProps","description","modelsDraw","onDragEnd","droppableId","droppableProps","Overlay","placement","Table","bordered","selectToAdd","parentNode","dataset","contextMenuDisplay","AutocompleteTextField","isTrigger","bind","getMatch","handleChange","handleKeyDown","handleResize","handleSelection","updateCaretPosition","updateHelper","resetHelper","renderAutocompleteList","state","helperVisible","left","matchLength","matchStart","options","fullOptions","selection","top","recentValue","enableSpaceRemovers","refInput","createRef","window","addEventListener","this","prevProps","caret","removeEventListener","str","providedOptions","trigger","matchAny","regex","re","RegExp","triggerLength","triggerMatch","match","i","substring","triggerIdx","newFullOptions","j","matchedSlug","slug","idx","toLowerCase","indexOf","matchIdx","setState","substr","spaceRemovers","spacer","old","getInputSelection","end","Math","max","slice","onKeyDown","passThroughEnter","keyCode","onSelect","part1","part2","setCaretPosition","input","caretPos","getCaretCoordinates","rect","getBoundingClientRect","offsetTop","min","offsetLeft","width","minChars","onRequestOptions","requestOnlyIfNoOptions","maxOptions","offsetX","offsetY","optionNumber","helperOptions","val","highlightStart","onMouseEnter","style","Component","onBlur","rest","stateValue","propagated","assign","constructor","propTypes","forEach","k","React","defaultProps","Conditions","editCondition","editConditionMenu","setEditConditionMenu","conditionRow","md","conditionList","conditionIndex","striped","showConditions","firstChild","conditionToRemove","handleModalClose","menuOpen","conditionCriteria","tempModelColumns","columnIndex","modelColumns","modelFullColumns","conditionToEdit","editConditionMenuDisplay","Selects","selects","highlightColumn","outputModel","editOutputModel","editingField","setEditingField","editingDescription","setEditingDescription","updateColumnAlias","updateColumnDescription","showField","selectsIndex","alias","undefined","data-selectindex","showDescription","highlightColumns","col","tempColumnsToHighlight","inputColumns","onMouseLeave","selectToEdit","selectindex","parseInt","selectToRemove","modelJsonFilename","conditionConcat","tempConditionConcat","selectStatement","tempSelectStatement","selectLine","definition","columnDefinition","selectIndex","fromStatement","tempFromStatement","fromSyntax","joinIndex","whereStatement","tempWhereStatement","SQLPanel","NavBar","addModel","logState","openSQLPanel","openModelBuilder","openCatalog","openConfig","appState","selectModel","searchBox","reactState","getSearchResults","trim","timer","clearTimeout","setTimeout","debounceSearchResults","logout","removeItem","Navbar","expand","Brand","Toggle","aria-controls","Collapse","location","pathname","includes","role","onFocus","aria-label","createPR","submitChanges","prRequestBody","process","logoutButton","dagreGraph","dagre","graphlib","Graph","setDefaultEdgeLabel","nodeWidth","LayoutFlow","layoutedElements","elements","direction","setGraph","rankdir","el","isNode","setNode","height","setEdge","source","layout","nodeWithPosition","node","targetPosition","sourcePosition","position","x","random","y","nodeHeight","getLayoutedElements","lineageArray","lineage","Backdrop","background","zIndex","connectionLineType","onLoad","reactFlowInstance","fitView","padding","includeHiddenNodes","onNodeContextMenu","minZoom","nodeID","open","ShowSearchResults","searchResults","results","sort","firstEl","secondEl","promoteStatus","resultSelectFunction","AllSearchRows","Row","Col","searchString","allSearchRows","searchResult","modelName","xmlns","fill","viewBox","fill-rule","d","modelDescription","columnName","columnDescription","tagName","searchRow","getModelSearch","getModel","modelNodeId","RefSearchResults","selectColumn","selectModelColumn","selectedModel","clearColumns","refColumns","CatalogColumns","entries","replaceAll","refSearchResults","refSearchBox","error","debounceRefSearchResults","getDBTree","Catalog","catalogModel","setCatalogModel","rawModelTree","setRawModelTree","setRawDBTree","setSearchResults","newRefTest","setNewRefTest","useRouteMatch","treeTab","setTreeTab","folderTree","setFolderTree","dbTree","setDBTree","treeFolderRef","treeDBRef","path","url","useContextMenu","AddRefTest","allTests","newTest","thisTest","tests","related_model","related_field","severity","toUpperCase","updateMetadataModel","promoteIcon","demoteIcon","modelLabel","findFolderTreeNode","arr","reduce","item","key","nodes","useEffect","getModelTree","RecurseFullFolderTree","RecurseFullDBTree","RecurseFolderTree","lastItem","modelPath","loopVar","items","b","promote_status","PopulateDBTree","db_models","database","thisDB","schema","sortByLabel","sortByLabelChildren","children","itemDB","itemDBSchema","metadataBody","newTags","newTagsWithPromotion","metadatafield","yaml_path","model_path","innerText","tags","newPromotionStatus","newDBTree","split","columnname","lineageModal","LineageModal","setShow","showCreatedBy","model_type","created_by","created_relative_date","treePath","last","arrayPath","lastIndexOf","o","removedProjectName","splice","getTreeRef","runningFullModel","pop","strPath","pathSoFar","thisModel","SearchPage","searchQuery","useParams","LandingPage","PromotedModels","Card","marginTop","CatalogPage","catalogPage","showPromotionMenu","setModelPromotion","triggerEvent","join","materialization","html","data-metadatafield","minWidth","row_count","Number","toLocaleString","Accordion","Date","now","colourStyles","control","styles","backgroundColor","option","isDisabled","isFocused","isSelected","color","chroma","alpha","css","contrast","cursor","multiValue","multiValueLabel","multiValueRemove","changeTest","removeItemIndex","findIndex","testType","relatedField","replace","newTests","data-columnName","currentTests","testSeverityColor","testLabel","formatTests","isMulti","testValue","testAction","action","removedValue","menuPortalTarget","openMenuOnClick","components","MultiValueContainer","MultiValueClick","textContent","ClearIndicator","raw_sql","compiled_sql","all_contributors","scope","all_commits","hash","authorDate","authorDateRel","authorName","originURL","subject","depends_on","macros","referenced_by","fluid","setOpen","treeModelClick","hasNodes","resetOpenNodes","openNodes","toggleNode","in","Overflow","Nav","activeKey","initialActiveKey","initialOpenNodes","splitNodeID","thisStep","stepsSoFar","currentOpenNodes","onClickItem","hasSearch","xs","lg","exact","App","handleAllClicks","openState","newUser","newUserConfig","getSSH","getGenerateSSH","getOpenGit","getCheckDBTConnection","toast","success","autoClose","message","toastType","clearUserMessages","LoginRoute","render","to","modelBuilder","tempUser","port","getItem","userMessages","socket","io","auth","cb","on","send","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.89379e09.chunk.js","sourcesContent":["export async function postLoginUser(loginBody) {\r\n    // console.log(loginBody);\r\n    const response = await fetch('/api/v1/users/login', {\r\n        method: 'POST', \r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(loginBody)\r\n    });\r\n    return await response.json();\r\n}","export async function postRegisterUser(registerBody) {\r\n    // console.log(registerBody);\r\n    const response = await fetch('/api/v1/users', {\r\n        method: 'POST', \r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(registerBody)\r\n    });\r\n    return await response.json();\r\n}","export async function refreshMetadata(user) {\r\n    // console.log(user);\r\n    const response = await fetch('/api/v1/refresh_metadata', {\r\n        method: 'POST', \r\n        headers: {\r\n                Authorization: \"Token \" + user.token\r\n            }\r\n    });\r\n    return await response;\r\n}","export async function getUserConfig(user) {\r\n    const response = await fetch('/api/v1/get_user_config/', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","export async function getServerConfig(user) {\r\n    const response = await fetch('/api/v1/get_server_config', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","import React, { useState } from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport {Tabs, Tab, TabContainer} from \"react-bootstrap\";\r\nimport { postLoginUser } from \"../services/postLoginUser\";\r\nimport { postRegisterUser } from \"../services/postRegisterUser\";\r\nimport { refreshMetadata } from \"../services/refreshMetadata\";\r\nimport { getUserConfig } from \"../services/getUserConfig\";\r\nimport { getServerConfig } from \"../services/getServerConfig\";\r\nimport { useHistory } from 'react-router-dom';\r\n// import \"./Login.css\";\r\n\r\nexport default function Login(props) {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  let history = useHistory();\r\n  if(props.hostVersion === 'python' || Object.keys(props.user).length > 0) {\r\n    // console.log(props.user);\r\n    history.push(\"/\");\r\n  }\r\n\r\n  function validateLoginForm() {\r\n    return email.length > 0 && password.length > 0;\r\n  }\r\n  function validateRegisterForm() {\r\n    return email.length > 0 && password.length > 0 && firstName.length > 0;\r\n  }\r\n\r\n  function handleLogin(event) {\r\n    event.preventDefault(); //stop the click catcher\r\n    var loginBody = {\"user\": {\"email\": email, \"password\": password}};\r\n    postLoginUser(loginBody)\r\n      .then(response => {\r\n        props.setUser(response);\r\n        sessionStorage.setItem(\"user\", JSON.stringify(response));\r\n        refreshMetadata(response.user);\r\n        getUserConfig(response.user)\r\n          .then(response => {\r\n            props.setUserConfig(response.user);\r\n          }\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  function handleRegister(event) {\r\n    event.preventDefault(); //stop the click catcher\r\n    var registerBody = {\"user\": {\"email\": email, \"password\": password, \"config\": {\"firstname\": firstName, \"lastname\": lastName}}};\r\n    postRegisterUser(registerBody)\r\n      .then(response => {\r\n        props.setUser(response);\r\n        sessionStorage.setItem(\"user\", JSON.stringify(response));\r\n        refreshMetadata(response.user);\r\n        getUserConfig(response.user)\r\n          .then(response => {\r\n            props.setUserConfig(response.user);\r\n          }\r\n        );\r\n        getServerConfig(response.user)\r\n          .then(response => {\r\n            props.setServerConfig(response.user);\r\n          }\r\n        );\r\n      }\r\n    );\r\n    \r\n  }\r\n\r\n  return (\r\n    <>\r\n    <nav class=\"navbar-dark bg-brand position-fixed w-100 z-100 navbar navbar-expand-xl navbar-light\"><div class=\"navbar-brand\">TĀNGATA</div></nav>\r\n    <div className=\"Login\">\r\n      <Tabs defaultActiveKey=\"login\" id=\"loginOrRegister\">\r\n        <Tab eventKey=\"login\" title=\"Login\">\r\n          <Form onSubmit={handleLogin}>\r\n            <Form.Group size=\"lg\" controlId=\"loginEmail\">\r\n              <Form.Label>Email</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"loginPassword\">\r\n              <Form.Label>Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Button block size=\"lg\" type=\"submit\" disabled={!validateLoginForm()}>\r\n              Login\r\n            </Button>\r\n          </Form>\r\n        </Tab>\r\n        <Tab eventKey=\"register\" title=\"Sign Up\">\r\n          <Form onSubmit={handleRegister}>\r\n            <Form.Group size=\"lg\" controlId=\"registerEmail\">\r\n              <Form.Label>Email</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"registerPassword\">\r\n              <Form.Label>Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"firstname\">\r\n              <Form.Label>First Name</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                value={firstName}\r\n                onChange={(e) => setFirstName(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"lastname\">\r\n              <Form.Label>Last Name</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                value={lastName}\r\n                onChange={(e) => setLastName(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Button block size=\"lg\" type=\"submit\" disabled={!validateRegisterForm()}>\r\n              Sign Up\r\n            </Button>\r\n          </Form>\r\n        </Tab>\r\n      </Tabs>\r\n      <div className=\"container md-3 text-center col-md-5 mt-3\">\r\n        <blockquote>\r\n          <p>“Hutia te rito o te harakeke<br/>\r\n          Kei whea to kōmako e kō?<br/>\r\n          Ki mai ki ahau<br/>\r\n          He aha te mea nui o te Ao?<br/>\r\n          Maku e kī atu,<br/>\r\n          <b>he tāngata, he tāngata, he tāngata</b>...\"</p>\r\n        </blockquote>\r\n        <p>\r\n          If the heart of the harakeke <em>(flax plant)</em> was removed,<br/>\r\n          where would the bellbird sing?<br/>\r\n          If I was asked what was the most important thing in the world<br/>\r\n          I would be compelled to reply,<br/>\r\n          it is people, it is people, it is people.<br/>\r\n          <em>Ngaroto</em>\r\n        </p>\r\n        <p>\r\n          In te ao Māori (the Māori world view), Tāngata (<em>TAHNG-uh-tuh</em>) describes something much larger than an addressed group of people: it describes <em>whakapapa</em>, the surrounding network of ancestors and descendants we are connected to.<br/>\r\n          With this work we intend to follow these principles to put our people first: not just the data &amp; analytics engineers, but those around our workplaces that know the deep details of how our businesses actually run.<br/>\r\n          These people are the lifeblood of what we do - and to keep moving forward, we need their context far more than ever.\r\n        </p>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}","export async function postUserConfig(user, newConfig) {\r\n    // console.log(newConfig);\r\n    var configToSend = {...newConfig};\r\n    delete configToSend._id;\r\n    delete configToSend.email;\r\n    delete configToSend.token;\r\n    const response = await fetch('/api/v1/set_user_config', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            Authorization: \"Token \" + user.token},\r\n        body: JSON.stringify(configToSend)\r\n    });\r\n    return await response;\r\n}","export async function postServerConfig(user, newConfig) {\r\n    // console.log(newConfig);\r\n    var configToSend = {...newConfig};\r\n    const response = await fetch('/api/v1/set_server_config', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            Authorization: \"Token \" + user.token},\r\n        body: JSON.stringify(configToSend)\r\n    });\r\n    return await response;\r\n}","export async function postFileUpload(uploadFormData, uploadType, user) {\r\n    const response = await fetch('/api/v1/file_upload', {\r\n        method: 'POST', \r\n        headers: {\r\n            'Authorization': \"Token \" + user.token,\r\n            'UploadType': uploadType\r\n        },\r\n        body: uploadFormData\r\n    });\r\n    return await response;\r\n}","export async function getDBTCloudAccounts(user) {\r\n    // console.log(user);\r\n    const response = await fetch('/api/v1/get_dbt_cloud_accounts', {\r\n        method: 'GET', \r\n        headers: {\r\n                Authorization: \"Token \" + user.token\r\n            }\r\n    })\r\n    return await response;\r\n}","export async function getDBTCloudJobs(user, account) {\r\n    // console.log(user);\r\n    const response = await fetch('/api/v1/get_dbt_cloud_jobs/' + account, {\r\n        method: 'GET', \r\n        headers: {\r\n                Authorization: \"Token \" + user.token\r\n            }\r\n    })\r\n    return await response;\r\n}","import {Button, Form, Tabs, Tab, TabContainer } from 'react-bootstrap';\r\nimport React, { useRef, useState } from 'react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { postUserConfig } from \"../services/postUserConfig\";\r\nimport { postServerConfig } from \"../services/postServerConfig\";\r\nimport { postFileUpload } from \"../services/postFileUpload\";\r\nimport { refreshMetadata } from \"../services/refreshMetadata\";\r\nimport { getDBTCloudAccounts } from \"../services/getDBTCloudAccounts\";\r\nimport { getDBTCloudJobs } from \"../services/getDBTCloudJobs\";\r\nexport default function Config(props) {\r\n  const [copySuccess, setCopySuccess] = useState('');\r\n  const [dbtMethod, setdbtMethod] = useState('LiveDB');\r\n  const [dbtAccounts, setdbtAccounts] = useState({});\r\n  const [dbtDocsJobs, setdbtDocsJobs] = useState({});\r\n  const sshKeyRef = useRef(null);\r\n  const dbtCloudKey = useRef(null);\r\n  const dbtAccountRef = useRef(null);\r\n  const dbtJobRef = useRef(null);\r\n  \r\n  function copyToClipboard(e) {\r\n    sshKeyRef.current.select();\r\n    document.execCommand('copy');\r\n    // This is just personal preference.\r\n    // I prefer to not show the whole text area selected.\r\n    e.target.focus();\r\n    setCopySuccess('Copied!');\r\n  };\r\n\r\n\r\n  // console.log(props.userConfig);\r\n  console.log(props.serverConfig);\r\n\r\n  function updateConfigValue(newValue, updatedField) {\r\n    var newConfig = {...props.userConfig};\r\n    newConfig[updatedField] = newValue;\r\n    props.setUserConfig(newConfig);\r\n    postUserConfig(props.user, newConfig);\r\n  }\r\n  \r\n  function updateServerConfigValue(newValue, updatedField) {\r\n    var newServerConfig = {...props.serverConfig};\r\n    newServerConfig[updatedField] = newValue;\r\n    props.setServerConfig(newServerConfig);\r\n    postServerConfig(props.user, newServerConfig);\r\n  }\r\n\r\n  function uploadFile(uploadedFiles, uploadType) {\r\n    // console.log(uploadedFiles[0]);\r\n    if(uploadedFiles.length>0) {\r\n      const uploadData = new FormData();\r\n      uploadData.append('file', uploadedFiles[0]);\r\n      postFileUpload(uploadData, uploadType, props.user)\r\n      .then(response=> {\r\n        // console.log(response);\r\n        if(response.ok === true) {\r\n          // console.log(\"Success\");\r\n          props.toastSender(\"\" + uploadType + \" Upload Successful.\",\"success\");\r\n        } else {\r\n          response.text()\r\n          .then(responseText=> {\r\n            // console.log(response);\r\n            // console.log(responseText);\r\n            props.toastSender(\"\" + uploadType + \" Upload Failed: \\n\" + responseText,\"error\");\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function updateDBTCloudKey(newKey) {\r\n    if(newKey.length>0) {\r\n      const uploadData = new FormData();\r\n      var keyFile = new Blob([newKey], {type: 'text/plain'});\r\n        uploadData.append('file', keyFile);\r\n        postFileUpload(uploadData, 'dbt_ Cloud Key', props.user)\r\n        .then(response=> {\r\n          // console.log(response);\r\n          if(response.ok === true) {\r\n            // console.log(\"Success\");\r\n            props.toastSender(\"dbt_ Cloud Key Upload Successful.\",\"success\");\r\n          } else {\r\n            response.text()\r\n            .then(responseText=> {\r\n              // console.log(response);\r\n              // console.log(responseText);\r\n              props.toastSender(\"dbt_ Cloud Key Upload Failed: \\n\" + responseText,\"error\");\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  function updateDBTCloudConfig() { //doing it manually rather than updateConfigValue because it's two at once - saving one without the other breaks existing config\r\n    var newConfig = {...props.userConfig};\r\n    newConfig[\"dbt_cloud_account\"] = dbtAccountRef.current.value;\r\n    newConfig[\"dbt_cloud_job\"] = dbtJobRef.current.value;\r\n    postUserConfig(props.user, newConfig);\r\n    props.setUserConfig(newConfig);\r\n  }\r\n\r\n  function loadDBTAccounts() {\r\n    getDBTCloudAccounts(props.user)\r\n    .then(response=> response.json())\r\n    .then(returnedDBTCloudAccounts => {\r\n      // console.log(returnedDBTCloudAccounts);\r\n      setdbtAccounts(returnedDBTCloudAccounts);\r\n      selectAccount();\r\n    })\r\n  }\r\n\r\n  function selectAccount() {\r\n    // console.log(\"Account Selected\")\r\n    // console.log(dbtAccountRef.current.value);\r\n    getDBTCloudJobs(props.user, dbtAccountRef.current.value)\r\n    .then(response=> response.json())\r\n    .then(returnedDBTCloudJobs => {\r\n      // console.log(returnedDBTCloudJobs);\r\n      setdbtDocsJobs(returnedDBTCloudJobs);\r\n    });\r\n  }\r\n\r\n  function listDBTDocsJobs() {\r\n    // console.log(dbtDocsJobs);\r\n    return dbtDocsJobs.map((job, index) => {return(<option key={\"dbt job \"+index} value={job.id}>{job.id}: {job.name}</option>)})\r\n  }\r\n  function dbtDocsJobsSelect() {\r\n    if(dbtDocsJobs.length > 0) {\r\n      return(\r\n        <>\r\n          <Form.Group size=\"lg\" controlId=\"dbt_cloud_jobs\">\r\n            <Form.Label>dbt_ Cloud Jobs</Form.Label>\r\n            <Form.Control\r\n              autoFocus\r\n              as=\"select\"\r\n              custom\r\n              ref={dbtJobRef}\r\n            >\r\n              {listDBTDocsJobs()}\r\n            </Form.Control>\r\n          </Form.Group>\r\n          <Button\r\n            variant=\"primary\"\r\n            className=\"m-1\"\r\n            onClick={(e) => {e.stopPropagation(); updateDBTCloudConfig();}}\r\n          >\r\n            Save\r\n          </Button>\r\n        </>\r\n      );\r\n    } else return null;\r\n  }\r\n\r\n  function listDBTAccounts() {\r\n    return dbtAccounts.map((account, index) => {return(<option key={\"dbt account \"+index} value={account.id}>{account.id}: {account.name}</option>)})\r\n  }\r\n  function dbtAccountsSelect() {\r\n    if(dbtAccounts.length > 0) {\r\n      return(\r\n        <Form.Group size=\"lg\" controlId=\"dbt_cloud_accounts\">\r\n          <Form.Label>dbt_ Cloud Accounts</Form.Label>\r\n          <Form.Control\r\n            autoFocus\r\n            as=\"select\"\r\n            custom\r\n            ref={dbtAccountRef}\r\n            onChange={e => selectAccount()}\r\n          >\r\n            {listDBTAccounts()}\r\n          </Form.Control>\r\n        </Form.Group>);\r\n    } else return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mt-3\">\r\n      <h1>Config</h1>\r\n      <Tabs defaultActiveKey={props.hostVersion === 'python' ? \"modelPromotion\" : \"userdetails\"} id=\"config\">\r\n        <Tab eventKey=\"userdetails\" title=\"User Details\" className=\"border-right border-left border-bottom p-3\" tabClassName={props.hostVersion === 'python' ? 'd-none' : ''}>\r\n          <Form>\r\n            {/* <Form.Group size=\"lg\" controlId=\"loginEmail\"> //let's not change email addresses for now.\r\n              <Form.Label>Email</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"email\"\r\n                value={props.user.email}\r\n                onChange={(e) => updateConfigValue(e.target.value, \"email\")}\r\n              />\r\n            </Form.Group> */}\r\n            <Form.Group size=\"lg\" controlId=\"firstname\">\r\n              <Form.Label>First Name</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                value={props.userConfig.firstname}\r\n                onChange={(e) => updateConfigValue(e.target.value, \"firstname\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"lastname\">\r\n              <Form.Label>Last Name</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                value={props.userConfig.lastname}\r\n                onChange={(e) => updateConfigValue(e.target.value, \"lastname\")}\r\n              />\r\n            </Form.Group>\r\n          </Form>\r\n        </Tab>\r\n        <Tab eventKey=\"gitConfig\" title=\"Git Config\" className=\"border-right border-left border-bottom p-3\" tabClassName={props.hostVersion === 'python' ? 'd-none' : ''}>\r\n          <Form>\r\n            <Form.Group size=\"lg\" controlId=\"gitSSHKey\">\r\n              <Form.Label>SSH Key</Form.Label>\r\n              <br/>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={(e) => {e.stopPropagation(); props.setSSHKey()}}\r\n                className=\"m-1\"\r\n              >\r\n                Get current SSH public key\r\n              </Button>\r\n              <Button\r\n                variant=\"warning\"\r\n                className=\"m-1\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  let checkIntent = prompt(\"This will delete any current SSH keys. Please type 'New Key' to continue\");\r\n                  if(checkIntent === \"New Key\") {\r\n                    props.generateSSHKey()\r\n                  }\r\n                }}\r\n              >\r\n                Create new SSH Key\r\n              </Button>\r\n              <Form.Control\r\n                autoFocus\r\n                as=\"textarea\"\r\n                rows={2}\r\n                value={props.sshKey}\r\n                ref={sshKeyRef}\r\n                // onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n              {\r\n              /* Logical shortcut for only displaying the \r\n                  button if the copy command exists */\r\n              document.queryCommandSupported('copy') &&\r\n                <div>\r\n                  <Button variant=\"primary\" onClick={copyToClipboard} className=\"m-1\">Copy</Button> \r\n                  {copySuccess}\r\n                </div>\r\n              }\r\n              <Form.Text id=\"gitSSHHelpBlock\" muted>\r\n                Where to add your key:<br/>\r\n                <a href=\"https://github.com/settings/ssh/new\">GitHub SSH Keys - Add New</a><br/>\r\n                <a href=\"https://gitlab.com/profile/keys\">GitLab SSH Keys - Add an SSH key</a><br/>\r\n              </Form.Text>\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"gitrepo\">\r\n              <Form.Label>Git SSH URL</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                value={props.userConfig.gitrepo || ''}\r\n                onChange={(e) => updateConfigValue(e.target.value, \"gitrepo\")}\r\n              />\r\n              <Form.Text id=\"gitSSHHelpBlock\" muted>\r\n                Examples:<br/>\r\n                git@github.com:yourname/yourproject.git<br/>\r\n                git@gitlab.com:yourname/yourproject.git\r\n              </Form.Text>\r\n            </Form.Group>\r\n              <Button\r\n                variant=\"primary\"\r\n                className=\"m-1\"\r\n                onClick={(e) => {e.stopPropagation(); props.openGitConnection()}}\r\n              >\r\n                Clone Git Repository\r\n              </Button>\r\n          </Form>\r\n        </Tab>\r\n        <Tab eventKey=\"dbtConfig\" title=\"DBT Config\" className=\"border-right border-left border-bottom p-3\" tabClassName={props.hostVersion === 'python' ? 'd-none' : ''}>\r\n          <Form>\r\n            <Form.Group size=\"lg\" controlId=\"dbtConfigMethod\">\r\n              <Form.Label>dbt_ Config Method</Form.Label>\r\n              <div key={'custom-inline-radio'} className=\"mb-3\">\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Live Database Connection\"\r\n                  type='radio'\r\n                  id={'LiveDB'}\r\n                  checked={props.userConfig.dbtmethod===\"LiveDB\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateConfigValue(\"LiveDB\", \"dbtmethod\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Upload Compiled Metadata\"\r\n                  type='radio'\r\n                  id={'UploadMetadata'}\r\n                  checked={props.userConfig.dbtmethod===\"UploadMetadata\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateConfigValue(\"UploadMetadata\", \"dbtmethod\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"dbt_ Cloud API\"\r\n                  type='radio'\r\n                  id={'Cloud'}\r\n                  checked={props.userConfig.dbtmethod===\"Cloud\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateConfigValue(\"Cloud\", \"dbtmethod\")}}\r\n                />\r\n              </div>\r\n            </Form.Group>\r\n            <hr/>\r\n            <div className={props.userConfig.dbtmethod===\"LiveDB\"?null:\"d-none\"}>\r\n              <Form.Group size=\"lg\" controlId=\"uploadProfilesYML\">\r\n                <Form.Label>Upload Profiles.YML</Form.Label>\r\n                <Form.File\r\n                  className=\"position-relative\"\r\n                  required\r\n                  name=\"profilesYMLUpload\"\r\n                  onChange={(e) => uploadFile(e.target.files, \"ProfilesYML\") }\r\n                  // isInvalid={!!errors.file}\r\n                  // feedback={errors.file}\r\n                  id=\"profilesYMLUpload\"\r\n                  feedbackTooltip\r\n                />\r\n                <Form.Text id=\"profilesYMLHelpBlock\" muted>\r\n                  To connect to your database, DBT requires a profiles.yml file. See <a href=\"https://docs.getdbt.com/dbt-cli/configure-your-profile\">the dbt_ docs</a> for setup details.\r\n                </Form.Text>\r\n              </Form.Group>\r\n              <Button\r\n                variant=\"primary\"\r\n                className=\"m-1\"\r\n                onClick={(e) => {e.stopPropagation(); props.checkDBTConnection()}}\r\n              >\r\n                Check DBT Connection\r\n              </Button>\r\n            </div>\r\n            <div className={props.userConfig.dbtmethod===\"UploadMetadata\"?null:\"d-none\"}>\r\n              <p><i>To run without connecting to your database, the catalog requires metadata from dbt_.<br/>\r\n              Run <code>dbt docs generate</code> in your dbt_ project, and upload the Manifest and Catalog from /target.</i></p>\r\n              <p><i>To automate this upload, download <code>tangata_refresh.py</code> from the Tangata git repository, and run it in the root of your project.</i></p> \r\n              <Form.Group size=\"lg\" controlId=\"uploadManifestJSON\">\r\n                <Form.Label>Upload manifest.json</Form.Label>\r\n                <Form.File\r\n                  className=\"position-relative\"\r\n                  required\r\n                  name=\"manifestJSONUpload\"\r\n                  onChange={(e) => uploadFile(e.target.files, \"ManifestJSON\") }\r\n                  // isInvalid={!!errors.file}\r\n                  // feedback={errors.file}\r\n                  id=\"manifestJSONUpload\"\r\n                  feedbackTooltip\r\n                />\r\n              </Form.Group>\r\n              <Form.Group size=\"lg\" controlId=\"uploadCatalogJSON\">\r\n                <Form.Label>Upload catalog.json</Form.Label>\r\n                <Form.File\r\n                  className=\"position-relative\"\r\n                  required\r\n                  name=\"catalogJSONUpload\"\r\n                  onChange={(e) => uploadFile(e.target.files, \"CatalogJSON\") }\r\n                  // isInvalid={!!errors.file}\r\n                  // feedback={errors.file}\r\n                  id=\"catalogJSONUpload\"\r\n                  feedbackTooltip\r\n                />\r\n              </Form.Group>\r\n              <Button\r\n                variant=\"primary\"\r\n                className=\"m-1\"\r\n                onClick={(e) => {e.stopPropagation(); refreshMetadata(props.user);}}\r\n              >\r\n                Load Metadata\r\n              </Button>\r\n            </div>\r\n            <div className={props.userConfig.dbtmethod===\"Cloud\"?null:\"d-none\"}>\r\n              <Form.Group size=\"lg\" controlId=\"firstname\">\r\n                <Form.Label>dbt_ Cloud API Key</Form.Label>\r\n                <Form.Control\r\n                  autoFocus\r\n                  type=\"text\"\r\n                  placeholder=\"Change dbt_ Cloud Key\"\r\n                  ref={dbtCloudKey}\r\n                />\r\n              </Form.Group>\r\n              <Button\r\n                variant=\"primary\"\r\n                className=\"m-1\"\r\n                onClick={(e) => {e.stopPropagation(); updateDBTCloudKey(dbtCloudKey.current.value); loadDBTAccounts();}}\r\n              >Load dbt_ Cloud Accounts</Button>\r\n              {dbtAccountsSelect()}\r\n              {dbtDocsJobsSelect()}\r\n            </div>\r\n          </Form>\r\n        </Tab>\r\n        <Tab eventKey=\"modelPromotion\" title=\"Model Promotion\" className=\"border-right border-left border-bottom p-3\" tabClassName={props.hostVersion !== 'python' ? 'd-none' : ''}>\r\n        {/* TODO: Add Node config for this */}\r\n          <Form>\r\n            <Form.Group size=\"lg\" controlId=\"promotion_tag\">\r\n              <Form.Label>Promotion Tag</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                defaultValue={props.serverConfig.promotion_tag}\r\n                onChange={(e) => updateServerConfigValue(e.target.value, \"promotion_tag\")}\r\n              />\r\n              <Form.Text id=\"promotionTagHelpBlock\" muted>\r\n                This tag will be used in your dbt repository for models you promote in Tāngata. These models will be highlighted in search.\r\n              </Form.Text>\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"demotion_tag\">\r\n              <Form.Label>Demotion Tag</Form.Label>\r\n              <Form.Control\r\n                autoFocus\r\n                type=\"text\"\r\n                defaultValue={props.serverConfig.demotion_tag}\r\n                onChange={(e) => updateServerConfigValue(e.target.value, \"demotion_tag\")}\r\n              />\r\n              <Form.Text id=\"demotionTagHelpBlock\" muted>\r\n                This tag will be used in your dbt repository for models you demote in Tāngata. These models will be dimmed in search, and will appear after other results.\r\n              </Form.Text>\r\n            </Form.Group>\r\n          </Form>\r\n        </Tab>\r\n        <Tab eventKey=\"yamlConfig\" title=\"YAML Config\" className=\"border-right border-left border-bottom p-3\" tabClassName={props.hostVersion !== 'python' ? 'd-none' : ''}>\r\n        {/* TODO: Add Node config for this */}\r\n          <Form>\r\n            <Form.Group size=\"lg\" controlId=\"newYAMLNaming\">\r\n              <Form.Label>New YAML file behaviour</Form.Label>\r\n              <div key={'custom-inline-radio'} className=\"mb-3\">\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"One YAML per folder, named foldername.yml\"\r\n                  type='radio'\r\n                  id={'file_per_folder__folder_name'}\r\n                  checked={props.serverConfig.schema_file_settings===\"file_per_folder__folder_name\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"file_per_folder__folder_name\", \"schema_file_settings\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"One YAML per folder, named schema.yml\"\r\n                  type='radio'\r\n                  id={'file_per_folder__schema_yml'}\r\n                  checked={props.serverConfig.schema_file_settings===\"file_per_folder__schema_yml\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"file_per_folder__schema_yml\", \"schema_file_settings\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"One YAML per model, named modelname.yml\"\r\n                  type='radio'\r\n                  id={'file_per_model__model_name'}\r\n                  checked={props.serverConfig.schema_file_settings===\"file_per_model__model_name\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"file_per_model__model_name\", \"schema_file_settings\")}}\r\n                />\r\n              </div>\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"plusForTags\">\r\n              <Form.Label>Use + as tags prefix in dbt_project.yml</Form.Label>\r\n              <div key={'custom-inline-radio'} className=\"mb-3\">\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Use '+tags' in dbt_project.yml\"\r\n                  type='radio'\r\n                  id={'plus_for_tags'}\r\n                  checked={props.serverConfig.use_plus_for_tags===\"true\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"true\", \"use_plus_for_tags\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Use 'tags' in dbt_project.yml\"\r\n                  type='radio'\r\n                  id={'no_plus_for_tags'}\r\n                  checked={props.serverConfig.use_plus_for_tags===\"false\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"false\", \"use_plus_for_tags\")}}\r\n                />\r\n              </div>\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"reorderSchemaYml\">\r\n              <Form.Label>Reorder all yml files alphabetically</Form.Label>\r\n              <div key={'custom-inline-radio'} className=\"mb-3\">\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Order schema.yml, sources.yml and dbt_project.yml models alphabetically\"\r\n                  type='radio'\r\n                  id={'reorder_yml'}\r\n                  checked={props.serverConfig.order_schema_yml_by_name===\"true\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"true\", \"order_schema_yml_by_name\")}}\r\n                />\r\n                <Form.Check\r\n                  custom\r\n                  inline\r\n                  label=\"Add new records to the bottom, wherever they are\"\r\n                  type='radio'\r\n                  id={'leave_yml_order_in_place'}\r\n                  checked={props.serverConfig.order_schema_yml_by_name===\"false\"}\r\n                  onClick={(e) => {e.stopPropagation(); updateServerConfigValue(\"false\", \"order_schema_yml_by_name\")}}\r\n                />\r\n              </div>\r\n            </Form.Group>\r\n          </Form>\r\n        </Tab>\r\n        {/* <Tab eventKey=\"password\" title=\"Change Password\" className=\"border-right border-left border-bottom p-3\">\r\n        <Form>\r\n            <Form.Group size=\"lg\" controlId=\"loginPassword\">\r\n              <Form.Label>Current Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                // onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"newPassword\">\r\n              <Form.Label>New Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                // onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group size=\"lg\" controlId=\"repeatNewPassword\">\r\n              <Form.Label>Repeat New Password</Form.Label>\r\n              <Form.Control\r\n                type=\"password\"\r\n                // onChange={(e) => setPassword(e.target.value)}\r\n              />`\r\n            </Form.Group>\r\n          </Form>\r\n        </Tab> */}\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react';\r\nimport {Modal, Button, Form, Container} from 'react-bootstrap';\r\nimport { useForm } from \"react-hook-form\";\r\n\r\nexport function EditJoinPanel( {model, modelIndex, saveEditedModel, models, toggleJoinModal, showJoinModal}) {\r\n  const [newModel, setModelState] = useState(model);\r\n  const { register, handleSubmit } = useForm();\r\n  if(modelIndex===0) return null;\r\n  // console.log(\"Start of join panel debug\");\r\n  // console.log(showJoinModal);\r\n  // console.log(models);\r\n  // console.log(modelIndex);\r\n  // console.log(model);\r\n  // console.log(newModel);\r\n\r\n    const handleClose = () => toggleJoinModal(-1);\r\n    const handleShow = () => {\r\n      setModelState(JSON.parse(JSON.stringify(model)));\r\n      toggleJoinModal(modelIndex);\r\n    }\r\n\r\n    const handleSaveAndClose = () => {\r\n      // TODO: Create join output columns\r\n      saveEditedModel(model, newModel);\r\n      handleClose();\r\n    }\r\n\r\n    // new join condition submit\r\n    const onSubmit = (data) => {\r\n      var newCondition = (\r\n        {\r\n          \"conditionField1\": {\r\n            \"model\": model.name,\r\n            \"column\": data.condition1Field\r\n          },\r\n          \"conditionOperator\": data.conditionOperator,\r\n          \"conditionField2\": {\r\n            \"model\": models.response.models[modelIndex-1].name,\r\n            \"column\": data.condition2Field\r\n          },\r\n          \"fullName\": model.name+\".\"+data.condition1Field+\" \"+data.conditionOperator+\" \"+models.response.models[modelIndex-1].name+\".\"+data.condition2Field\r\n        }\r\n        );\r\n\r\n      // saveEditedJoin(join, newJoin);\r\n      setModelState({...newModel, \"joinConditions\": newModel.joinConditions.concat(newCondition)})\r\n    }\r\n\r\n    const removeCondition = (condition) => {\r\n      setModelState({...newModel, \"joinConditions\": newModel.joinConditions.filter(conditions => conditions !== condition)});\r\n    }\r\n\r\n\r\n    const joinConditionRow = (condition, index, showRemove) => { // row per join condition\r\n      if(showRemove===false) {\r\n        return (\r\n          <tr className=\"row\" key={\"joinCondition_\" + index}>\r\n            <td className=\"col w-100\">\r\n              {condition.fullName}\r\n            </td>\r\n          </tr>\r\n        );\r\n      }\r\n      return(\r\n        <tr key={\"joinCondition_\" + index}>\r\n          <td className=\"p-2\">\r\n            {condition.fullName}\r\n          </td>\r\n          <td className=\"w-md-auto p-2\">\r\n            <Button variant=\"secondary\" onClick={() => removeCondition(condition)}>\r\n              Remove\r\n            </Button>\r\n          </td>\r\n        </tr>\r\n      );\r\n    }\r\n    const listJoinConditions = (showRemove) => newModel.joinConditions.map((condition, index) => {\r\n      return joinConditionRow(condition, index, showRemove);\r\n    }\r\n    );\r\n\r\n\r\n\r\n    const listModelColumns = (models,model,register,controlName) => {\r\n      const columnOption = (column,index) => {\r\n        return(\r\n          <option key={index}>{column}</option>\r\n        )\r\n      }\r\n\r\n      var listModel = {};\r\n      for(var modelIndex=0;modelIndex<models.response.models.length;modelIndex++) {\r\n        // console.log(models.response.models[modelIndex].name);\r\n        if(models.response.models[modelIndex].name===model) {\r\n          // console.log(\"matched\");\r\n          listModel = models.response.models[modelIndex];\r\n        }\r\n      }\r\n      // console.log(listModel);\r\n      if(listModel===null) return null;\r\n      if(listModel.columns.length===0) return null;\r\n      const tempListModelColumns = listModel.columns.map((column, index) => columnOption(column,index))\r\n      // console.log(tempListModelColumns);\r\n      return (\r\n        \r\n        <Form.Control as=\"select\" name={controlName} ref={register}>\r\n          {tempListModelColumns}\r\n        </Form.Control>\r\n      );\r\n    }\r\n    // console.log(\"before render editjoinpanel debug:\");\r\n    // console.log(models);\r\n    // console.log(modelIndex);\r\n    return (\r\n      <div>\r\n        <Button variant=\"primary\" onClick={handleShow}>\r\n          Edit Join\r\n        </Button>\r\n        <table className=\"table\">\r\n          <tbody>\r\n            {listJoinConditions(false)}\r\n          </tbody>\r\n        </table>\r\n        <Modal show={(showJoinModal === modelIndex)} onHide={handleClose} size=\"lg\">\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Edit Join </Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n          <Container>\r\n            <h5>Join Conditions</h5>\r\n            <table className=\"table-striped table-bordered w-100\">\r\n              <tbody>\r\n              {listJoinConditions(true)}\r\n              </tbody>\r\n            </table>\r\n          </Container>\r\n          <Container className=\"mt-3\">\r\n            <h5>Add new Join Condition</h5>\r\n            <Form onSubmit={handleSubmit(onSubmit)}>\r\n              \r\n              <div className=\"row text-center \">\r\n                <div className=\"col\">\r\n                  <Form.Group>\r\n                    <Form.Label>{model.name}</Form.Label>\r\n                      {listModelColumns(models,model.name,register,\"condition1Field\")}\r\n                  </Form.Group>\r\n                </div>\r\n                <div className=\"col-md-auto\">\r\n                  <Form.Group>\r\n                    <Form.Label>Operator type</Form.Label>\r\n                    <Form.Control name=\"conditionOperator\" as=\"select\"  ref={register} >\r\n                      <option>=</option>\r\n                      <option>&gt;=</option>\r\n                      <option>&lt;=</option>\r\n                    </Form.Control>\r\n                  </Form.Group>\r\n                </div>\r\n                <div className=\"col\">\r\n                  \r\n                <Form.Group>\r\n                    <Form.Label>{models.response.models[modelIndex-1].name}</Form.Label>\r\n                      {listModelColumns(models,models.response.models[modelIndex-1].name,register,\"condition2Field\")}\r\n                  </Form.Group>\r\n                </div>\r\n                <div className=\"col-md-auto\">\r\n                  <Button variant=\"primary\" type=\"submit\" className=\"joinConditionAddButton\">\r\n                    Add\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </Form>\r\n            </Container>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"secondary\" onClick={handleClose}>\r\n              Close\r\n            </Button>\r\n            <Button variant=\"primary\" onClick={handleSaveAndClose}>\r\n              Save Changes\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n","import React, {useState} from 'react';\r\n// import Draggable from 'react-draggable';\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\nimport { EditJoinPanel } from './EditJoinPanel'\r\nimport { Container, Overlay, Table } from 'react-bootstrap';\r\n\r\n\r\nexport function Models ({models, modelDragEnd, showColumns, saveEditedModel, toggleJoinModal, showJoinModal, highlightedColumns, openContextMenu, contextMenuOpen, editSelect}) {\r\n    const [contextMenu, setContextMenu] = useState({\"x\":null,\"y\":null,\"display\":false});\r\n    // console.log(\"Models\");\r\n    // console.log(contextMenuOpen);\r\n    // console.log(contextMenuOpen);\r\n    // console.log(models);\r\n    // console.log(highlightedColumns);\r\n    if (models.length === 0) return null\r\n      \r\n    if(contextMenuOpen === false && contextMenu.display===true) { //add this to every other component that has context menus\r\n        setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n      }\r\n\r\n      const contextMenuDisplay = (contextMenu, models) => {\r\n        if(contextMenu.display === false) return null;\r\n        // console.log(\"Displaying Context Menu\");\r\n        // console.log(contextMenu);\r\n    \r\n        // console.log(contextMenu.target.firstChild.data);\r\n        // console.log(contextMenu.target);\r\n        // console.log(JSON.parse(contextMenu.target.dataset.selectvalue));\r\n        // console.log(contextMenu.target.dataset.selectvalue.model);\r\n        const addToSelect = (selectToAdd) => {\r\n          editSelect(null,selectToAdd);\r\n          openContextMenu(false);\r\n        };\r\n        return(\r\n          <div>\r\n            <Overlay target={contextMenu.target} show={contextMenu.display} placement=\"right-start\">\r\n              <div>\r\n                <Table bordered variant=\"dark\">\r\n                  <tbody>\r\n                    <tr>\r\n                      <td onClick={() => addToSelect({\"inputColumns\": [{\"model\": contextMenu.target.parentNode.dataset.model, \"column\": contextMenu.target.parentNode.dataset.column}], \"alias\": contextMenu.target.parentNode.dataset.column})}>\r\n                        Add to Output\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </Table>\r\n              </div>\r\n            </Overlay>\r\n          </div>\r\n        )\r\n      }\r\n\r\n\r\n    const modelDraw = (model,index,showColumns, showJoinModal, toggleJoinModal, highlightedColumns, handleClick) => {\r\n        const columnRows = (columns,showColumns) => {\r\n            const columnRow = (column,index) => {\r\n                const handleClick = (e) => {\r\n                    // console.log(e);\r\n                    if (e.type === 'click') {\r\n                    setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n                    openContextMenu(false);\r\n                    } else if (e.type === 'contextmenu') {\r\n                    e.preventDefault();\r\n                    if(contextMenu.display===false) { //if contextMenu is not displayed\r\n                        setContextMenu({\"x\":e.pageX,\"y\":e.pageY,\"display\":true,\"clickTargetType\":\"Condition\",\"target\": e.target});\r\n                        openContextMenu(true);\r\n                    } else {\r\n                        setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n                        openContextMenu(false);\r\n                    }\r\n                    }\r\n                }\r\n                // console.log(\"modelDraw\");\r\n                // console.log(model);\r\n                // console.log(column);\r\n                var highlightThisColumn = false;\r\n                for(var highlightedColumnIndex=0;highlightedColumnIndex<highlightedColumns.length;highlightedColumnIndex++) {\r\n                    if(model.name===highlightedColumns[highlightedColumnIndex].model && column===highlightedColumns[highlightedColumnIndex].column) {\r\n                        highlightThisColumn = true;\r\n                    }\r\n                }\r\n                return(\r\n                    <tr\r\n                        key = {index}\r\n                        className={index%2 === 0?'odd':'even'}\r\n                        onClick={(e) => handleClick(e)}\r\n                        onContextMenu={(e) => handleClick(e)}\r\n                        data-model = {model.name}\r\n                        data-column = {column}\r\n                    >\r\n                        <td\r\n                            className={\"col-md-auto \"+(highlightThisColumn?\"highlightColumn\":null)}\r\n                        >\r\n                            {index + 1}\r\n                        </td>\r\n                        <td\r\n                            className={\"col \"+(highlightThisColumn?\"highlightColumn\":null)}\r\n                        >\r\n                            {column}\r\n                        </td>\r\n                    </tr>\r\n                );\r\n            }\r\n            \r\n            const columnRowsOutput = columns.map((column,index) => columnRow(column,index));\r\n            return(<tbody>{columnRowsOutput}</tbody>);\r\n        }\r\n        return(\r\n        <Draggable key={\"model_\"+model.name} draggableId={model.name} index={index}>\r\n        {(provided, snapshot) => (\r\n            <div\r\n            ref={provided.innerRef}\r\n            {...provided.draggableProps}\r\n            {...provided.dragHandleProps}\r\n            className=\"col removeFocusOutline\"\r\n            >\r\n            <div className=\"w-100 bg-secondary text-white text-center font-weight-bold\">\r\n                {model.name}\r\n            </div>\r\n            <div className=\"w-100 bg-light text-dark text-center font-italic mb-3\">\r\n                {model.description}\r\n            </div>\r\n            <div className=\"w-100 bg-light text-dark text-center\">\r\n                <EditJoinPanel\r\n                    model = { model }\r\n                    saveEditedModel = { saveEditedModel }\r\n                    models = { models }\r\n                    showJoinModal = { showJoinModal }\r\n                    toggleJoinModal = { toggleJoinModal }\r\n                    modelIndex = { index }\r\n                />\r\n            </div>\r\n            <table className=\"table table-bordered table-striped table-hover w-100\">\r\n                    {showColumns===true ? columnRows(model.columns) : null}\r\n            </table>\r\n            </div>\r\n        )}\r\n        </Draggable>)\r\n    }\r\n    const modelsDraw = (models,showColumns, showJoinModal, toggleJoinModal) => \r\n        models.response.models.map((model,index) => {\r\n            return modelDraw(model,index,showColumns, showJoinModal, toggleJoinModal, highlightedColumns)\r\n        }\r\n        );\r\n    \r\n    \r\n\r\n    const ModelTable = () => {\r\n\r\n        return(\r\n            <div className=\"container\">\r\n                \r\n\r\n                <DragDropContext onDragEnd={modelDragEnd}> \r\n                {/* TODO: only allow reordering models if they are all models\r\n                TODO: only allow two models in a join */}\r\n                    <Droppable droppableId=\"droppable\">\r\n                    {(provided, snapshot) => (\r\n                        <div\r\n                        {...provided.droppableProps}\r\n                        ref={provided.innerRef}\r\n                        >\r\n                        {modelsDraw(models,showColumns, showJoinModal, toggleJoinModal, highlightedColumns)}\r\n                        {provided.placeholder}\r\n                        </div>\r\n                    )}\r\n                    </Droppable>\r\n                </DragDropContext>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return(\r\n        <div className=\"text-center\">\r\n            <h2>Models</h2>\r\n            {ModelTable()}\r\n            {contextMenuDisplay(contextMenu, models)}\r\n        </div>\r\n    )\r\n}\r\n","// MIT License\r\n\r\n// Copyright (c) 2016 Yury Dymov\r\n\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n\r\n// The above copyright notice and this permission notice shall be included in all\r\n// copies or substantial portions of the Software.\r\n\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n// SOFTWARE.\r\n\r\n\r\nimport React, { createRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport getCaretCoordinates from 'textarea-caret';\r\nimport getInputSelection, { setCaretPosition } from 'get-input-selection';\r\n\r\nconst KEY_UP = 38;\r\nconst KEY_DOWN = 40;\r\nconst KEY_RETURN = 13;\r\nconst KEY_ENTER = 14;\r\nconst KEY_ESCAPE = 27;\r\nconst KEY_TAB = 9;\r\n\r\nconst OPTION_LIST_Y_OFFSET = 10;\r\nconst OPTION_LIST_MIN_WIDTH = 100;\r\n\r\nconst propTypes = {\r\n  Component: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.elementType,\r\n  ]),\r\n  defaultValue: PropTypes.string,\r\n  disabled: PropTypes.bool,\r\n  maxOptions: PropTypes.number,\r\n  onBlur: PropTypes.func,\r\n  onChange: PropTypes.func,\r\n  onKeyDown: PropTypes.func,\r\n  onRequestOptions: PropTypes.func,\r\n  onSelect: PropTypes.func,\r\n  options: PropTypes.arrayOf(PropTypes.object),\r\n  regex: PropTypes.string,\r\n  matchAny: PropTypes.bool,\r\n  minChars: PropTypes.number,\r\n  requestOnlyIfNoOptions: PropTypes.bool,\r\n  spaceRemovers: PropTypes.arrayOf(PropTypes.string),\r\n  spacer: PropTypes.string,\r\n  trigger: PropTypes.string,\r\n  value: PropTypes.string,\r\n  offsetX: PropTypes.number,\r\n  offsetY: PropTypes.number,\r\n  passThroughEnter: PropTypes.bool,\r\n};\r\n\r\nconst defaultProps = {\r\n  Component: 'textarea',\r\n  defaultValue: '',\r\n  disabled: false,\r\n  maxOptions: 6,\r\n  onBlur: () => {},\r\n  onChange: () => {},\r\n  onKeyDown: () => {},\r\n  onRequestOptions: () => {},\r\n  onSelect: () => {},\r\n  options: [],\r\n  fullOptions: [],\r\n  regex: '^[A-Za-z0-9\\\\-_]+$',\r\n  matchAny: false,\r\n  minChars: 0,\r\n  requestOnlyIfNoOptions: true,\r\n  spaceRemovers: [',', '.', '!', '?'],\r\n  spacer: ' ',\r\n  trigger: '@',\r\n  offsetX: 0,\r\n  offsetY: 0,\r\n  value: null,\r\n  passThroughEnter: false,\r\n};\r\n\r\nclass AutocompleteTextField extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.isTrigger = this.isTrigger.bind(this);\r\n    this.getMatch = this.getMatch.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    this.handleResize = this.handleResize.bind(this);\r\n    this.handleSelection = this.handleSelection.bind(this);\r\n    this.updateCaretPosition = this.updateCaretPosition.bind(this);\r\n    this.updateHelper = this.updateHelper.bind(this);\r\n    this.resetHelper = this.resetHelper.bind(this);\r\n    this.renderAutocompleteList = this.renderAutocompleteList.bind(this);\r\n\r\n    this.state = {\r\n      helperVisible: false,\r\n      left: 0,\r\n      matchLength: 0,\r\n      matchStart: 0,\r\n      options: [],\r\n      fullOptions: [],\r\n      selection: 0,\r\n      top: 0,\r\n      value: null,\r\n    };\r\n\r\n    this.recentValue = props.defaultValue;\r\n    this.enableSpaceRemovers = false;\r\n    this.refInput = createRef();\r\n  }\r\n  componentDidMount() {\r\n    window.addEventListener('resize', this.handleResize);\r\n    // console.log(\"Autocomplete\");\r\n    // console.log(this.recentValue);\r\n    // console.log(this.state.fullOptions);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { options } = this.props;\r\n    const { fullOptions } = this.props;\r\n    const { caret } = this.state;\r\n\r\n    if (options.length !== prevProps.options.length) {\r\n      this.updateHelper(this.recentValue, caret, options, fullOptions);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.handleResize);\r\n  }\r\n\r\n  getMatch(str, caret, providedOptions, fullOptions) {\r\n    const { trigger, matchAny, regex } = this.props;\r\n    const re = new RegExp(regex);\r\n    const triggerLength = trigger.length;\r\n    const triggerMatch = trigger.match(re);\r\n\r\n    for (let i = caret - 1; i >= 0; --i) {\r\n      const substr = str.substring(i, caret);\r\n      const match = substr.match(re);\r\n      let matchStart = -1;\r\n\r\n      if (triggerLength > 0) {\r\n        const triggerIdx = triggerMatch ? i : i - triggerLength + 1;\r\n\r\n        if (triggerIdx < 0) { // out of input\r\n          return null;\r\n        }\r\n\r\n        if (this.isTrigger(str, triggerIdx)) {\r\n          matchStart = triggerIdx + triggerLength;\r\n        }\r\n\r\n        if (!match && matchStart < 0) {\r\n          return null;\r\n        }\r\n      } else {\r\n        if (match && i > 0) { // find first non-matching character or begin of input\r\n          continue;\r\n        }\r\n        matchStart = i === 0 && match ? 0 : i + 1;\r\n\r\n        if (caret - matchStart === 0) { // matched slug is empty\r\n          return null;\r\n        }\r\n      }\r\n\r\n      if (matchStart >= 0) {\r\n        const matchedSlug = str.substring(matchStart, caret);\r\n        \r\n        const options = providedOptions.filter((slug) => {\r\n          const idx = slug.toLowerCase().indexOf(matchedSlug.toLowerCase());\r\n          return idx !== -1 && (matchAny || idx === 0);\r\n        });\r\n        var newFullOptions = [];\r\n        for(var j=0;j<providedOptions.length;j++) {\r\n            const matchIdx = providedOptions[j].toLowerCase().indexOf(matchedSlug.toLowerCase());\r\n            if(matchIdx !== -1 && (matchAny || matchIdx === 0))\r\n            // console.log(j);\r\n            newFullOptions.push(this.props.fullOptions[j]);\r\n        }\r\n        this.setState({\"fullOptions\": newFullOptions});\r\n        const matchLength = matchedSlug.length;\r\n        // console.log(\"returning slug:\")\r\n        // console.log(options);\r\n        // console.log(newFullOptions);\r\n        // console.log(this.props.fullOptions);\r\n\r\n        return { matchStart, matchLength, options };\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  isTrigger(str, i) {\r\n    const { trigger } = this.props;\r\n\r\n    if (!trigger || !trigger.length) {\r\n      return true;\r\n    }\r\n\r\n    if (str.substr(i, trigger.length) === trigger) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  handleChange(e) {\r\n    const {\r\n      onChange,\r\n      options,\r\n      fullOptions,\r\n      spaceRemovers,\r\n      spacer,\r\n      value,\r\n    } = this.props;\r\n\r\n    const old = this.recentValue;\r\n    const str = e.target.value;\r\n    const caret = getInputSelection(e.target).end;\r\n\r\n    if (!str.length) {\r\n      this.setState({ helperVisible: false });\r\n    }\r\n\r\n    this.recentValue = str;\r\n\r\n    this.setState({ caret, value: e.target.value });\r\n\r\n    if (!str.length || !caret) {\r\n      return onChange(e.target.value);\r\n    }\r\n\r\n    // '@wonderjenny ,|' -> '@wonderjenny, |'\r\n    if (this.enableSpaceRemovers && spaceRemovers.length && str.length > 2 && spacer.length) {\r\n      for (let i = 0; i < Math.max(old.length, str.length); ++i) {\r\n        if (old[i] !== str[i]) {\r\n          if (\r\n            i >= 2\r\n            && str[i - 1] === spacer\r\n            && spaceRemovers.indexOf(str[i - 2]) === -1\r\n            && spaceRemovers.indexOf(str[i]) !== -1\r\n            && this.getMatch(str.substring(0, i - 2), caret - 3, options, fullOptions)\r\n          ) {\r\n            const newValue = (`${str.slice(0, i - 1)}${str.slice(i, i + 1)}${str.slice(i - 1, i)}${str.slice(i + 1)}`);\r\n\r\n            this.updateCaretPosition(i + 1);\r\n            this.refInput.current.value = newValue;\r\n\r\n            if (!value) {\r\n              this.setState({ value: newValue });\r\n            }\r\n\r\n            return onChange(newValue);\r\n          }\r\n\r\n          break;\r\n        }\r\n      }\r\n\r\n      this.enableSpaceRemovers = false;\r\n    }\r\n\r\n    this.updateHelper(str, caret, options, fullOptions);\r\n\r\n    if (!value) {\r\n      this.setState({ value: e.target.value });\r\n    }\r\n\r\n    return onChange(e.target.value);\r\n  }\r\n\r\n  handleKeyDown(event) {\r\n    const { helperVisible, options, selection } = this.state;\r\n    const { onKeyDown, passThroughEnter } = this.props;\r\n\r\n    if (helperVisible) {\r\n      switch (event.keyCode) {\r\n        case KEY_ESCAPE:\r\n          event.preventDefault();\r\n          this.resetHelper();\r\n          break;\r\n        case KEY_UP:\r\n          event.preventDefault();\r\n          this.setState({ selection: ((options.length + selection) - 1) % options.length });\r\n          break;\r\n        case KEY_DOWN:\r\n          event.preventDefault();\r\n          this.setState({ selection: (selection + 1) % options.length });\r\n          break;\r\n        case KEY_ENTER:\r\n        case KEY_RETURN:\r\n          if (!passThroughEnter) { event.preventDefault(); }\r\n          this.handleSelection(selection);\r\n          break;\r\n        case KEY_TAB:\r\n          this.handleSelection(selection);\r\n          break;\r\n        default:\r\n          onKeyDown(event);\r\n          break;\r\n      }\r\n    } else {\r\n      onKeyDown(event);\r\n    }\r\n  }\r\n\r\n  handleResize() {\r\n    this.setState({ helperVisible: false });\r\n  }\r\n\r\n  handleSelection(idx) {\r\n    const { matchStart, matchLength, fullOptions } = this.state;\r\n    const { spacer, onSelect } = this.props;\r\n    // console.log(\"handleSelection\");\r\n    // console.log(idx);\r\n    // console.log(fullOptions);\r\n    const slug = fullOptions[idx];\r\n    const value = this.recentValue;\r\n    const part1 = value.substring(0, matchStart);\r\n    const part2 = value.substring(matchStart + matchLength);\r\n\r\n    const event = { target: this.refInput.current };\r\n\r\n    event.target.value = `${part1}${slug}${spacer}${part2}`;\r\n    this.handleChange(event);\r\n    onSelect(event.target.value);\r\n\r\n    this.resetHelper();\r\n\r\n    this.updateCaretPosition(part1.length + slug.length + 1);\r\n\r\n    this.enableSpaceRemovers = true;\r\n  }\r\n\r\n  updateCaretPosition(caret) {\r\n    this.setState({ caret }, () => setCaretPosition(this.refInput.current, caret));\r\n  }\r\n\r\n  updateHelper(str, caret, options, fullOptions) {\r\n    const input = this.refInput.current;\r\n\r\n    const slug = this.getMatch(str, caret, options, fullOptions);\r\n    // console.log(\"updateHelper\");\r\n    // console.log(slug);\r\n    if (slug) {\r\n      const caretPos = getCaretCoordinates(input, caret);\r\n      const rect = input.getBoundingClientRect();\r\n\r\n      const top = caretPos.top + input.offsetTop;\r\n      const left = Math.min(\r\n        caretPos.left + input.offsetLeft - OPTION_LIST_Y_OFFSET,\r\n        input.offsetLeft + rect.width - OPTION_LIST_MIN_WIDTH,\r\n      );\r\n\r\n      const { minChars, onRequestOptions, requestOnlyIfNoOptions } = this.props;\r\n\r\n      if (\r\n        slug.matchLength >= minChars\r\n        && (\r\n          slug.options.length > 1\r\n          || (\r\n            slug.options.length === 1\r\n            && slug.options[0].length !== slug.matchLength\r\n          )\r\n        )\r\n      ) {\r\n        this.setState({\r\n          helperVisible: true,\r\n          top,\r\n          left,\r\n          ...slug,\r\n        });\r\n      } else {\r\n        if (!requestOnlyIfNoOptions || !slug.options.length) {\r\n          onRequestOptions(str.substr(slug.matchStart, slug.matchLength));\r\n        }\r\n\r\n        this.resetHelper();\r\n      }\r\n    } else {\r\n      this.resetHelper();\r\n    }\r\n  }\r\n\r\n  resetHelper() {\r\n    this.setState({ helperVisible: false, selection: 0 });\r\n  }\r\n\r\n  renderAutocompleteList() {\r\n    const {\r\n      helperVisible,\r\n      left,\r\n      matchStart,\r\n      matchLength,\r\n      options,\r\n      fullOptions,\r\n      selection,\r\n      top,\r\n      value,\r\n    } = this.state;\r\n\r\n    if (!helperVisible) {\r\n      return null;\r\n    }\r\n\r\n    const { maxOptions, offsetX, offsetY } = this.props;\r\n\r\n    if (options.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (selection >= options.length) {\r\n      this.setState({ selection: 0 });\r\n\r\n      return null;\r\n    }\r\n\r\n    const optionNumber = maxOptions === 0 ? options.length : maxOptions;\r\n\r\n    const helperOptions = options.slice(0, optionNumber).map((val, idx) => {\r\n      const highlightStart = val.toLowerCase().indexOf(value.substr(matchStart, matchLength).toLowerCase());\r\n\r\n      return (\r\n        <li\r\n          className={idx === selection ? 'active' : null}\r\n          key={val}\r\n          onClick={() => { this.handleSelection(idx); }}\r\n          onMouseEnter={() => { this.setState({ selection: idx }); }}\r\n        >\r\n          {val.slice(0, highlightStart)}\r\n          <strong>{val.substr(highlightStart, matchLength)}</strong>\r\n          {val.slice(highlightStart + matchLength)}\r\n        </li>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <ul className=\"react-autocomplete-input\" style={{ left: left + offsetX, top: top + offsetY }}>\r\n        {helperOptions}\r\n      </ul>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      Component,\r\n      defaultValue,\r\n      disabled,\r\n      onBlur,\r\n      value,\r\n      ...rest\r\n    } = this.props;\r\n\r\n    const { value: stateValue } = this.state;\r\n\r\n    const propagated = Object.assign({}, rest);\r\n    Object.keys(this.constructor.propTypes).forEach((k) => { delete propagated[k]; });\r\n\r\n    let val = '';\r\n\r\n    if (typeof value !== 'undefined' && value !== null) {\r\n      val = value;\r\n    } else if (stateValue) {\r\n      val = stateValue;\r\n    } else if (defaultValue) {\r\n      val = defaultValue;\r\n    }\r\n\r\n    return (\r\n      <span>\r\n        <Component\r\n          disabled={disabled}\r\n          onBlur={onBlur}\r\n          onChange={this.handleChange}\r\n          onKeyDown={this.handleKeyDown}\r\n          ref={this.refInput}\r\n          value={val}\r\n          {...propagated}\r\n        />\r\n        {this.renderAutocompleteList()}\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nAutocompleteTextField.propTypes = propTypes;\r\nAutocompleteTextField.defaultProps = defaultProps;\r\n\r\nexport default AutocompleteTextField;","import React, {useState} from 'react';\r\nimport {Container, Modal, Row, Col, Overlay, Table, Button, Form } from 'react-bootstrap';\r\nimport { useForm } from \"react-hook-form\";\r\n// import Draggable from 'react-draggable';\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\nimport { EditJoinPanel } from './EditJoinPanel'\r\nimport AutocompleteTextField from './AutoComplete';\r\n\r\n\r\nexport const Conditions = ({models, conditions, editCondition, openContextMenu, contextMenuOpen}) => {\r\n    const [contextMenu, setContextMenu] = useState({\"x\":null,\"y\":null,\"display\":false});\r\n    const [editConditionMenu, setEditConditionMenu] = useState({\"show\": false, \"conditionToEdit\":null});\r\n    const { register, handleSubmit } = useForm();\r\n\r\n    \r\n    if(contextMenuOpen === false && contextMenu.display===true) { //add this to every other component that has context menus\r\n      setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n    }\r\n\r\n    // console.log(\"Conditions debug:\");\r\n    // console.log(models);\r\n    // console.log(conditions);\r\n    // console.log(contextMenu);\r\n    // console.log(editConditionMenu);\r\n    if (models.length === 0) return null\r\n\r\n    const showConditions = (conditions,editCondition,openContextMenu) => {\r\n        // console.log(conditions);\r\n        if (conditions.length === 0) return null;\r\n        const handleClick = (e) => {\r\n          // console.log(e);\r\n            if (e.type === 'click') {\r\n              setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n              openContextMenu(false);\r\n            } else if (e.type === 'contextmenu') {\r\n              e.preventDefault();\r\n              if(contextMenu.display===false) { //if contextMenu is not displayed\r\n                setContextMenu({\"x\":e.pageX,\"y\":e.pageY,\"display\":true,\"clickTargetType\":\"Condition\",\"target\": e.target});\r\n                openContextMenu(true);\r\n              } else {\r\n                setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n                openContextMenu(false);\r\n              }\r\n            }\r\n        }\r\n        const conditionRow = (condition, index, handleClick) => {\r\n            // console.log(\"conditionRow\");\r\n            // console.log(condition);\r\n            // console.log(index);\r\n            // console.log(index%2 === 0?'odd':'even');\r\n            return ( \r\n                <tr key={index} className={\"componentRow \"} onClick={handleClick} onContextMenu={handleClick}>\r\n                  <td md=\"auto\" className=\"fullSize\">\r\n                    <div className=\"componentContent\">{condition}</div>\r\n                  </td>\r\n                </tr>\r\n            );\r\n        }\r\n        var conditionList = []\r\n        for(var conditionIndex=0;conditionIndex<conditions.length;conditionIndex++) {\r\n            conditionList.push(conditionRow(conditions[conditionIndex],conditionIndex,handleClick));\r\n        }\r\n        return (\r\n          <div>\r\n            <div className=\"w-100 bg-secondary text-white text-center\">Add / Remove Conditions to filter results</div>\r\n            <Table striped bordered>\r\n              <tbody>\r\n              {conditionList}\r\n              </tbody>\r\n            </Table>\r\n          </div>\r\n        );\r\n    }\r\n\r\n\r\n    const handleModalClose = () => setEditConditionMenu({\"show\": false, \"conditionToEdit\":null});\r\n\r\n    \r\n\r\n      \r\n    const editConditionMenuDisplay = (editConditionMenu, handleModalClose, editCondition) => {\r\n      // console.log(\"Displaying Edit Condition Modal\");\r\n      // console.log(editConditionMenu);\r\n      if(editConditionMenu.menuOpen === false) return null;\r\n      const conditionCriteria = React.createRef();\r\n      const handleModalSaveAndClose = () => {\r\n        editCondition(editConditionMenu.conditionToEdit,conditionCriteria.current.recentValue);\r\n        handleModalClose();\r\n      }\r\n      \r\n      const modelColumns = () => {\r\n        var tempModelColumns = [];\r\n        for(var modelIndex=0;modelIndex<models.response.models.length;modelIndex++) {\r\n          for(var columnIndex=0;columnIndex<models.response.models[modelIndex].columns.length;columnIndex++) {\r\n            tempModelColumns.push(models.response.models[modelIndex].columns[columnIndex]);\r\n            tempModelColumns.push(models.response.models[modelIndex].name+\".\"+models.response.models[modelIndex].columns[columnIndex]);\r\n          }\r\n        }\r\n        // console.log(\"tempModelColumns\");\r\n        // console.log(tempModelColumns);\r\n        return tempModelColumns;\r\n      }\r\n\r\n      const modelFullColumns = () => {\r\n        var tempModelColumns = [];\r\n        for(var modelIndex=0;modelIndex<models.response.models.length;modelIndex++) {\r\n          for(var columnIndex=0;columnIndex<models.response.models[modelIndex].columns.length;columnIndex++) {\r\n            tempModelColumns.push(models.response.models[modelIndex].name+\".\"+models.response.models[modelIndex].columns[columnIndex]);\r\n            tempModelColumns.push(models.response.models[modelIndex].name+\".\"+models.response.models[modelIndex].columns[columnIndex]);\r\n          }\r\n        }\r\n        // console.log(\"tempModelColumns\");\r\n        // console.log(tempModelColumns);\r\n        return tempModelColumns;\r\n      }\r\n\r\n      return(\r\n        <div>\r\n          <Modal show={(editConditionMenu.show)} onHide={handleModalClose}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Edit Join </Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            Join Conditions:\r\n            <Form>\r\n              <div className=\"row\">\r\n                <div className=\"col\">\r\n                  <Form.Group>\r\n                    <Form.Label>Condition Criteria</Form.Label>\r\n                      <AutocompleteTextField className=\"form-control\" rows={3} ref={conditionCriteria} options={modelColumns()} fullOptions={modelFullColumns()} trigger=\"\" defaultValue={editConditionMenu.conditionToEdit}/>\r\n                  </Form.Group>\r\n                </div>\r\n              </div>\r\n            </Form>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"secondary\" onClick={handleModalClose}>\r\n              Close\r\n            </Button>\r\n            <Button variant=\"primary\" onClick={handleModalSaveAndClose}>\r\n              Save Changes\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n        </div>\r\n      )\r\n      };\r\n\r\n\r\n    const contextMenuDisplay = (contextMenu) => {\r\n      if(contextMenu.display === false) return null;\r\n      // console.log(\"Displaying Context Menu\");\r\n      // console.log(contextMenu);\r\n      // console.log(contextMenu.target.firstChild.data);\r\n      const clickEditCondition = (conditionToEdit) => {\r\n        setEditConditionMenu({\"show\": true, \"conditionToEdit\":contextMenu.target.firstChild.data});\r\n        openContextMenu(false);\r\n      };\r\n      const clickRemoveCondition = (conditionToRemove) => {\r\n        editCondition(conditionToRemove, null);\r\n        openContextMenu(false);\r\n      };\r\n      return(\r\n        <div>\r\n          <Overlay target={contextMenu.target} show={contextMenu.display} placement=\"right-start\">\r\n            <div>\r\n              <Table bordered variant=\"dark\">\r\n                <tbody>\r\n                  <tr>\r\n                    <td onClick={() => clickEditCondition(contextMenu.target.firstChild.data)}>\r\n                      <div>Edit Condition</div>\r\n                      \r\n                    </td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td onClick={() => clickRemoveCondition(contextMenu.target.firstChild.data)}>\r\n                      Delete Condition\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </Table>\r\n            </div>\r\n          </Overlay>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    return(\r\n        <div>\r\n          <h2 className=\"text-center\">Conditions</h2>\r\n          <div>\r\n            {showConditions(conditions,editCondition,openContextMenu)}\r\n            {contextMenuDisplay(contextMenu)}\r\n            {editConditionMenuDisplay(editConditionMenu, handleModalClose, editCondition)}\r\n          </div>\r\n          <div className=\"pt-2 text-center\">\r\n            <Button variant=\"primary\" onClick={() => setEditConditionMenu({\"show\": true, \"conditionToEdit\":null})}>\r\n                Add Condition\r\n            </Button>\r\n          </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, {useState} from 'react';\r\nimport { Container, Overlay, Table, Form } from 'react-bootstrap';\r\n\r\n\r\n\r\nexport function Selects( {models, openContextMenu, contextMenuOpen, selects, editSelect, highlightColumn, outputModel, editOutputModel}) {\r\n    const [contextMenu, setContextMenu] = useState({\"x\":null,\"y\":null,\"display\":false});\r\n    const [editingField, setEditingField] = useState(-1);\r\n    const [editingDescription, setEditingDescription] = useState(-1);\r\n    // console.log(\"Selects:\")\r\n    // console.log(models);\r\n    // console.log(selects);\r\n    // console.log(contextMenu);\r\n    // console.log(clicked);\r\n    // console.log(editingField);\r\n    if (models.length === 0) return null\r\n\r\n    if(contextMenuOpen === false && contextMenu.display===true) { //add this to every other component that has context menus\r\n        setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n      }\r\n\r\n    const contextMenuDisplay = (contextMenu, selects) => {\r\n        if(contextMenu.display === false) return null;\r\n        // console.log(\"Displaying Context Menu\");\r\n        // console.log(contextMenu);\r\n        // console.log(contextMenu.target.firstChild.data);\r\n        // console.log(contextMenu.target);\r\n        // console.log(contextMenu.target.dataset.selectindex);\r\n        const clickEditSelectName = (selectToEdit) => {\r\n        //   setEditConditionMenu({\"show\": true, \"conditionToEdit\":contextMenu.target.firstChild.data});\r\n          setEditingField(parseInt(selectToEdit));\r\n          openContextMenu(false);\r\n        };\r\n        const clickEditSelectDescription = (selectToEdit) => {\r\n        //   setEditConditionMenu({\"show\": true, \"conditionToEdit\":contextMenu.target.firstChild.data});\r\n          // console.log(\"clickEditSelectDescription\");\r\n          // console.log(selectToEdit);\r\n          setEditingDescription(parseInt(selectToEdit));\r\n          openContextMenu(false);\r\n        };\r\n        const clickRemoveSelect = (selectToRemove) => {\r\n          editSelect(selectToRemove,null);\r\n          openContextMenu(false);\r\n        };\r\n        return(\r\n          <div>\r\n            <Overlay target={contextMenu.target} show={contextMenu.display} placement=\"left-start\">\r\n              <div>\r\n                <Table bordered variant=\"dark\">\r\n                  <tbody>\r\n                    <tr>\r\n                      <td onClick={() => clickEditSelectName(contextMenu.target.dataset.selectindex)}>\r\n                        <div>Edit Name</div>\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td onClick={() => clickEditSelectDescription(contextMenu.target.dataset.selectindex)}>\r\n                        <div>Edit Description</div>\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td onClick={() => clickRemoveSelect(selects[contextMenu.target.dataset.selectindex])}>\r\n                        Delete Field\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </Table>\r\n              </div>\r\n            </Overlay>\r\n          </div>\r\n        )\r\n      }\r\n    \r\n    \r\n    const listModelColumns = (models,selects, highlightColumn,openContextMenu) => {\r\n        \r\n        const handleClick = (e) => {\r\n            // console.log(\"handleClick\");\r\n            // console.log(e);\r\n              if (e.type === 'click') {\r\n                setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n                openContextMenu(false);\r\n              } else if (e.type === 'contextmenu') {\r\n                e.preventDefault();\r\n                if(contextMenu.display===false) { //if contextMenu is not displayed\r\n                  setContextMenu({\"x\":e.pageX,\"y\":e.pageY,\"display\":true,\"clickTargetType\":\"Condition\",\"target\": e.target});\r\n                  openContextMenu(true);\r\n                } else {\r\n                  setContextMenu({\"x\":null,\"y\":null,\"display\":false});\r\n                  openContextMenu(false);\r\n                }\r\n              }\r\n          };\r\n\r\n          const updateColumnAlias = (e) => {\r\n            //   console.log(\"updateColumnAlias\");\r\n            //   console.log(e);\r\n              e.preventDefault();\r\n              setEditingField(-1);\r\n              editSelect(selects[editingField],{...selects[editingField], \"alias\": e.target.value});\r\n          };\r\n          const updateColumnDescription = (e) => {\r\n              // console.log(\"updateColumnDescription\");\r\n              // console.log(e);\r\n              e.preventDefault();\r\n              setEditingDescription(-1);\r\n              editSelect(selects[editingDescription],{...selects[editingDescription], \"description\": e.target.value});\r\n          };\r\n\r\n          const showField = (selects, selectsIndex) => {\r\n            //   console.log(\"showField\");\r\n            //   console.log(selectsIndex);\r\n            //   console.log(editingField);\r\n            if(editingField === selectsIndex) {\r\n                return(\r\n                    <>\r\n                        <Form onSubmit={(e) => e.preventDefault()}>\r\n                            <Form.Group>\r\n                                <Form.Control\r\n                                    type=\"text\"\r\n                                    defaultValue={(selects[selectsIndex].alias !== null && selects[selectsIndex].alias !== undefined)?selects[selectsIndex].alias:selects[selectsIndex].column}\r\n                                    onBlur={(e) => updateColumnAlias(e)}\r\n                                    placeholder=\"Add name for output field\"\r\n                                    autoFocus\r\n                                />\r\n                            </Form.Group>\r\n                        </Form>\r\n                    </>\r\n                );\r\n            } else {\r\n                return(\r\n                    <>\r\n                        <div className=\"w-100 text-dark text-right\" data-selectindex = {selectsIndex}>\r\n                          {(selects[selectsIndex].alias !== null && selects[selectsIndex].alias !== undefined)?selects[selectsIndex].alias:selects[selectsIndex].column}\r\n                        </div>\r\n                    </>\r\n                );\r\n            }\r\n          };\r\n        const showDescription = (selects, selectsIndex) => {\r\n          // console.log(selects);\r\n          // console.log(selectsIndex);\r\n          // console.log(editingDescription);\r\n          if(editingDescription === selectsIndex) { //if decription is being edited\r\n            return(\r\n                <>\r\n                    <Form onSubmit={(e) => e.preventDefault()}>\r\n                        <Form.Group>\r\n                            <Form.Control\r\n                                type=\"text\"\r\n                                defaultValue={(selects[selectsIndex].description !== null && selects[selectsIndex].description !== undefined)?selects[selectsIndex].description:null}\r\n                                onBlur={(e) => updateColumnDescription(e)}\r\n                                placeholder=\"Add description for output field\"\r\n                                autoFocus\r\n                            />\r\n                        </Form.Group>\r\n                    </Form>\r\n                </>\r\n            );\r\n        } else if(selects[selectsIndex].description !== null && selects[selectsIndex].description !== undefined) { // if description is defined\r\n            return(\r\n                <>\r\n                    <div className=\"w-100 text-dark text-right font-italic\" data-selectindex = {selectsIndex}>\r\n                      {selects[selectsIndex].description}\r\n                    </div>\r\n                </>\r\n            );\r\n        } else return null;\r\n      };\r\n        \r\n\r\n        const highlightColumns = (col) => {\r\n            // console.log(\"highlightColumns\");\r\n            // console.log(col);\r\n            var tempColumnsToHighlight = [];\r\n            if(col !== undefined & col !== null) {\r\n                for(var columnIndex=0;columnIndex<col.inputColumns.length;columnIndex++) {\r\n                    tempColumnsToHighlight.push(col.inputColumns[columnIndex]);\r\n                } \r\n            }\r\n            highlightColumn(tempColumnsToHighlight);\r\n        };\r\n        var tempListModelColumns = [];\r\n        for(let selectsIndex=0;selectsIndex<selects.length;selectsIndex++) {\r\n            // console.log(\"selectsMap\");\r\n            // console.log(selects[selectsIndex]);\r\n            tempListModelColumns.push(\r\n                <tr\r\n                    key={selectsIndex}\r\n                    onMouseEnter={() => highlightColumns(selects[selectsIndex])}\r\n                    onMouseLeave={() => highlightColumns()}\r\n                    onClick={(e) => handleClick(e)}\r\n                    onContextMenu={(e) => handleClick(e)}\r\n                >\r\n                    <td\r\n                    data-selectindex = {selectsIndex}\r\n                    >\r\n                        {showField(selects, selectsIndex)}\r\n                        {showDescription(selects, selectsIndex)}\r\n                    </td>\r\n                </tr>\r\n            );\r\n        };\r\n        return tempListModelColumns;\r\n    };\r\n\r\n    return(\r\n        <div>\r\n            <h2 className=\"text-center\">\r\n                Output\r\n            </h2>\r\n            <div className=\"w-100 bg-secondary text-white text-center\">{outputModel.name}</div>\r\n            <div className=\"w-100 bg-light text-dark text-center font-italic mb-3\">\r\n                {outputModel.description?outputModel.description:\"New Model\"}\r\n            </div>\r\n            <table className=\"table table-striped table-hover w-100\">\r\n                <tbody>\r\n                    {listModelColumns(models,selects, highlightColumn,openContextMenu)}\r\n                </tbody>\r\n            </table>\r\n            {contextMenuDisplay(contextMenu, selects)}\r\n        </div>\r\n    )\r\n}","export async function getModelJson(modelJsonFilename, user) {\r\n    const response = await fetch('/api/model_old/' + modelJsonFilename, {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","import React from 'react'\r\nconst conditionConcat = (conditions) => {\r\n    // console.log(\"SQLPanel Conditions\");\r\n    // console.log(conditions);\r\n    if (conditions.length === 0) return null;\r\n    var tempConditionConcat = conditions[0].fullName;\r\n    for(var conditionIndex=1;conditionIndex<conditions.length;conditionIndex++) {\r\n        tempConditionConcat += \"\\n  AND \" + conditions[conditionIndex].fullName;\r\n    }\r\n    return tempConditionConcat;\r\n}\r\nconst selectStatement = (state) => {\r\n    var tempSelectStatement = \"SELECT\\n\";\r\n    const columnDefinition = (select) => {\r\n        if('definition' in select) { // if SQL definition for column exists, use that\r\n            return select.definition;\r\n        } else { // otherwise use the column in inputColumns\r\n            return select.inputColumns[0].model + \".\" + select.inputColumns[0].column;\r\n        }\r\n    }\r\n\r\n    const selectLine = (select) => {\r\n        return columnDefinition(select) + \" AS \" + select.alias;\r\n    }\r\n\r\n    if (state.selects.length !== 0) {\r\n        tempSelectStatement += \"  \" + selectLine(state.selects[0]) + \"\\n\"\r\n        for(var selectIndex=1;selectIndex<state.selects.length;selectIndex++) {\r\n            tempSelectStatement += \"  , \" \r\n                + selectLine(state.selects[selectIndex]) + \"\\n\";\r\n        }\r\n    } else {\r\n        tempSelectStatement += \"  *\\n\"\r\n    }\r\n    return tempSelectStatement;\r\n}\r\n\r\nconst fromStatement = (state) => {\r\n    var tempFromStatement = \"\";\r\n\r\n    const fromSyntax = (model) => {\r\n        return \"{{ ref(\\\"\" + model.name + \"\\\") }} AS \" + model.name;\r\n    }\r\n\r\n    if (state.models.length !== 0) {\r\n        tempFromStatement += \"FROM \" + fromSyntax(state.models.response.models[0]) + \"\\n\"\r\n        for(var joinIndex=1;joinIndex<state.models.response.models.length;joinIndex++) {\r\n            tempFromStatement += \"LEFT JOIN \" \r\n                + fromSyntax(state.models.response.models[joinIndex])\r\n                + \"\\n  ON \" + conditionConcat(state.models.response.models[joinIndex].joinConditions) + \"\\n\";\r\n        }\r\n    } else {\r\n        tempFromStatement += \"FROM \" + state.outputModel\r\n    }\r\n    return tempFromStatement;\r\n}\r\nconst whereStatement = (state) => {\r\n    var tempWhereStatement = \"\";\r\n    if (state.models.length !== 0) {\r\n        tempWhereStatement += \"WHERE \" + state.conditions[0] + \"\\n\"\r\n        // console.log(\"Loading conditions\");\r\n        // console.log(state.conditions.length);\r\n        for(var conditionIndex=1;conditionIndex<state.conditions.length;conditionIndex++) {\r\n            tempWhereStatement += \"  AND \" + state.conditions[conditionIndex] + \"\\n\";\r\n        }\r\n    } else {\r\n        tempWhereStatement += \"FROM \" + state.outputModel\r\n    }\r\n    return tempWhereStatement;\r\n}\r\nexport const SQLPanel = ({state}) => {\r\n    // const fromItem = (joinModel) => {\r\n    //     return(\r\n    //         {join.}\r\n    //     )\r\n    // }\r\n    return(\r\n    <div>\r\n        Generated SQL:\r\n        <div className=\"sqlContent\">\r\n            {selectStatement(state)}\r\n            {fromStatement(state)}\r\n            {whereStatement(state)}\r\n        </div>\r\n    </div>\r\n    )\r\n}\r\n\r\n","import React, { Component } from 'react';\r\nimport {Collapse, Container, Row, Col } from 'react-bootstrap';\r\nimport { XCircle } from 'react-bootstrap-icons';\r\n// import logo from './logo.svg';\r\nimport '../App.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n// import JsonFilenameInput from './components/JsonFilenameInput'\r\nimport { Models } from './Models'\r\nimport { Conditions } from './Conditions'\r\nimport { Selects } from './Selects'\r\nimport { getModelJson } from '../services/getModelJson'\r\nimport { SQLPanel } from './SQLPanel';\r\n\r\nclass ModelBuilder extends Component {\r\n  \r\n  state = {\r\n    model: {},\r\n    models: [],\r\n    openSQLPanel: false,\r\n    showJoinModal: -1,\r\n    outputModel: \"\",\r\n    showColumns: true,\r\n    conditions: [],\r\n    selects: [],\r\n    highlightedColumns: []\r\n  }\r\n  \r\n  toggleJoinModal = (joinNum) => {\r\n    this.setState({showJoinModal: joinNum})\r\n  }\r\n\r\n  \r\n  openSQLPanel = () => {\r\n    this.state.openSQLPanel?this.setState({openSQLPanel: false}):this.setState({openSQLPanel: true})\r\n  }\r\n\r\n  componentDidMount() { // on load\r\n    getModelJson('all_models.json', this.props.user)\r\n      .then(response => {\r\n        this.setState({models: {response}});\r\n        this.setState({conditions: response.conditions});\r\n        var selects = [];\r\n        var outputName = \"\";\r\n        for(var modelIndex=0;modelIndex < response.models.length;modelIndex++) {\r\n          for(var columnIndex=0;columnIndex<response.models[modelIndex].columns.length;columnIndex++) {\r\n            var columnUsedToJoin = false;\r\n            for(var joinModelIndex=0;joinModelIndex<response.models.length;joinModelIndex++) {\r\n              if('joinConditions' in response.models[modelIndex] && typeof response.models[modelIndex].joinConditions !== 'undefined') {\r\n                // console.log(models.response.models[modelIndex]);\r\n                for(var joinConditionIndex=0;joinConditionIndex<response.models[modelIndex].joinConditions.length;joinConditionIndex++) {\r\n                  if(\r\n                    response.models[modelIndex].name===response.models[modelIndex].joinConditions[joinConditionIndex].conditionField1.model\r\n                    && response.models[modelIndex].columns[columnIndex]===response.models[modelIndex].joinConditions[joinConditionIndex].conditionField1.column\r\n                  ) {\r\n                    columnUsedToJoin = true;\r\n                  }\r\n                }\r\n              }\r\n                  \r\n            }\r\n            if(!columnUsedToJoin) {\r\n              selects.push({\"inputColumns\": [{\"column\": response.models[modelIndex].columns[columnIndex],\"model\": response.models[modelIndex].name}],\"alias\": response.models[modelIndex].columns[columnIndex]});\r\n            }\r\n          }\r\n          outputName += (modelIndex!==0?\"_\":\"\") + response.models[modelIndex].name\r\n        }\r\n        this.setState({selects: selects});\r\n        this.setState({outputModel: {\"name\": outputName}})\r\n      });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if(prevProps.models !== this.props.models) { // update Models\r\n        // check all existing joins\r\n        // add new joins\r\n    }\r\n  }\r\n\r\n  saveEditedModel = (previousModel, newModel) => {\r\n    // console.log(\"saveEditedModel\");\r\n    // console.log(previousModel);\r\n    // console.log(newModel);\r\n    this.setState(prevState => ({\r\n      models: prevState.models.response.models.filter(models => models !== previousModel) \r\n    }));\r\n    this.setState({models: {...this.state.models, \"response\": {...this.state.models.response, \"models\": [...this.state.models.response.models.filter(models => models !== previousModel), newModel]}}});\r\n  }\r\n\r\n\r\n  logState = () => {\r\n    console.log(this.state);\r\n  }\r\n\r\n\r\n  editCondition = (oldCondition, newCondition) => {\r\n      // console.log(\"editCondition\")\r\n      // console.log(oldCondition);\r\n      // console.log(newCondition);\r\n      // console.log(this.state.conditions);\r\n    \r\n    if(newCondition === null) { //Removing a select:\r\n      this.setState({conditions: [...this.state.conditions.filter(conditions => conditions !== oldCondition)]});\r\n    } else if (oldCondition === null) { //Adding a select\r\n      this.setState({conditions: [...this.state.conditions, newCondition]});\r\n    } else {\r\n      var conditionToEditIndex = -1;\r\n      for(var conditionIndex=0;conditionIndex<this.state.conditions.length;conditionIndex++) {\r\n        if(this.state.conditions[conditionIndex] === oldCondition) {\r\n          conditionToEditIndex = conditionIndex;\r\n        }\r\n      }\r\n      let conditions = [...this.state.conditions];\r\n      let condition = {...conditions[conditionToEditIndex]};\r\n      condition = newCondition;\r\n      conditions[conditionToEditIndex] = condition;\r\n      this.setState({conditions: conditions});\r\n    }\r\n  \r\n  }\r\n\r\n\r\n  editSelect = (oldSelect, newSelect) => {\r\n    // console.log(\"editSelect\")\r\n    // console.log(oldSelect);\r\n    // console.log(newSelect);\r\n    // console.log(this.state.selects);\r\n    \r\n    if(newSelect === null) { //Removing a select:\r\n      this.setState({selects: [...this.state.selects.filter(selects => selects !== oldSelect)]});\r\n    } else if (oldSelect === null) { //Adding a select\r\n      this.setState({selects: [...this.state.selects, newSelect]});\r\n    } else {\r\n      var selectToEditIndex = -1;\r\n      for(var selectIndex=0;selectIndex<this.state.selects.length;selectIndex++) {\r\n        if(this.state.selects[selectIndex] == oldSelect) {\r\n          selectToEditIndex = selectIndex;\r\n        }\r\n      }\r\n      let selects = [...this.state.selects];\r\n      let select = {...selects[selectToEditIndex]};\r\n      select = newSelect;\r\n      selects[selectToEditIndex] = select;\r\n      this.setState({selects: selects});\r\n    }\r\n  \r\n  }\r\n\r\n  editOutputModel = (newOutputModel) => {\r\n    // console.log(\"editOutputModel\")\r\n    // console.log(newOutputModel);\r\n      this.setState({outputModel: newOutputModel});  \r\n  }\r\n\r\n  // this function reorders items on dragdrop\r\n  reorder = (list, startIndex, endIndex) => {\r\n    const result = Array.from(list);\r\n    const [removed] = result.splice(startIndex, 1);\r\n    result.splice(endIndex, 0, removed);\r\n\r\n    return result;\r\n  };\r\n\r\n  highlightColumn = (columnsToHighlight) => {\r\n    // console.log(\"highlightColumn\");\r\n    // console.log(columnsToHighlight);\r\n    this.setState({highlightedColumns: columnsToHighlight});\r\n  }\r\n\r\n  modelDragEnd = (result) => {\r\n    // dropped outside the list\r\n    // console.log(\"Start of modelDragEnd\");\r\n    //   console.log(result);\r\n    if (!result.destination) {\r\n      return;\r\n    }\r\n    if (result.destination.index===result.source.index) {\r\n      return;\r\n    }\r\n    // console.log(\"got past checks\");\r\n    const reorderJoinConditions = (joinConditions) => {\r\n      var newJoinCondition = JSON.parse(JSON.stringify(joinConditions));\r\n      for(var joinConditionIndex=0;joinConditionIndex<joinConditions.length;joinConditionIndex++) {\r\n        newJoinCondition[joinConditionIndex].conditionField1 = joinConditions[joinConditionIndex].conditionField2;\r\n        newJoinCondition[joinConditionIndex].conditionField2 = joinConditions[joinConditionIndex].conditionField1;\r\n        newJoinCondition[joinConditionIndex].fullName = \r\n          joinConditions[joinConditionIndex].conditionField2.model\r\n          +\".\"+joinConditions[joinConditionIndex].conditionField2.column\r\n          +\" \"+joinConditions[joinConditionIndex].conditionOperator\r\n          +\" \"+joinConditions[joinConditionIndex].conditionField1.model\r\n          +\".\"+joinConditions[joinConditionIndex].conditionField1.column\r\n      }\r\n      return(newJoinCondition);\r\n    }\r\n    var fixedModels = this.reorder(\r\n      this.state.models.response.models,\r\n      result.source.index,\r\n      result.destination.index\r\n    );\r\n    // console.log(\"Fixed Models\");\r\n    // console.log(fixedModels);\r\n    var tempJoinConditions = fixedModels[result.source.index].joinConditions;\r\n    fixedModels[result.source.index].joinConditions = fixedModels[result.destination.index].joinConditions;\r\n    fixedModels[result.destination.index].joinConditions = tempJoinConditions;\r\n    // console.log(fixedModels[result.source.index]);\r\n    if(fixedModels[result.source.index].joinConditions) {\r\n      fixedModels[result.source.index].joinConditions = reorderJoinConditions(fixedModels[result.source.index].joinConditions);\r\n    } else {\r\n      fixedModels[result.destination.index].joinConditions = reorderJoinConditions(fixedModels[result.destination.index].joinConditions);\r\n    }\r\n    // console.log(fixedModels);\r\n    this.setState({models: {...this.state.models, \"response\": {...this.state.models.response, \"models\":  fixedModels}}});\r\n    }\r\n  \r\n\r\n  render() {\r\n    if(this.props.appState !== \"ModelBuilder\") return null;\r\n    if(this.props.logState === true) {\r\n        console.log(\"ModelBuilder State:\");\r\n        console.log(this.state);\r\n      }\r\n    if(this.props.openSQLPanel) this.state.openSQLPanel?this.setState({openSQLPanel: false}):this.setState({openSQLPanel: true})\r\n    return (\r\n        <div>\r\n          <Container fluid>\r\n            <Row>\r\n              <Col>\r\n                <div className=\"modelList\">\r\n                  <Models \r\n                    models={this.state.models} \r\n                    modelDragEnd={this.modelDragEnd}\r\n                    showColumns={this.state.showColumns}\r\n                    saveEditedModel={this.saveEditedModel}\r\n                    toggleJoinModal = { this.toggleJoinModal }\r\n                    showJoinModal = {this.state.showJoinModal}\r\n                    highlightedColumns = {this.state.highlightedColumns}\r\n                    contextMenuOpen={this.props.contextMenuOpen}\r\n                    openContextMenu={this.props.openContextMenu}\r\n                    editSelect={this.editSelect}\r\n                  />\r\n                </div>\r\n              </Col>\r\n              <Col>\r\n                <div className=\"conditionList\">\r\n                  <Conditions \r\n                      models={this.state.models} \r\n                      conditions={this.state.conditions}\r\n                      editCondition={this.editCondition}\r\n                      contextMenuOpen={this.props.contextMenuOpen}\r\n                      openContextMenu={this.props.openContextMenu}\r\n                    />\r\n                </div>\r\n                </Col>\r\n                <Col>\r\n                <div className=\"outputList\">\r\n                  <Selects\r\n                    models={this.state.models}\r\n                    highlightColumn={this.highlightColumn}\r\n                    selects={this.state.selects}\r\n                    editSelect={this.editSelect}\r\n                    contextMenuOpen={this.props.contextMenuOpen}\r\n                    openContextMenu={this.props.openContextMenu}\r\n                    outputModel={this.state.outputModel}\r\n                    editOutputModel={this.editOutputModel}\r\n                  />\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </Container>\r\n          <Collapse in={ this.state.openSQLPanel } timeout={2000} dimension={'width'}>\r\n            <div>\r\n              <div id=\"sqlPanelSideBar\" className=\"sidePanelContent\">\r\n                <div className=\"sideBarExitButton\">\r\n                  <XCircle onClick={() => this.setState({openSQLPanel: false})}></XCircle>\r\n                </div>\r\n                <SQLPanel\r\n                  state={this.state}\r\n                >\r\n                </SQLPanel>\r\n              </div>\r\n            </div>\r\n          </Collapse>\r\n        </div>\r\n          \r\n    );\r\n  }\r\n}\r\n\r\nexport default ModelBuilder;\r\n","import React, { useRef, useState } from 'react';\r\nimport { Overlay, Popover, Navbar, Nav } from 'react-bootstrap'; \r\nimport { useHistory } from 'react-router-dom';\r\nconst reactState = process.env.NODE_ENV;\r\nexport const NavBar = ({addModel, hostVersion, logState, openSQLPanel, openModelBuilder, openCatalog, openConfig, appState, contextMenuOpen, openContextMenu, selectModel, user, setUser, userConfig, setUserConfig}) => {\r\n    let history = useHistory();\r\n    const debugLogState = (reactState) => {\r\n        if ( reactState === 'development') {\r\n            return(\r\n                <div className=\"nav-item nav-link\" role=\"button\" onClick={() => logState()}>Show state in console </div>\r\n                );\r\n        } else return null;\r\n    }\r\n    const logoutButton = (hostVersion, userConfig) => {\r\n        if ( hostVersion === 'node') {\r\n            return(\r\n                <div className=\"nav-item nav-link mr-sm-2\" role=\"button\" onClick={() => logout()}>Logout {userConfig.firstname}</div>\r\n                );\r\n        } else return null;\r\n    }\r\n    const submitChanges = (hostVersion, createPR) => {\r\n        if ( hostVersion === 'node') {\r\n            return(\r\n                <div className=\"nav-item nav-link mr-sm-2\" role=\"button\" onClick={() => createPR()}>Submit changes</div>\r\n                );\r\n        } else return null;\r\n    }\r\n    const config = (hostVersion, createPR) => {\r\n        return(\r\n            <div className={\"nav-item nav-link bg-brand \"+(history.location.pathname.includes(\"/config\")?\"active\":null)} role=\"button\" onClick={() => history.push(\"/config\")}>Config</div>\r\n            );\r\n    }\r\n\r\n    const searchBox = useRef(null);\r\n\r\n    function debounceSearchResults(){\r\n      var timeout = 500;\r\n      let timer;\r\n      clearTimeout(timer);\r\n      timer = setTimeout(() => { history.push(\"/catalog/search/\"+searchBox.current.value); }, timeout);\r\n    }\r\n\r\n    const getSearchResults = (e) => {\r\n        // console.log(\"getSearchResults\");\r\n        if(e.target.value.trim().length===0) {\r\n            return null;\r\n        };\r\n        debounceSearchResults();\r\n        return null;\r\n    };\r\n\r\n    const toggleSearch = () => {\r\n        history.push(\"/catalog/search/\"+searchBox.current.value);\r\n    }\r\n\r\n    const reloadDBT = () => {\r\n        fetch('/api/v1/reload_dbt', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Token ' + user.token,\r\n          }\r\n        });\r\n    }\r\n\r\n    const createPR = () => {\r\n        var prTitle = prompt(\"Please describe your changes:\", \"Added descriptions to models x, y\");\r\n        // console.log(prTitle);\r\n        var prRequestBody = {\r\n            \"prTitle\": prTitle\r\n        }\r\n        fetch('/api/v1/create_pr', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Token ' + user.token,\r\n          },\r\n          body: JSON.stringify(prRequestBody)\r\n        });\r\n    }\r\n\r\n    const logout = () => {\r\n        fetch('/api/v1/users/logout', {\r\n          headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            'Authorization': 'Token ' + user.token,\r\n          },\r\n        });\r\n        setUser({\"user\":{}});\r\n        sessionStorage.removeItem(\"user\");\r\n        setUserConfig({});\r\n        sessionStorage.removeItem(\"userconfig\");\r\n    }\r\n    // console.log(history);\r\n    return(\r\n    <Navbar className=\"navbar-dark bg-brand position-fixed w-100 z-100\" expand=\"lg\">\r\n        <Navbar.Brand href=\"/\">TĀNGATA</Navbar.Brand>\r\n        {/* <a className=\"navbar-brand bg-brand\" href=\"/\">TANGATA</a> */}\r\n        <Navbar.Toggle aria-controls=\"navbarContent\"/>\r\n        <Navbar.Collapse id=\"navbarContent\" className=\"justify-content-between\">\r\n            <div className=\"navbar-nav p-2 bg-brand\">\r\n                <div className={\"nav-item nav-link bg-brand \"+(history.location.pathname.includes(\"/catalog\")?\"active\":null)} role=\"button\" onClick={() => history.push(\"/catalog\")}>Catalog</div>\r\n                {config(hostVersion, userConfig)}\r\n            </div>\r\n            <div className=\"navbar-nav p2\">\r\n                <form className=\"form-inline\">\r\n                    <input className=\"form-control mr-sm-2\" type=\"search\" ref={searchBox} onFocus={() => toggleSearch()} onChange={(e) => getSearchResults(e)} placeholder=\"Search Models\" aria-label=\"Search Models\"/>\r\n                </form>\r\n            </div>\r\n            <div className=\"navbar-nav p-2\">\r\n                <div className={\"nav-item nav-link mr-sm-2\"+(userConfig.dbtmethod!==\"UploadMetadata\"?null:\" d-none\")} role=\"button\" onClick={() => reloadDBT()}>Refresh dbt_ catalog</div>\r\n                {submitChanges(hostVersion, createPR)}\r\n                {/* <div className=\"nav-item nav-link mr-sm-2\" role=\"button\" onClick={() => openSQLPanel()}>Open SQL Panel </div> */}\r\n                {debugLogState(reactState)}\r\n                {logoutButton(hostVersion, userConfig)}\r\n            {/* <a class=\"nav-item nav-link active\" href=\"#\">Home <span class=\"sr-only\">(current)</span></a>\r\n            <a class=\"nav-item nav-link\" href=\"#\">Features</a>\r\n            <a class=\"nav-item nav-link\" href=\"#\">Pricing</a>\r\n            <a class=\"nav-item nav-link disabled\" href=\"#\">Disabled</a> */}\r\n            </div>\r\n        </Navbar.Collapse>\r\n    </Navbar>\r\n    )\r\n}\r\n\r\n","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useState } from 'react';\r\nimport { Overlay, Table } from 'react-bootstrap';\r\nimport ReactFlow, {\r\n  ReactFlowProvider,\r\n  MiniMap,\r\n  isNode\r\n} from 'react-flow-renderer';\r\nimport dagre from 'dagre';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\n// import './layouting.css';\r\n\r\nconst dagreGraph = new dagre.graphlib.Graph();\r\ndagreGraph.setDefaultEdgeLabel(() => ({}));\r\n\r\n// In order to keep this example simple the node width and height are hardcoded.\r\n// In a real world app you would use the correct width and height values of\r\n// const nodes = useStoreState(state => state.nodes) and then node.__rf.width, node.__rf.height\r\n\r\nconst nodeWidth = 200;\r\nconst nodeHeight = 33;\r\nconst getLayoutedElements = (elements, direction = 'LR') => {\r\n  dagreGraph.setGraph({ rankdir: direction });\r\n  // console.log(\"getLayoutedElements\");\r\n  // console.log(elements);\r\n  elements.forEach((el) => {\r\n    if (isNode(el)) {\r\n      dagreGraph.setNode(el.id, { width: nodeWidth, height: nodeHeight });\r\n    } else {\r\n      dagreGraph.setEdge(el.source, el.target);\r\n    }\r\n  });\r\n\r\n  dagre.layout(dagreGraph);\r\n\r\n\r\n\r\n  return elements.map((el) => {\r\n    if (isNode(el)) {\r\n      const nodeWithPosition = dagreGraph.node(el.id);\r\n      el.targetPosition = 'left';\r\n      el.sourcePosition = 'right';\r\n\r\n      // unfortunately we need this little hack to pass a slighltiy different position\r\n      // to notify react flow about the change. More over we are shifting the dagre node position\r\n      // (anchor=center center) to the top left so it matches the react flow node anchor point (top left).\r\n      el.position = {\r\n        x: nodeWithPosition.x - nodeWidth / 2 + Math.random() / 1000,\r\n        y: nodeWithPosition.y - nodeHeight / 2,\r\n      };\r\n    }\r\n\r\n    return el;\r\n  });\r\n};\r\n\r\n\r\n\r\n\r\nconst LayoutFlow = (props) => {\r\n  let history = useHistory();\r\n  const [contextMenu, setContextMenu] = useState({\"x\":null,\"y\":null,\"display\":false});\r\n//   const { fitView } = useZoomPanHelper();\r\n// console.log(\"LayoutFlow\");  \r\n// console.log(props.lineageArray);\r\n    const layoutedElements = getLayoutedElements(props.lineageArray.lineage);\r\n  const [elements, setElements] = useState(layoutedElements);\r\n  const onLoad = (reactFlowInstance) => {\r\n    reactFlowInstance.fitView({padding: 0.1, includeHiddenNodes: true});\r\n  }\r\n  const onNodeRightClick = (event, node) => {\r\n    event.preventDefault();\r\n    // console.log(event);\r\n    // console.log(node.id);\r\n    setContextMenu({\"x\":event.pageX,\"y\":event.pageY,\"display\":true,\"target\": event.target, \"nodeID\": node.id});\r\n    // addToSelect(node.id);\r\n  }\r\n\r\n  const Backdrop = () => {\r\n    return(\r\n      <div style={{\r\n        position: \"fixed\",\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        background: \"rgba(0,0,0,0.2)\",\r\n        zIndex: 1500\r\n      }}\r\n      onClick={() => setContextMenu({\"x\":null,\"y\":null,\"display\":false})}\r\n      onContextMenu={() => setContextMenu({\"x\":null,\"y\":null,\"display\":false})}\r\n      />\r\n    )\r\n  };\r\n\r\n  const contextMenuDisplay = (contextMenu) => {\r\n    if(contextMenu.display === false) return null;\r\n    // console.log(\"Displaying Context Menu\");\r\n    // console.log(contextMenu);\r\n\r\n    // console.log(contextMenu.target.firstChild.data);\r\n    // console.log(contextMenu.target);\r\n    // console.log(JSON.parse(contextMenu.target.dataset.selectvalue));\r\n    // console.log(contextMenu.target.dataset.selectvalue.model);\r\n    return(\r\n      <div>\r\n        <Overlay target={contextMenu.target} show={contextMenu.display} placement=\"right-start\">\r\n          <div style={{zIndex:1051}}>\r\n            <Table bordered variant=\"dark\">\r\n              <tbody>\r\n                <tr>\r\n                  <td onClick={() => history.push(\"/catalog/\"+contextMenu.nodeID)}>\r\n                    Open Model in Current Tab\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td onClick={() => window.open('/catalog/'+contextMenu.nodeID)}>\r\n                    Open Model in New Tab\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </Table>\r\n          </div>\r\n        </Overlay>\r\n        <Backdrop show={contextMenu.display}/>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"layoutflow lineagebox\">\r\n      <ReactFlowProvider>\r\n        <ReactFlow\r\n          elements={elements}\r\n          connectionLineType=\"smoothstep\"\r\n          onLoad={onLoad}\r\n          onNodeContextMenu={onNodeRightClick}\r\n          minZoom=\"0.1\"\r\n        >\r\n            <MiniMap />\r\n        </ReactFlow>\r\n      </ReactFlowProvider>\r\n      {contextMenuDisplay(contextMenu)}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LayoutFlow;\r\n\r\n","import {Row, Col } from 'react-bootstrap';\r\nimport {Component} from 'react';\r\n\r\nexport default class ShowSearchResults extends Component {\r\n    render() {\r\n        var searchResults = this.props.searchResults;\r\n        \r\n        if(searchResults.results.length>0) {\r\n            searchResults.results = searchResults.results.sort(function demoteResults(firstEl, secondEl) {return Math.min(0,secondEl.promoteStatus)-Math.min(0,firstEl.promoteStatus)});\r\n        }\r\n        var resultSelectFunction = this.props.resultSelectFunction;\r\n        const searchRow = (searchResult, index) => {\r\n            // console.log(\"searchRow\")\r\n            // console.log(searchResult);\r\n            const columnDetails = () => {\r\n                if(searchResult.type===\"column_name\" || searchResult.type===\"column_description\") {\r\n                    return(\r\n                        <div className=\"row\">\r\n                            <div className=\"col\">\r\n                                Column: {searchResult.columnName}\r\n                            </div>\r\n                            <div className=\"col\">\r\n                                {searchResult.columnDescription}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                } else return null;\r\n            }\r\n            const tagDetails = () => {\r\n                if(searchResult.type===\"tag_name\") {\r\n                    return(\r\n                        <div className=\"row\">\r\n                            <div className=\"col\">\r\n                                Tag: {searchResult.tagName}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                } else return null;\r\n            }\r\n            // console.log(resultSelectFunction);\r\n            console.log(searchResult);\r\n\r\n            function promoteIcon() {\r\n                return(\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"green\" class=\"bi bi-patch-check\" viewBox=\"0 0 16 16\">\r\n                        <path fill-rule=\"evenodd\" d=\"M10.354 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708 0z\"/>\r\n                        <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911l-1.318.016z\"/>\r\n                    </svg>\r\n                )\r\n            }\r\n\r\n            function demoteIcon() {\r\n                return(\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"red\" class=\"bi bi-patch-exclamation\" viewBox=\"0 0 16 16\">\r\n                        <path d=\"M7.001 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.553.553 0 0 1-1.1 0L7.1 4.995z\"/>\r\n                        <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911l-1.318.016z\"/>\r\n                    </svg>\r\n                )\r\n            }\r\n\r\n\r\n            return (\r\n                <div className={\"row\"+(searchResult.promoteStatus===1?\" promote\":(searchResult.promoteStatus===-1?\" demote\":\"\"))} key={\"searchRow\"+index}>\r\n                    <div className=\"col-sm\">\r\n                        <div className=\"container\" onClick={(e) => resultSelectFunction(e, index)}>\r\n                            <div className=\"row\">\r\n                                <div className=\"col font-weight-bold\">\r\n                                    {searchResult.modelName.toLowerCase()} {searchResult.promoteStatus===1?promoteIcon():(searchResult.promoteStatus===-1?demoteIcon():\"\")}\r\n                                </div>\r\n                                <div className=\"col font-weight-light font-italic text-right\">\r\n                                    {searchResult.nodeID.toLowerCase()}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"row\">\r\n                                <div className=\"col font-italic\">\r\n                                    {searchResult.modelDescription}\r\n                                </div>\r\n                            </div>\r\n                            {columnDetails()}\r\n                            {tagDetails()}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }    \r\n        var AllSearchRows = () => {\r\n        // console.log(searchResults);\r\n            if(searchResults.results.length===0) {\r\n                function noResults() {\r\n                    if(searchResults.searchString===\"promoted\") {\r\n                        return(<>No Promoted Models.<br/>Promote models in the catalog to add to this list.</>)\r\n                    } else {\r\n                        return(<>No search results</>)\r\n                    }\r\n                }\r\n            return(\r\n                <div className=\"container searchbox z-200\">\r\n                <Row>\r\n                    <Col>\r\n                        <span className=\"text-center\">{noResults()}</span>\r\n                    </Col>\r\n                </Row>\r\n                    \r\n                </div>\r\n            );\r\n            }\r\n            const allSearchRows = searchResults.results.map((searchResult, index) => searchRow(searchResult, index));\r\n            \r\n            function resultCount() {\r\n                if(searchResults.searchString===\"promoted\") {\r\n                    return(<></>)\r\n                } else {\r\n                    return(<>{searchResults.results.length} search results:</>)\r\n                }\r\n            }\r\n            return(\r\n                    <div className=\"container searchbox z-200\">\r\n                    <Row>\r\n                        <Col>\r\n                            <div className=\"text-center\">{resultCount()}</div>\r\n                        </Col>\r\n                    </Row>\r\n                        {allSearchRows}\r\n                    </div>\r\n            );\r\n            \r\n        }\r\n        return(\r\n            <div>\r\n                <AllSearchRows/>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n","export async function getModelSearch(searchString, user) {\r\n    // console.log(user);\r\n    const response = await fetch('/api/v1/model_search/' + searchString, {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","export async function getModel(modelNodeId, user) {\r\n    const response = await fetch('/api/v1/models/' + modelNodeId, {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","import  ShowSearchResults  from './ShowSearchResults';\r\nimport {Component, createRef} from 'react';\r\nimport { getModelSearch } from '../services/getModelSearch';\r\nimport { getModel } from '../services/getModel';\r\n\r\nexport default class RefSearchResults extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          refSearchResults: {},\r\n          refColumns: {},\r\n          selectedModel: {}\r\n        };\r\n        this.refSearchBox = createRef();\r\n      }\r\n    debounceRefSearchResults(e) {\r\n        var timeout = 1000;\r\n        let timer;\r\n        clearTimeout(timer);\r\n        timer = setTimeout(() => {\r\n            getModelSearch(this.refSearchBox.current.value, this.props.user)\r\n            .then(response => {\r\n            if(response.length===0 || response.error) {\r\n                // this.setState({refSearchResults: {}});\r\n                return null;\r\n            }\r\n            this.setState({refSearchResults: {\"searchResults\": response}});\r\n            });\r\n            }, timeout);\r\n    }\r\n\r\n    selectColumn = (column) => {\r\n        this.props.selectModelColumn(this.state.selectedModel.modelName, column)\r\n    }\r\n\r\n    clearColumns = () => {\r\n        this.setState({refColumns: {}});\r\n    }\r\n\r\n    CatalogColumns = () => {\r\n        const columnRows = () => {\r\n          return Object.entries(this.state.refColumns).map((value,index) => {\r\n            return(\r\n              <tr key={\"columnRow\"+value[0]} onClick={() => this.selectColumn(value[0])}>\r\n                <td className=\"catalogColumnName\">\r\n                    {value[0].toLowerCase().replaceAll(\"_\",\"_\\u200b\")}\r\n                </td>\r\n                <td className=\"catalogColumnType\">\r\n                    {value[1].type.toLowerCase()}\r\n                </td>\r\n                <td>\r\n                    <div>\r\n                        {value[1].description}\r\n                    </div>\r\n                </td>\r\n              </tr>\r\n            );\r\n          });\r\n        }\r\n        if(Object.keys(this.state.refColumns).length > 0) { //if this has columns\r\n          return(\r\n            <div className=\"row mt-md-3\">\r\n              <div className=\"col\">\r\n                Choose Column:\r\n                <table className=\"table table-sm\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>\r\n                        Name\r\n                      </th>\r\n                      <th>\r\n                        Type\r\n                      </th>\r\n                      <th>\r\n                        Description\r\n                      </th>\r\n                      <th>\r\n                        Tests\r\n                      </th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {columnRows()}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          );\r\n        } else {\r\n          return(\r\n            <div className=\"row\">\r\n              <div className=\"col col-md-auto\">\r\n                This model does not appear to contain any columns.\r\n              </div>\r\n            </div>\r\n          );\r\n        };\r\n      }\r\n\r\n    render() {\r\n        if(Object.keys(this.state.refColumns).length === 0 && this.state.refSearchResults && this.state.refSearchResults.searchResults && this.state.refSearchResults.searchResults.results && this.state.refSearchResults.searchResults.results.length > 0) {\r\n            var selectSearchResult = (e,index) => {\r\n                getModel(this.state.refSearchResults.searchResults.results[index].nodeID, this.props.user)\r\n                .then(response => {\r\n                if(!response.error) {\r\n                    this.setState({refColumns: response.columns, selectedModel: this.state.refSearchResults.searchResults.results[index]})\r\n                }\r\n                });\r\n            }\r\n            return(\r\n                <div>\r\n                    <input className=\"form-control mr-sm-2\" type=\"search\" ref={this.refSearchBox} onFocus={() => this.clearColumns()} onChange={(e) => this.debounceRefSearchResults(e)} placeholder=\"Search Models\" aria-label=\"Search Models\"/>\r\n                    <ShowSearchResults\r\n                        searchResults = {this.state.refSearchResults.searchResults}\r\n                        resultSelectFunction = {selectSearchResult}\r\n                    />\r\n                </div>\r\n            \r\n            )\r\n        } else if (Object.keys(this.state.refColumns).length > 0) {\r\n            return(\r\n                <div>\r\n                    <input className=\"form-control mr-sm-2\" type=\"search\" ref={this.refSearchBox} onFocus={() => this.clearColumns()} onChange={(e) => this.debounceRefSearchResults(e)} placeholder=\"Search Models\" aria-label=\"Search Models\"/>\r\n                    <this.CatalogColumns/>\r\n                </div>\r\n            \r\n            )\r\n        } else {\r\n            return(\r\n            <div>\r\n                <input className=\"form-control mr-sm-2\" type=\"search\" ref={this.refSearchBox} onFocus={() => this.clearColumns()} onChange={(e) => this.debounceRefSearchResults(e)} placeholder=\"Search Models\" aria-label=\"Search Models\"/>\r\n            </div>\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n","export async function getModelTree(user) {\r\n    const response = await fetch('/api/v1/model_tree', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","export async function getDBTree(user) {\r\n    const response = await fetch('/api/v1/db_tree', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response.json();\r\n}","import React, { useState, useEffect, useRef } from 'react';\r\nimport { HddRackFill, FolderFill, Table } from 'react-bootstrap-icons';\r\nimport {Container, Collapse, Row, Col, Tabs, Tab, Accordion, Card, Button, Modal } from 'react-bootstrap';\r\nimport { Menu, Item, Separator, Submenu, MenuProvider, useContextMenu } from 'react-contexify';\r\nimport 'react-contexify/dist/ReactContexify.css';\r\nimport { Drawer, } from 'react-bootstrap-drawer';\r\nimport '../App.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'react-bootstrap-drawer/lib/style.css';\r\nimport  LayoutFlow  from './Lineage';\r\nimport  RefSearchResults  from './RefSearchResults';\r\nimport  ShowSearchResults  from './ShowSearchResults';\r\nimport { getModel } from '../services/getModel';\r\nimport { getModelTree } from '../services/getModelTree';\r\nimport { getDBTree } from '../services/getDBTree';\r\nimport { getModelSearch } from '../services/getModelSearch';\r\nimport ContentEditable from 'react-contenteditable';\r\nimport TreeMenu from 'react-simple-tree-menu';\r\nimport 'react-simple-tree-menu/dist/main.css';\r\nimport Select, { components } from 'react-select'\r\nimport chroma from 'chroma-js';\r\nimport { useHistory } from 'react-router-dom';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link,\r\n  useParams,\r\n  useRouteMatch\r\n} from \"react-router-dom\";\r\n\r\nexport default function Catalog (props) {\r\n  let history = useHistory();\r\n  const [catalogModel, setCatalogModel] = useState({});\r\n  const [rawModelTree, setRawModelTree] = useState();\r\n  const [rawDBTree, setRawDBTree] = useState();\r\n  const [searchResults, setSearchResults] = useState();\r\n  const [newRefTest, setNewRefTest] = useState();\r\n  const [refSearchQuery, setRefSearchQuery] = useState();\r\n  const routeSearchQuery = useRouteMatch(\"/catalog/search/:searchQuery\");\r\n  const [treeTab, setTreeTab] = useState(\"databases\");\r\n  const [folderTree, setFolderTree] = useState();\r\n  const [dbTree, setDBTree] = useState();\r\n  const treeFolderRef = useRef();\r\n  const treeDBRef = useRef();\r\n  let { path, url } = useRouteMatch();\r\n  const TEST_MENU_ID = 'testMenu';\r\n  const { show } = useContextMenu();\r\n  function catalogDescription()  {\r\n    if(catalogModel.description) {\r\n      return catalogModel.description;\r\n    } else {\r\n      return null;\r\n    };\r\n  }\r\n  useEffect(() => {\r\n    getModelTree(props.user)\r\n    .then(response => {\r\n      if(!response.error) {\r\n        setRawModelTree(response);\r\n        setFolderTree(RecurseFullFolderTree(response));\r\n        \r\n        \r\n      }\r\n    })\r\n    getDBTree(props.user)\r\n    .then(response => {\r\n      if(!response.error) {\r\n        setRawDBTree(response);\r\n        setDBTree(RecurseFullDBTree(response));\r\n        \r\n      }\r\n    })\r\n  }, []);\r\n\r\n  function catalogDependsOn() {\r\n    // \r\n    // \r\n\r\n    const ancestorModels = () => {\r\n      if(!catalogModel.depends_on) return null;\r\n      // \r\n      return catalogModel.depends_on.nodes.map((value,index) => {\r\n        // \r\n        var ancestorClickEvent = (e) => {e.preventDefault(); history.push(\"/catalog/\"+value);};\r\n        return(\r\n          <div key={\"catalogDependsOnModel\"+index} title={value}>\r\n            {index===0?(<b>Models:<br/></b>):null}\r\n            <a href=\"#\" onClick={ancestorClickEvent}>{value.split(\".\").pop()}</a>\r\n          </div>\r\n        )\r\n      });\r\n    }\r\n    const ancestorMacros = () => {\r\n      if(!catalogModel.depends_on) return null;\r\n      return catalogModel.depends_on.macros.map((value,index) => {\r\n        return(\r\n          <div key={\"catalogDependsOnMacro\"+index} title={value}>\r\n            {index===0?(<b>Macros:<br/></b>):null}\r\n            {value.split(\".\").pop()}\r\n          </div>\r\n        )\r\n      });\r\n    }\r\n    return (\r\n      <>\r\n        {ancestorModels()}\r\n        {ancestorMacros()}\r\n      </>\r\n    )\r\n  }\r\n\r\n  function catalogDependencies() {\r\n    // \r\n    // \r\n\r\n    const dependentModels = () => catalogModel.referenced_by.map((value,index) => {\r\n      var dependentClickEvent = (e) => {e.preventDefault(); history.push(\"/catalog/\"+value);};\r\n      return(\r\n        <div key={\"catalogDependentModel\"+index} title={value}>\r\n          {index===0?(<b>Models:<br/></b>):null}\r\n          <a href=\"#\" onClick={dependentClickEvent}>{value.split(\".\").pop()}</a>\r\n        </div>\r\n      )\r\n    });\r\n    return (\r\n      <>\r\n        {dependentModels()}\r\n      </>\r\n    )\r\n  }\r\n\r\n  function nodeContributors() {\r\n    // \r\n    // \r\n\r\n    const nodeContributorMap = () => catalogModel.all_contributors.map((value,index) => {\r\n      return(\r\n        <div key={\"nodeContributor\"+index} title={value}>\r\n          {index===0?(<b>Contributors:<br/></b>):null}\r\n          {value}\r\n        </div>\r\n      )\r\n    });\r\n\r\n    if(catalogModel.all_contributors.length > 1) {\r\n      return (\r\n        <>\r\n          {nodeContributorMap()}\r\n        </>\r\n      )\r\n    } else {\r\n      return null;\r\n    }\r\n    \r\n  }\r\n\r\n\r\n  function nodeHistory() {\r\n    // \r\n    // \r\n    const fileCommits = () => catalogModel.all_commits.map((value,index) => {\r\n      return(\r\n        <tr key={\"catalogFileCommit \"+index} title={value.hash}>\r\n          <td title={value.authorDate}>\r\n            {value.authorDateRel}\r\n          </td>\r\n          <td>\r\n            {value.authorName}\r\n          </td>\r\n          <td>\r\n            <a href={value.originURL !== null?value.originURL:null} target=\"_blank\">\r\n              {value.subject}\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      )\r\n    });\r\n    return (\r\n      <>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">\r\n                Date\r\n              </th>\r\n              <th scope=\"col\">\r\n                Author\r\n              </th>\r\n              <th scope=\"col\">\r\n                Commit Message\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {fileCommits()}\r\n          </tbody>\r\n        </table>\r\n      </>\r\n    )\r\n  }\r\n\r\n  function AddRefTest() {\r\n    \r\n    const handleClose = () => {\r\n      setNewRefTest(null);\r\n      }\r\n\r\n    const selectModelColumn = (model, column) => {\r\n      var allTests = [];\r\n      var newTest = {\"type\": \"relationships\", \"severity\": \"ERROR\", \"related_model\": model, \"related_field\": column};\r\n      allTests.push({\"relationships\": {\r\n        \"to\": \"ref('\" + model + \"')\",\r\n        \"field\": column,\r\n        \"severity\": \"ERROR\"}});\r\n      setCatalogModel({\r\n        ...catalogModel,\r\n        columns: {\r\n          ...catalogModel.columns,\r\n          [newRefTest.column.name]: {\r\n            ...catalogModel.columns[newRefTest.column.name],\r\n            tests: [\r\n              ...catalogModel.columns[newRefTest.column.name].tests,\r\n              newTest\r\n            ]\r\n          },\r\n        }\r\n      });\r\n      for(var thisTest in catalogModel.columns[newRefTest.column.name].tests) { //add existing tests to allTests\r\n        if(catalogModel.columns[newRefTest.column.name].tests[thisTest].type === \"relationships\") {\r\n          allTests.push({[catalogModel.columns[newRefTest.column.name].tests[thisTest].type]: {\r\n            \"to\": \"ref('\" + catalogModel.columns[newRefTest.column.name].tests[thisTest].related_model + \"')\",\r\n            \"field\": catalogModel.columns[newRefTest.column.name].tests[thisTest].related_field},\r\n            \"severity\": catalogModel.columns[newRefTest.column.name].tests[thisTest].severity.toUpperCase()})\r\n        } else {\r\n          allTests.push({[catalogModel.columns[newRefTest.column.name].tests[thisTest].type]: {\r\n            \"severity\": catalogModel.columns[newRefTest.column.name].tests[thisTest].severity.toUpperCase()\r\n          }})\r\n        } \r\n      };\r\n      updateMetadataModel({\r\n        \"column\": newRefTest.column.name,\r\n        \"tests\": allTests,\r\n        \"target\": {\"dataset\": {\"metadatafield\": \"ColumnTest\"}}\r\n      });\r\n      handleClose();\r\n    }\r\n    \r\n\r\n    return(\r\n      <Modal show={newRefTest} onHide={handleClose}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Reference Test Setup</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          Model to reference:\r\n        <RefSearchResults\r\n          user = {props.user}\r\n          selectModelColumn = {selectModelColumn}\r\n        />\r\n        </Modal.Body>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  function catalogColumns() {\r\n\r\n    const columnRows = () => {\r\n      return Object.entries(catalogModel.columns).map((value,index) => {\r\n        const options = [\r\n          { value: 'not_null', label: 'Not Null', \"column\": value[1].name, \"color\": \"#FF0000\"},\r\n          { value: 'unique', label: 'Unique', \"column\": value[1].name, \"color\": \"#FF0000\"},\r\n          { value: Date.now(), label: 'Relationship', \"column\": value[1].name, \"color\": \"#FF0000\"}\r\n        ]\r\n\r\n        const colourStyles = {\r\n          control: styles => ({ ...styles, backgroundColor: 'white' }),\r\n          option: (styles, { data, isDisabled, isFocused, isSelected }) => {\r\n            const color = chroma(data.color);\r\n            return {\r\n              ...styles,\r\n              backgroundColor: isDisabled\r\n                ? null\r\n                : isSelected\r\n                ? data.color\r\n                : isFocused\r\n                ? color.alpha(0.1).css()\r\n                : null,\r\n              color: isDisabled\r\n                ? '#ccc'\r\n                : isSelected\r\n                ? chroma.contrast(color, 'white') > 2\r\n                  ? 'white'\r\n                  : 'black'\r\n                : data.color,\r\n              cursor: isDisabled ? 'not-allowed' : 'default',\r\n        \r\n              ':active': {\r\n                ...styles[':active'],\r\n                backgroundColor:\r\n                  !isDisabled && (isSelected ? data.color : color.alpha(0.3).css()),\r\n              },\r\n            };\r\n          },\r\n          multiValue: (styles, { data }) => {\r\n            const color = chroma(data.color);\r\n            return {\r\n              ...styles,\r\n              backgroundColor: color.alpha(0.1).css(),\r\n            };\r\n          },\r\n          multiValueLabel: (styles, { data }) => ({\r\n            ...styles,\r\n            color: data.color,\r\n          }),\r\n          multiValueRemove: (styles, { data }) => ({\r\n            ...styles,\r\n            color: data.color,\r\n            ':hover': {\r\n              backgroundColor: data.color,\r\n              color: 'white',\r\n            },\r\n          }),\r\n        };\r\n\r\n        function formatTests(tests) {\r\n          var currentTests = []\r\n          for(var thisTest in tests) {\r\n            var testSeverityColor = \"#000000\";\r\n            var testType = \"\";\r\n            var testLabel = \"\";\r\n            if(value[1].tests[thisTest].severity === \"ERROR\") {\r\n              testSeverityColor = \"#FF0000\";\r\n            } else if(value[1].tests[thisTest].severity === \"WARNING\") {\r\n              testSeverityColor = \"#0000FF\";\r\n            }\r\n            if(value[1].tests[thisTest].type === \"relationships\") {\r\n              testType = \"relationships\";\r\n              testLabel = (<span title={value[1].tests[thisTest].related_model + \".\" + value[1].tests[thisTest].related_field}>Relationship</span>);\r\n            } else if(value[1].tests[thisTest].type === \"not_null\") {\r\n              testType = \"not_null\";\r\n              testLabel = (<span title={\"Column value must not be Null. Click to change test severity.\"}>Not Null</span>);\r\n            } else if(value[1].tests[thisTest].type === \"unique\") {\r\n              testType = \"unique\";\r\n              testLabel = (<span title={\"Column value must be unique. Click to change test severity.\"}>Unique</span>);\r\n            }\r\n            currentTests.push({\"value\": testType, \"label\": testLabel, \"color\": testSeverityColor})\r\n          }\r\n        return currentTests;\r\n        }\r\n\r\n        function testChanged(testValue, testAction) {\r\n          // \r\n          // \r\n          // \r\n          // \r\n          var allTests = [];\r\n          if(testAction.action === \"select-option\") {\r\n            var newTest = {};\r\n            if(testAction.option.value === \"unique\" || testAction.option.value === \"not_null\") {\r\n              // TODO: push test to column.tests\r\n              newTest = {\"type\": testAction.option.value, \"severity\": \"ERROR\"};\r\n              allTests.push({[testAction.option.value]: {\r\n                \"severity\": \"ERROR\"\r\n              }})\r\n              setCatalogModel({\r\n                ...catalogModel,\r\n                columns: {\r\n                  ...catalogModel.columns,\r\n                  [testAction.option.column]: {\r\n                    ...catalogModel.columns[testAction.option.column],\r\n                    tests: [\r\n                      ...catalogModel.columns[testAction.option.column].tests,\r\n                      newTest\r\n                    ]\r\n                  },\r\n                }\r\n              })\r\n            } else if(testAction.option.label === \"Relationship\") {\r\n              setNewRefTest({\"column\": value[1]});\r\n              setCatalogModel(catalogModel);\r\n            }\r\n            \r\n            for(var thisTest in catalogModel.columns[value[0]].tests) { //add existing tests to allTests\r\n              if(catalogModel.columns[value[0]].tests[thisTest].type === \"relationships\") {\r\n                allTests.push({[catalogModel.columns[value[0]].tests[thisTest].type]: {\r\n                  \"to\": \"ref('\" + catalogModel.columns[value[0]].tests[thisTest].related_model + \"')\",\r\n                  \"field\": catalogModel.columns[value[0]].tests[thisTest].related_field},\r\n                  \"severity\": catalogModel.columns[value[0]].tests[thisTest].severity.toUpperCase()})\r\n              } else {\r\n                allTests.push({[catalogModel.columns[value[0]].tests[thisTest].type]: {\r\n                  \"severity\": catalogModel.columns[value[0]].tests[thisTest].severity.toUpperCase()\r\n                }})\r\n              } \r\n            }\r\n          } else if(testAction.action === \"remove-value\") {\r\n            let removeItemIndex = catalogModel.columns[value[0]].tests.indexOf(testAction.removedValue.value);\r\n            \r\n            \r\n            if(testAction.removedValue.value === 'relationships') {\r\n              \r\n              var newTests = catalogModel.columns[value[0]].tests.filter(thisTest => thisTest.related_model+\".\"+thisTest.related_field !== testAction.removedValue.label.props.title);\r\n            } else {\r\n              \r\n              var newTests = catalogModel.columns[value[0]].tests.filter(thisTest => thisTest.type !== testAction.removedValue.value);\r\n            }\r\n            setCatalogModel({\r\n              ...catalogModel,\r\n              columns: {\r\n                ...catalogModel.columns,\r\n                [value[0]]: {\r\n                  ...catalogModel.columns[value[0]],\r\n                  tests: newTests\r\n                },\r\n              }\r\n            })\r\n            allTests = [];\r\n            for(var thisTest in newTests) { //add existing tests to allTests\r\n              if(newTests[thisTest].type === \"relationships\") {\r\n                allTests.push({[newTests[thisTest].type]: {\r\n                  \"to\": \"ref('\" + newTests[thisTest].related_model + \"')\",\r\n                  \"field\": newTests[thisTest].related_field,\r\n                  \"severity\": newTests[thisTest].severity.toUpperCase()\r\n                }})\r\n              } else {\r\n                allTests.push({[newTests[thisTest].type]: {\r\n                  \"severity\": newTests[thisTest].severity.toUpperCase()\r\n                }})\r\n              } \r\n            }\r\n          }\r\n          updateMetadataModel({\r\n            \"column\": value[0],\r\n            \"tests\": allTests,\r\n            \"target\": {\"dataset\": {\"metadatafield\": \"ColumnTest\"}}\r\n          });\r\n        };\r\n        const MultiValueContainer = props => {\r\n          function MultiValueClick(e) {\r\n            e.preventDefault();\r\n            \r\n            \r\n            \r\n            show(e, {\r\n              props: {\r\n                  \"column\": value[0].toLowerCase(),\r\n                  \"testType\": e.target.textContent,\r\n                  \"relatedField\": e.target.title\r\n              }, id: \"testTypeMenu\",\r\n            })\r\n          }\r\n          return (\r\n            <div style={{\"cursor\":\"pointer\"}} onContextMenu={(e) => MultiValueClick(e)} onClick={(e) => MultiValueClick(e)}>\r\n              <components.MultiValueContainer {...props}/>\r\n            </div>\r\n          );\r\n        };\r\n        const ClearIndicator = props => {\r\n          return null;\r\n        }\r\n        function changeTest({event, props, data, triggerEvent}) {\r\n          var allTests = [];\r\n          let removeItemIndex = catalogModel.columns[props.column].tests.findIndex(function(thisTest) {\r\n            if(props.testType.toLowerCase() === \"relationship\") {\r\n              \r\n              return thisTest.related_model+\".\"+thisTest.related_field === props.relatedField;\r\n            } else {\r\n              \r\n              return thisTest.type === props.testType.toLowerCase().replace(\" \",\"_\");\r\n            }\r\n          });\r\n          let newTest = Object.assign({}, catalogModel.columns[props.column].tests[removeItemIndex]);\r\n          newTest.severity = event.target.innerText.toUpperCase();\r\n          // var newTests = catalogModel.columns[props.column].tests.filter(thisTest => thisTest.type !== props.testType.toLowerCase());\r\n          if(props.testType.toLowerCase() === 'relationship') {\r\n            \r\n            var newTests = catalogModel.columns[props.column].tests.filter(thisTest => thisTest.related_model+\".\"+thisTest.related_field !== props.relatedField);\r\n          } else {\r\n            \r\n            var newTests = catalogModel.columns[props.column].tests.filter(thisTest => thisTest.type !== props.testType.toLowerCase().replace(\" \",\"_\"));\r\n          }\r\n          newTests.push(newTest)\r\n          setCatalogModel({\r\n            ...catalogModel,\r\n            columns: {\r\n              ...catalogModel.columns,\r\n              [props.column]: {\r\n                ...catalogModel.columns[props.column],\r\n                tests: newTests\r\n              },\r\n            }\r\n          })\r\n          for(var thisTest in newTests) { //add existing tests to allTests\r\n            if(newTests[thisTest].type === \"relationships\") {\r\n              allTests.push({[newTests[thisTest].type]: {\r\n                \"to\": \"ref('\" + newTests[thisTest].related_model + \"')\",\r\n                \"field\": newTests[thisTest].related_field,\r\n                \"severity\": newTests[thisTest].severity.toUpperCase()\r\n              }})\r\n            } else {\r\n              allTests.push({[newTests[thisTest].type]: {\r\n                \"severity\": newTests[thisTest].severity.toUpperCase()\r\n              }})\r\n            } \r\n          }\r\n          updateMetadataModel({\r\n            \"column\": props.column,\r\n            \"tests\": allTests,\r\n            \"target\": {\"dataset\": {\"metadatafield\": \"ColumnTest\"}}\r\n          });\r\n        }\r\n        return(\r\n          <tr key={\"columnRow\"+value[0]}>\r\n            <td className=\"catalogColumnName\">\r\n              {value[0].toLowerCase().replaceAll(\"_\",\"_\\u200b\")}\r\n            </td>\r\n            <td className=\"catalogColumnType\">\r\n              {value[1].type.toLowerCase()}\r\n            </td>\r\n            <td>\r\n              \r\n            <ContentEditable\r\n                  html={value[1].description}\r\n                  onBlur={updateMetadataModel}\r\n                  data-metadatafield=\"ColumnDescription\"\r\n                  className=\"catalogColumnDescription\"\r\n                  data-columnName={value[0].toLowerCase()}\r\n                  placeholder={\"Add a description\"}\r\n                />\r\n            </td>\r\n            <td style={{width:\"230px\"}}>\r\n              <Select \r\n                options={options}\r\n                value={formatTests(catalogModel.columns[value[0]].tests)}\r\n                isMulti\r\n                onChange={testChanged}\r\n                styles={colourStyles}\r\n                menuPortalTarget={document.body}\r\n                openMenuOnClick={false}\r\n                components={{ MultiValueContainer, ClearIndicator }}\r\n              />\r\n            </td>\r\n            <Menu id={\"testTypeMenu\"}>\r\n              <Item id=\"setError\" onClick={changeTest}>Error</Item>\r\n              <Item id=\"setWarning\" onClick={changeTest}>Warning</Item>\r\n            </Menu>\r\n          </tr>\r\n        );\r\n      });\r\n    }\r\n    if(Object.keys(catalogModel.columns).length > 0) { //if this has columns\r\n      return(\r\n        <div className=\"row mt-md-3\">\r\n          <div className=\"col\">\r\n            <table className=\"table table-sm\">\r\n              <thead>\r\n                <tr>\r\n                  <th>\r\n                    Name\r\n                  </th>\r\n                  <th>\r\n                    Type\r\n                  </th>\r\n                  <th>\r\n                    Description\r\n                  </th>\r\n                  <th>\r\n                    Tests\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {columnRows()}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      return(\r\n        <div className=\"row\">\r\n          <div className=\"col col-md-auto\">\r\n            This model does not appear to contain any columns.\r\n          </div>\r\n        </div>\r\n      );\r\n    };\r\n  }\r\n\r\n  function promoteIcon() {\r\n    return(\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"green\" class=\"bi bi-patch-check\" viewBox=\"0 0 16 16\">\r\n        <path fill-rule=\"evenodd\" d=\"M10.354 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708 0z\"/>\r\n        <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911l-1.318.016z\"/>\r\n      </svg>\r\n    )\r\n  }\r\n\r\n  function demoteIcon() {\r\n      return(\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"red\" class=\"bi bi-patch-exclamation\" viewBox=\"0 0 16 16\">\r\n          <path d=\"M7.001 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.553.553 0 0 1-1.1 0L7.1 4.995z\"/>\r\n          <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911l-1.318.016z\"/>\r\n        </svg>\r\n      )\r\n  }\r\n  function noPromotionIcon() {\r\n      return(\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"blue\" class=\"bi bi-patch-minus\" viewBox=\"0 0 16 16\">\r\n          <path fill-rule=\"evenodd\" d=\"M5.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5z\"/>\r\n          <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911l-1.318.016z\"/>\r\n        </svg>\r\n      )\r\n  }\r\n  function modelLabel(modelName, promoteStatus) {\r\n      return(\r\n        <div className={(promoteStatus===1?\" promote\":(promoteStatus===-1?\" demote\":\"\"))}>\r\n          {modelName} {promoteStatus===1?promoteIcon():(promoteStatus===-1?demoteIcon():\"\")}\r\n        </div>\r\n      )\r\n  }\r\n  \r\n  function findFolderTreeNode(arr) { //loop through folder tree to find current model\r\n    return arr.reduce((a, item) => {\r\n      if (a) return a;\r\n      if (item.key === catalogModel.nodeID) return item;\r\n      if (item.nodes) return findFolderTreeNode(item.nodes);\r\n    }, null);\r\n  }\r\n\r\n  const RecurseFullFolderTree = (data) => {\r\n    var fullResults = [RecurseFolderTree(data,\"models\",\"models\")].concat([RecurseFolderTree(data,\"sources\",\"sources\")]);\r\n    return fullResults;\r\n  }\r\n  const RecurseFolderTree = (data, lastItem, modelPath) => {\r\n    var items = [];\r\n    var loopVar;\r\n    if(lastItem) {\r\n      loopVar = data[lastItem];\r\n    } else {\r\n      loopVar = data;\r\n    }\r\n    if(Object.keys(loopVar) && Object.keys(loopVar) && Object.keys(loopVar).length > 0 && (Object.keys(loopVar).length > 2 || !loopVar.nodeID)) {\r\n      for(var item in loopVar) {\r\n        if(item !== 'nodeID' && item !== 'promote_status') {\r\n          items.push(RecurseFolderTree(loopVar, item, modelPath + \".\" + item));\r\n        }\r\n      };\r\n      items = items.sort(function(a, b) {\r\n        if (a.label > b.label) {\r\n          return 1;\r\n        }\r\n        if (a.label < b.label) {\r\n          return -1;\r\n        }\r\n        return 0;\r\n      });\r\n      return(\r\n        {\"label\":lastItem, \"key\":modelPath, \"nodes\": items}\r\n      );\r\n    } else {\r\n      return(\r\n        {\"label\":modelLabel(lastItem, loopVar.promote_status), \"key\":loopVar.nodeID}\r\n      );\r\n    };\r\n  };\r\n\r\n  const RecurseFullDBTree = (data) => {\r\n    \r\n    var fullResults = PopulateDBTree(data.db_models);\r\n    return fullResults;\r\n  }\r\n  const PopulateDBTree = (data) => {\r\n    var items = [];\r\n\r\n    \r\n\r\n    for(var item in data) {\r\n      \r\n      if(items.filter(function(e) {return e.label === data[item].database}).length === 0 ||\r\n        items.filter(function(e) { return e.label === data[item].database})[0].length===0) {\r\n          items.push({\"label\": data[item].database, \"key\": data[item].database, \"nodes\": []});\r\n      }\r\n      \r\n      \r\n      var thisDB = items.filter(function(e) { return e.key === data[item].database})[0].nodes;\r\n      if(!thisDB || thisDB.length === 0 || thisDB.filter(function(e) { return e.label === data[item].schema}).length===0) {\r\n        thisDB.push({\"label\": data[item].schema, \"key\": data[item].schema, \"nodes\": []})\r\n      }\r\n      var thisSchema = thisDB.filter(function(e) { return e.key === data[item].schema})[0].nodes;\r\n      thisSchema.push({\"label\": modelLabel(data[item].name, data[item].promote_status), \"key\": data[item].nodeID})\r\n\r\n      // items[data[item].database].nodes[data[item].schema].nodes[data[item].name] = {\"label\": data[item].name, \"key\": data[item].schema}\r\n    }\r\n    function sortByLabel(a,b) {\r\n      if (a.label > b.label) {\r\n        return 1;\r\n      }\r\n      if (a.label < b.label) {\r\n        return -1;\r\n      }\r\n      return 0;\r\n    }\r\n    function sortByLabelChildren(a,b) {\r\n      if (a.label.props.children[0] > b.label.props.children[0]) {\r\n        return 1;\r\n      }\r\n      if (a.label.props.children[0] < b.label.props.children[0]) {\r\n        return -1;\r\n      }\r\n      return 0;\r\n    }\r\n    items = items.sort((a, b) => sortByLabel(a,b));\r\n    for(var itemDB in items) {\r\n      items[itemDB].nodes = items[itemDB].nodes.sort((a, b) => sortByLabel(a,b));\r\n      for(var itemDBSchema in items[itemDB].nodes) {\r\n        items[itemDB].nodes[itemDBSchema].nodes = items[itemDB].nodes[itemDBSchema].nodes.sort((a, b) => sortByLabelChildren(a,b));\r\n      }\r\n    }\r\n    return(items);\r\n  };\r\n\r\n  function updateMetadataModel (e) {\r\n    var metadataBody = {};\r\n    var newTags = [];\r\n    var newTagsWithPromotion = [];\r\n    switch(e.target.dataset.metadatafield) {\r\n      case \"Description\":\r\n        metadataBody = {\r\n          \"updateMethod\": \"yamlModelProperty\",\r\n          \"yaml_path\": catalogModel.yaml_path,\r\n          \"model_path\": catalogModel.model_path,\r\n          \"model\": catalogModel.name,\r\n          \"node_id\": catalogModel.nodeID,\r\n          \"property_name\": \"description\",\r\n          \"new_value\": e.target.innerText\r\n        }\r\n        setCatalogModel({\r\n          ...catalogModel,\r\n          \"description\": e.target.innerText\r\n        });\r\n      break;\r\n      case \"Promotion\":\r\n        newTags = [...catalogModel.tags];\r\n        newTagsWithPromotion = [...newTags];\r\n        if(e.newPromotionStatus===1) {\r\n          newTagsWithPromotion.push(props.serverConfig.promotion_tag)\r\n        } else if(e.newPromotionStatus===-1) {\r\n          newTagsWithPromotion.push(props.serverConfig.demotion_tag)\r\n        }\r\n        metadataBody = {\r\n          \"updateMethod\": \"yamlModelTags\",\r\n          \"yaml_path\": catalogModel.yaml_path,\r\n          \"model_path\": catalogModel.model_path,\r\n          \"model\": catalogModel.name,\r\n          \"node_id\": catalogModel.nodeID,\r\n          \"property_name\": \"tags\",\r\n          \"new_value\": newTagsWithPromotion,\r\n        }\r\n        setCatalogModel({\r\n          ...catalogModel,\r\n          \"promote_status\": e.newPromotionStatus\r\n        });\r\n        var newDBTree = [...dbTree]\r\n        var thisTreeNode = newDBTree.filter(node => node.key === catalogModel.database)[0].nodes.filter(node => node.key === catalogModel.schema)[0].nodes.filter(node => node.key === catalogModel.nodeID)[0]\r\n        thisTreeNode.label = modelLabel(catalogModel.name, e.newPromotionStatus);\r\n        setDBTree(newDBTree);\r\n        var newFolderTree = [...folderTree]\r\n\r\n        var thisFolderTreeNode = findFolderTreeNode(newFolderTree)\r\n        thisFolderTreeNode.label = modelLabel(catalogModel.name, e.newPromotionStatus);\r\n        setDBTree(newDBTree);\r\n\r\n        \r\n        // setDBTree()\r\n      break;\r\n      case \"Tags\":\r\n        if(e.target.innerText === \"None\") {\r\n          metadataBody = null;\r\n          break;\r\n        }\r\n        newTags = e.target.innerText.split(',').map(function(item) { // Split tags by commas, and remove any spaces if any\r\n          return item.trim();\r\n        });\r\n        newTagsWithPromotion = [...newTags];\r\n        if(catalogModel.promote_status===1) {\r\n          newTagsWithPromotion.push(props.serverConfig.promotion_tag)\r\n        } else if(catalogModel.promote_status===-1) {\r\n          newTagsWithPromotion.push(props.serverConfig.demotion_tag)\r\n        }\r\n        metadataBody = {\r\n          \"updateMethod\": \"yamlModelTags\",\r\n          \"yaml_path\": catalogModel.yaml_path,\r\n          \"model_path\": catalogModel.model_path,\r\n          \"model\": catalogModel.name,\r\n          \"node_id\": catalogModel.nodeID,\r\n          \"property_name\": \"tags\",\r\n          \"new_value\": newTagsWithPromotion,\r\n        }\r\n        setCatalogModel({\r\n          ...catalogModel,\r\n          \"tags\": newTags\r\n        });\r\n      break;\r\n      case \"ColumnDescription\":\r\n        metadataBody = {\r\n          \"updateMethod\": \"yamlModelColumnProperty\",\r\n          \"yaml_path\": catalogModel.yaml_path,\r\n          \"model_path\": catalogModel.model_path,\r\n          \"model\": catalogModel.name,\r\n          \"node_id\": catalogModel.nodeID,\r\n          \"column\": e.target.dataset.columnname,\r\n          \"property_name\": \"description\",\r\n          \"new_value\": e.target.innerText\r\n        }\r\n        setCatalogModel({\r\n          ...catalogModel,\r\n          columns: {\r\n            ...catalogModel.columns,\r\n            [e.target.dataset.columnname]: {\r\n              ...catalogModel.columns[e.target.dataset.columnname],\r\n              \"description\": e.target.innerText\r\n            },\r\n          }\r\n        })\r\n      break;\r\n      case \"ColumnTest\":\r\n        metadataBody = {\r\n          \"updateMethod\": \"yamlModelColumnTest\",\r\n          \"yaml_path\": catalogModel.yaml_path,\r\n          \"model_path\": catalogModel.model_path,\r\n          \"model\": catalogModel.name,\r\n          \"node_id\": catalogModel.nodeID,\r\n          \"column\": e.column,\r\n          \"new_value\": e.tests\r\n        }\r\n      // catalogModel is already updated by the tests process\r\n      break;\r\n      default:\r\n        // \r\n    }\r\n    if(metadataBody) {\r\n      // \r\n      fetch('/api/v1/update_metadata', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json',\r\n          'Authorization': 'Token ' + props.user.token,\r\n        },\r\n        body: JSON.stringify(metadataBody)\r\n      });\r\n    }\r\n  }\r\n\r\n  function lineageModal(lineage, selectModel) {\r\n    function LineageModal(lineage) {\r\n      const [show, setShow] = useState(false);\r\n    \r\n      const handleClose = () => setShow(false);\r\n      const handleShow = () => setShow(true);\r\n      // \r\n      // \r\n    \r\n      return (\r\n        <>\r\n          <Button className=\"tealButton\" onClick={handleShow}>\r\n            Show Lineage\r\n          </Button>\r\n    \r\n          <Modal show={show} onHide={handleClose} size=\"xl\">\r\n            <Modal.Header closeButton>\r\n              <Modal.Title>{catalogModel.name}</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body className=\"lineagebox\">\r\n              <LayoutFlow className=\"lineagebox\" lineageArray={lineage}/>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n              <Button variant=\"secondary\" onClick={handleClose}>\r\n                Close\r\n              </Button>\r\n            </Modal.Footer>\r\n          </Modal>\r\n        </>\r\n      );\r\n    }\r\n    return <LineageModal lineage={lineage}/>\r\n  }\r\n\r\n  function showCreatedBy() {\r\n    if(catalogModel.model_type===\"node\" && catalogModel.created_by) { \r\n      return(\r\n        <div className=\"row mt-md-3\">\r\n          <div className=\"col col-md-auto\">\r\n            Created: {catalogModel.created_by + (catalogModel.created_relative_date?\", \"+catalogModel.created_relative_date:null)} \r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  \r\n  }\r\n\r\n  function treePath(nodeID) {\r\n    let last;\r\n    let arrayPath = []\r\n    if(catalogModel.model_type === \"node\" && nodeID === catalogModel.nodeID) {\r\n      let modelPath = catalogModel.model_path.replaceAll('\\\\','/');\r\n      let obj = modelPath.substr(0,modelPath.lastIndexOf(('.'))).split('/').reduce((o, val) => {\r\n        if (typeof last == 'object') {\r\n          last = last[val] = {};\r\n          arrayPath.push(val)\r\n        } else {\r\n          last = o[val] = {};\r\n          arrayPath.push(val)\r\n        }\r\n      \r\n        return o;\r\n      }, {});\r\n    } else if(catalogModel.model_type === \"source\" && nodeID === catalogModel.nodeID) {\r\n      var removedProjectName = nodeID.split('.');\r\n      removedProjectName.splice(1,1);\r\n      removedProjectName[0] = 'sources'\r\n      let obj = removedProjectName.reduce((o, val) => {\r\n        if (typeof last == 'object') {\r\n          last = last[val] = {};\r\n          arrayPath.push(val)\r\n        } else {\r\n          last = o[val] = {};\r\n          arrayPath.push(val)\r\n        }\r\n      \r\n        return o;\r\n      }, {});\r\n    } else if(nodeID !== catalogModel.nodeID) {\r\n      var removedProjectName = nodeID.split('.');\r\n      let obj = removedProjectName.reduce((o, val) => {\r\n        if (typeof last == 'object') {\r\n          last = last[val] = {};\r\n          arrayPath.push(val)\r\n        } else {\r\n          last = o[val] = {};\r\n          arrayPath.push(val)\r\n        }\r\n      \r\n        return o;\r\n      }, {});\r\n    }\r\n    return arrayPath; \r\n  }\r\n  \r\n  function getTreeRef(nodeID) {\r\n    if(nodeID) {\r\n      var modelPath = treePath(nodeID);\r\n      var runningFullModel = false;\r\n      if(modelPath[modelPath.length-1] === catalogModel.name) {\r\n        modelPath.pop(); //remove last key, we'll add that manually\r\n        runningFullModel = true;\r\n      }\r\n      var strPath = modelPath[0] + \"/\";\r\n      var pathSoFar = modelPath[0] + \".\";\r\n      modelPath.splice(0,1); //remove first key, we'll add that manually\r\n      for(var thisModel in modelPath) {\r\n        strPath += pathSoFar + modelPath[thisModel] + \"/\";\r\n        pathSoFar += thisModel + \".\";\r\n      }\r\n      if(runningFullModel) {\r\n        strPath += nodeID;\r\n      } else {\r\n        strPath = strPath.slice(0,-1);\r\n      }\r\n      return strPath; //sources/sources.public/source.my_new_project.public.actor\r\n    } else return null;\r\n  }\r\n\r\n  function SearchPage() {\r\n    let { searchQuery } = useParams();\r\n    if(searchResults && searchResults.searchString === searchQuery) {\r\n      var selectSearchResult = (e,index) => {\r\n          history.push(\"/catalog/\"+searchResults.results[index].nodeID);\r\n      }\r\n      return(\r\n        <ShowSearchResults\r\n          searchResults = {searchResults}\r\n          resultSelectFunction = {selectSearchResult}\r\n        />\r\n      )\r\n      \r\n    } else {\r\n      getModelSearch(searchQuery, props.user)\r\n      .then(response => {\r\n        // \r\n        if(response.length===0 || response.error) {\r\n          setSearchResults([]);\r\n          return null;\r\n        }\r\n        if(response.searchString === window.location.href.split('/').pop()) {\r\n          //searchQuery and router don't update fast enough; only current url does\r\n          setSearchResults(response);\r\n        };\r\n      });\r\n      return(<div>Loading Search Results...</div>)\r\n    } \r\n  }\r\n\r\n  function LandingPage() {\r\n    function PromotedModels() {\r\n      let searchQuery = \"promoted\";\r\n      if(searchResults && searchResults.searchString === searchQuery) {\r\n        var selectSearchResult = (e,index) => {\r\n            history.push(\"/catalog/\"+searchResults.results[index].nodeID);\r\n        }\r\n        return(\r\n          <>\r\n            <ShowSearchResults\r\n              searchResults = {searchResults}\r\n              resultSelectFunction = {selectSearchResult}\r\n            />\r\n          </>\r\n        )\r\n        \r\n      } else {\r\n        getModelSearch(searchQuery, props.user)\r\n        .then(response => {\r\n          // \r\n          if(response.length===0 || response.error) {\r\n            setSearchResults([]);\r\n            return null;\r\n          }\r\n          if(response.searchString === searchQuery) {\r\n            //searchQuery and router don't update fast enough; only current url does\r\n            setSearchResults(response);\r\n          };\r\n        });\r\n        return(<div>Loading Promoted Queries...</div>)\r\n      } \r\n    }\r\n    return(\r\n      <Container>\r\n        <Card style={{ width: '24rem', marginTop: '30px' }}>\r\n          <Card.Header>\r\n            Promoted\r\n          </Card.Header>\r\n          <Card.Body>\r\n            <Card.Title>\r\n              Models promoted for general use:\r\n            </Card.Title>\r\n            <Card.Text>\r\n              <PromotedModels/>\r\n            </Card.Text>\r\n          </Card.Body>\r\n        </Card>\r\n      </Container>\r\n    )\r\n  }\r\n\r\n  function CatalogPage() {\r\n    let { catalogPage } = useParams();\r\n    \r\n    \r\n    if(Object.keys(catalogModel).length === 0 || catalogModel.nodeID !== catalogPage) {\r\n      getModel(catalogPage, props.user)\r\n      .then(response => {\r\n        // \r\n        if(!response.error) {\r\n          setCatalogModel(response);\r\n          if(rawModelTree) {\r\n            setFolderTree(RecurseFullFolderTree(rawModelTree));\r\n            // treeRef.current.resetOpenNodes(treeRef.current.state.openNodes,getTreeRef(catalogModel.nodeID));\r\n          }\r\n        }\r\n      });\r\n      \r\n      getDBTree(props.user)\r\n      .then(response => {\r\n        if(!response.error) {\r\n          setRawDBTree(response);\r\n          setDBTree(RecurseFullDBTree(response));\r\n          \r\n        }\r\n      })\r\n      return(<div>No Model Found</div>);\r\n    }\r\n    function showPromotionMenu(e) {\r\n      e.preventDefault();\r\n      show(e, {\r\n        props: {\r\n        }, id: \"promotionMenu\",\r\n      })\r\n    }\r\n\r\n    function setModelPromotion({event, props, data, triggerEvent}) {\r\n      var newPromotionStatus = 0;\r\n      if(event.target.innerText === \"Promote\") {\r\n        newPromotionStatus = 1;\r\n      } else if(event.target.innerText === \"Demote\") {\r\n        newPromotionStatus = -1;\r\n      }\r\n      updateMetadataModel({\r\n        \"newPromotionStatus\": newPromotionStatus,\r\n        \"target\": {\"dataset\": {\"metadatafield\": \"Promotion\"}}\r\n      });\r\n    }\r\n    \r\n    const tags = catalogModel.tags.length>0?catalogModel.tags.join(\", \"):null\r\n    return(\r\n      <Container className=\"catalogContainer display-block\">\r\n        <div className=\"row justify-content-md-left\">\r\n          <div className=\"col col-md-auto pr-md-3\">\r\n            <h3 className=\"mb-md-0\">\r\n              {catalogModel.name.toLowerCase()} <div style={{\"cursor\":\"pointer\"}} title={(catalogModel.promote_status===1?'Promoted as a reliable dataset for use. ':(catalogModel.promote_status===-1?'Demoted - not for general use. ':'Not yet promoted. ')) + 'Click to change.'} className=\"catalog_title_promotion\" onClick={(e) => showPromotionMenu(e)} onContextMenu={(e) => showPromotionMenu(e)}>{catalogModel.promote_status===1?promoteIcon():(catalogModel.promote_status===-1?demoteIcon():noPromotionIcon())}</div>\r\n            </h3>\r\n          </div>\r\n          <div className=\"col font-italic align-self-end pl-md-0\">\r\n            {catalogModel.materialization}\r\n          </div>\r\n          <div className=\"col align-self-end pl-md-0 text-right\">\r\n            tags: <i>\r\n              <ContentEditable\r\n                innerRef={tags}\r\n                html={tags}\r\n                onBlur={updateMetadataModel}\r\n                data-metadatafield=\"Tags\"\r\n                placeholder={\"Add comma-separated Tags\"}\r\n                style= {{display: \"inline\", minWidth: \"100px\"}}\r\n              />\r\n            </i>\r\n          </div>\r\n        </div>\r\n        <div className=\"row justify-content-between pt-md-1\">\r\n          <div className=\"col col-md-auto\">\r\n            {catalogModel.database.toLowerCase()}.{catalogModel.schema.toLowerCase()}.{catalogModel.name.toLowerCase()}\r\n          </div>\r\n          <div className=\"col col-md-auto\">\r\n            {catalogModel.row_count?Number(catalogModel.row_count).toLocaleString()+\" rows\":null}\r\n          </div>\r\n        </div>\r\n        {showCreatedBy()}\r\n        <div className=\"row mt-md-3\">\r\n          <div className=\"col col-md-auto\">\r\n            <ContentEditable\r\n              innerRef={catalogModel.description}\r\n              html={catalogDescription()}\r\n              onBlur={updateMetadataModel}\r\n              data-metadatafield=\"Description\"\r\n              placeholder={\"Add a description\"}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"row mt-md-3\">\r\n          <div className=\"col col-md-auto\">\r\n            {lineageModal(catalogModel.lineage, props.selectModel)}\r\n          </div>\r\n        </div>\r\n        <Accordion className=\"mt-md-3\" defaultActiveKey=\"0\">\r\n          <Card>\r\n            <Card.Header>\r\n              <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"0\">\r\n                Columns\r\n              </Accordion.Toggle>\r\n            </Card.Header>\r\n            <Accordion.Collapse eventKey=\"0\">\r\n              <div className=\"container\">\r\n                {catalogColumns()}\r\n              </div>\r\n            </Accordion.Collapse>\r\n          </Card>\r\n          <Card>\r\n            <Card.Header>\r\n              <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"1\">\r\n                SQL\r\n              </Accordion.Toggle>\r\n            </Card.Header>\r\n            <Accordion.Collapse eventKey=\"1\">\r\n              <div className=\"container\">\r\n                <div className=\"row mt-md-3 mb-md-3\">\r\n                  <div className=\"col col-md-auto\">\r\n                    <Tabs defaultActiveKey=\"raw\" id=\"uncontrolled-tab-example\" className=\"ml-md-1\">\r\n                      <Tab eventKey=\"raw\" title=\"raw SQL\" className=\"py-md-3 catalogSQL\">\r\n                        {catalogModel.raw_sql}\r\n                      </Tab>\r\n                      <Tab eventKey=\"processed\" title=\"processed SQL\" className=\"py-md-3 catalogSQL\">\r\n                        {catalogModel.compiled_sql}\r\n                      </Tab>\r\n                    </Tabs>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Accordion.Collapse>\r\n          </Card>\r\n          <Card>\r\n            <Card.Header>\r\n              <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"2\">\r\n                Code Change History\r\n              </Accordion.Toggle>\r\n            </Card.Header>\r\n            <Accordion.Collapse eventKey=\"2\">\r\n              <div className=\"container\">\r\n                <div className=\"row mt-md-3 mb-md-3\">\r\n                  <div className=\"col col-md-auto\">\r\n                    {nodeContributors()}\r\n                  </div>\r\n                </div>\r\n                <div className=\"row mt-md-3 mb-md-3\">\r\n                  <div className=\"col col-md-auto\">\r\n                    {nodeHistory()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Accordion.Collapse>\r\n          </Card>\r\n          <Card>\r\n            <Card.Header>\r\n              <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"3\">\r\n                Depends On\r\n              </Accordion.Toggle>\r\n            </Card.Header>\r\n            <Accordion.Collapse eventKey=\"3\">\r\n              <div className=\"container\">\r\n                <div className=\"row mt-md-3 mb-md-3\">\r\n                  <div className=\"col col-md-auto\">\r\n                    {catalogDependsOn()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Accordion.Collapse>\r\n          </Card>\r\n          <Card>\r\n            <Card.Header>\r\n              <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"4\">\r\n                Dependencies\r\n              </Accordion.Toggle>\r\n            </Card.Header>\r\n            <Accordion.Collapse eventKey=\"4\">\r\n              <div className=\"container\">\r\n                <div className=\"row mt-md-3 mb-md-3\">\r\n                  <div className=\"col col-md-auto\">\r\n                    {catalogDependencies()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Accordion.Collapse>\r\n          </Card>\r\n        </Accordion>\r\n        <AddRefTest/>\r\n        <Menu id={\"promotionMenu\"}>\r\n          <Item id=\"promote_model\" onClick={setModelPromotion}>Promote</Item>\r\n          <Item id=\"remove_promotion\" onClick={setModelPromotion}>Default</Item>\r\n          <Item id=\"demote_model\" onClick={setModelPromotion}>Demote</Item>\r\n        </Menu>\r\n      </Container>\r\n    )\r\n  }\r\n  \r\n  const NavigationDrawer = (props) => {\r\n    const [open, setOpen] = useState(false);\r\n  \r\n    const handleToggle = () => setOpen(!open);\r\n\r\n    var treeModelClick = (e) => {\r\n      \r\n      if(e.hasNodes === false) {\r\n        history.push(\"/catalog/\"+e.key.split(\"/\").pop());\r\n      } else {\r\n        treeFolderRef.current.resetOpenNodes(treeFolderRef.current.state.openNodes,getTreeRef(catalogModel.nodeID));\r\n        treeFolderRef.current.toggleNode(e.key);\r\n        treeDBRef.current.resetOpenNodes(treeDBRef.current.state.openNodes,[catalogModel.database, catalogModel.database+\"/\"+catalogModel.schema]);\r\n        treeDBRef.current.toggleNode(e.key);\r\n      }\r\n    };\r\n\r\n    function currentOpenNodes(nodeID) {\r\n      var splitNodeID = []\r\n      var thisStep = {}\r\n      var openNodes = []\r\n      if(nodeID) {\r\n      splitNodeID = treePath(nodeID);\r\n      var stepsSoFar = splitNodeID[0];\r\n      openNodes.push(splitNodeID[0]);\r\n      splitNodeID.splice(0,1);\r\n      for(thisStep in splitNodeID) {\r\n        openNodes.push(getTreeRef(stepsSoFar+\".\"+splitNodeID[thisStep]))\r\n        stepsSoFar += \".\"+splitNodeID[thisStep]\r\n      }\r\n      return openNodes;\r\n    } else return null;\r\n    }\r\n    return (\r\n      <Drawer { ...props }>\r\n        <Drawer.Toggle onClick={ handleToggle } />\r\n  \r\n        <Collapse in={ open }>\r\n          <Drawer.Overflow>\r\n              <Drawer.Nav>\r\n                <Tabs activeKey={treeTab} id=\"treemenu\" onSelect={(k) => setTreeTab(k)} className=\"treeTabs nav nav-tabs nav-justified\">\r\n                  <Tab eventKey=\"folders\" title=\"Project View\">\r\n                    <TreeMenu\r\n                      data={folderTree}\r\n                      initialActiveKey={getTreeRef(catalogModel.nodeID)}\r\n                      initialOpenNodes={currentOpenNodes(catalogModel.nodeID)}\r\n                      onClickItem={treeModelClick}\r\n                      ref={treeFolderRef}\r\n                      hasSearch={false}\r\n                    >\r\n                    </TreeMenu>\r\n                  </Tab>\r\n                  <Tab eventKey=\"databases\" title=\"Database View\">\r\n                    <TreeMenu\r\n                      data={dbTree}\r\n                      initialActiveKey={catalogModel.database+\"/\"+catalogModel.schema+\"/\"+catalogModel.nodeID}\r\n                      initialOpenNodes={[catalogModel.database, catalogModel.database+\"/\"+catalogModel.schema]}\r\n                      onClickItem={treeModelClick}\r\n                      ref={treeDBRef}\r\n                      hasSearch={false}\r\n                    >\r\n                    </TreeMenu>\r\n                  </Tab>\r\n                </Tabs>\r\n              </Drawer.Nav>\r\n          </Drawer.Overflow>\r\n        </Collapse>\r\n      </Drawer>\r\n    );\r\n  };\r\n  \r\n    return (\r\n      <Container fluid>\r\n        <Row className=\"flex-xl-nowrap\">\r\n          <Col as={ NavigationDrawer } xs={ 12 } md={ 4 } lg={ 3 } />\r\n          <Col>\r\n            <Switch>\r\n              <Route exact path = {path}>\r\n                <LandingPage/>\r\n              </Route>\r\n              <Route path={`${path}/search/:searchQuery`}>\r\n                <SearchPage/>\r\n              </Route>\r\n              <Route path={`${path}/search/`}>\r\n                <SearchPage/>\r\n              </Route>\r\n              <Route path={`${path}/:catalogPage`}>\r\n                <CatalogPage/>\r\n              </Route>\r\n            </Switch>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    );\r\n}\r\n","export async function getSSH(user) {\r\n    const response = await fetch('/api/v1/get_ssh', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response;\r\n}","export async function getGenerateSSH(user) {\r\n    const response = await fetch('/api/v1/generate_ssh', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response;\r\n}","export async function getOpenGit(user) {\r\n    const response = await fetch('/api/v1/open_git_connection', {headers: {Authorization: \"Token \" + user.token}});\r\n    return await response;\r\n}","export async function getCheckDBTConnection(user) {\r\n    // console.log(user);\r\n    const response = await fetch('/api/v1/check_dbt_connection', {\r\n        method: 'GET', \r\n        headers: {\r\n                Authorization: \"Token \" + user.token\r\n            }\r\n    })\r\n    return await response;\r\n}","import React, { Component } from 'react';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link,\r\n  Redirect,\r\n  useHistory,\r\n  useLocation\r\n} from \"react-router-dom\";\r\nimport {Collapse, Container, Row, Col } from 'react-bootstrap';\r\nimport { io } from \"socket.io-client\";\r\n// import logo from './logo.svg';\r\nimport './App.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n// import JsonFilenameInput from './components/JsonFilenameInput'\r\nimport Login from './components/Login';\r\nimport Config from './components/Config';\r\nimport ModelBuilder from './components/ModelBuilder';\r\nimport { NavBar } from './components/NavBar';\r\nimport Catalog from './components/Catalog';\r\nimport { getSSH } from \"./services/getSSH\";\r\nimport { getUserConfig } from \"./services/getUserConfig\";\r\nimport { getServerConfig } from \"./services/getServerConfig\";\r\nimport { getGenerateSSH } from \"./services/getGenerateSSH\";\r\nimport { getOpenGit } from \"./services/getOpenGit\";\r\nimport { getCheckDBTConnection } from \"./services/getCheckDBTConnection\";\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.modelBuilder = React.createRef();\r\n    var hostVersion = '';\r\n    var tempUser = {};\r\n    if(window.location.port === '8080') { // python version\r\n      // console.log('python')\r\n      hostVersion = 'python'\r\n      tempUser = {\"token\":\"\"}\r\n      console.log(\"Getting Server Config\")\r\n      getServerConfig(tempUser)\r\n        .then(response => {\r\n          console.log(\"Received Server Config\")\r\n          this.setState({\"serverConfig\": response})\r\n        });\r\n    } else {\r\n      // console.log('node')\r\n      hostVersion = 'node'\r\n      if(sessionStorage.getItem(\"user\")) {\r\n        getUserConfig(JSON.parse(sessionStorage.getItem(\"user\")).user)\r\n        .then(response => {\r\n          this.setState({\"userConfig\": response.user})\r\n        });\r\n        tempUser = JSON.parse(sessionStorage.getItem(\"user\")).user;\r\n        \r\n      }\r\n    }\r\n    document.title = 'Tāngata';\r\n    this.state = {\r\n      appState: \"Catalog\",\r\n      \"hostVersion\": hostVersion,\r\n      modelBuilder: {\r\n        \"models\": [{\"name\": \"humans\"},{\"name\":\"abductions\"}],\r\n        \"logState\": false,\r\n        \"openSQLPanel\": false,\r\n        \"addModel\": {}\r\n      },\r\n      contextMenuOpen: false,\r\n      catalogModel: {},\r\n      sshKey: \"\",\r\n      user: tempUser,\r\n      userConfig: {},\r\n      serverConfig: {},\r\n      userMessages: []\r\n    };\r\n  }\r\n  \r\n  \r\n\r\n  handleAllClicks = (e) => {\r\n    // console.log(\"handleAllClicks\");\r\n    if(this.state.contextMenuOpen===true) {\r\n      this.setState({contextMenuOpen: false});\r\n    }\r\n  };\r\n\r\n  // addModelToModelBuilder = (nodeId) => {\r\n\r\n  //   this.setState({modelBuilder: {...this.state.modelBuilder, \"addModel\": \r\n  // }\r\n\r\n  // selectModel = (nodeId) => {\r\n  //   // console.log(\"selectModel\");\r\n  //   // console.log(nodeId);\r\n  //   getModel(nodeId, this.state.user)\r\n  //     .then(response => {\r\n  //       // console.log(response)\r\n  //       if(!response.error) {\r\n  //         if(this.state.appState === \"Catalog\") {\r\n  //           this.setState({\"catalogModel\":response})\r\n  //         }\r\n  //       }\r\n        \r\n  //     });\r\n  // }\r\n\r\n  openContextMenu = (openState) => {\r\n    // console.log(\"openContextMenu\");\r\n    if(openState===true) {\r\n      this.setState({contextMenuOpen: true});\r\n    } else {\r\n      this.setState({contextMenuOpen: false});\r\n    }\r\n  }\r\n\r\n  logState = () => {\r\n    this.setState({\"logState\": true})\r\n  }\r\n  openSQLPanel = () => {\r\n    this.setState({\"openSQLPanel\": true})\r\n  }\r\n\r\n  addModel = () => {\r\n    // console.log(\"Not yet implemented\"); //TODO: add input model from catalog\r\n  }\r\n\r\n  openModelBuilder = () => {\r\n    this.setState({\"appState\": \"ModelBuilder\"})\r\n  }\r\n\r\n  openCatalog = () => {\r\n    this.setState({\"appState\": \"Catalog\"})\r\n  }\r\n\r\n  openConfig = () => {\r\n    this.setState({\"appState\": \"Config\"})\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if(this.state.logState === true) {\r\n      console.log(\"App State:\");\r\n      console.log(this.state);\r\n      this.setState({\"logState\": false})\r\n    }\r\n    if(this.state.openSQLPanel === true) this.setState({\"openSQLPanel\": false});\r\n  }\r\n  // componentDidMount() {\r\n  //   if(window.location.port === '8080') { // python version\r\n  //     console.log('python')\r\n  //     this.setState({\"hostVersion\": \"python\"})\r\n  //   } else {\r\n  //     console.log('node')\r\n  //     this.setState({\"hostVersion\": \"node\"})\r\n  //   }\r\n  //   if(Object.keys(this.state.user).length === 0) {\r\n  //     if(sessionStorage.getItem(\"user\")) {\r\n  //       getUserConfig(JSON.parse(sessionStorage.getItem(\"user\")).user)\r\n  //       .then(response => {\r\n  //         this.setUserConfig(response.user);\r\n  //       });\r\n  //       this.setUser(JSON.parse(sessionStorage.getItem(\"user\")))\r\n  //     }\r\n      \r\n  //   }\r\n  //   document.title = 'Tāngata';\r\n  // }\r\n\r\n  setUser = (newUser) => {\r\n    // console.log(\"setUser\");\r\n    this.setState({\"user\": newUser.user})\r\n  }\r\n  setUserConfig = (newUserConfig) => {\r\n    this.setState({\"userConfig\": newUserConfig})\r\n  }\r\n  setServerConfig = (newServerConfig) => {\r\n    this.setState({\"serverConfig\": newServerConfig})\r\n  }\r\n\r\n  setSSHKey = () => {\r\n    getSSH(this.state.user)\r\n    .then(response=> response.text())\r\n    .then(responseText => {\r\n      // console.log(responseText);\r\n      this.setState({\"sshKey\": responseText});\r\n    });\r\n  }\r\n\r\n  generateSSHKey = () => {\r\n    getGenerateSSH(this.state.user)\r\n    .then(response=> response.text())\r\n    .then(responseText => {\r\n      this.setState({\"sshKey\": responseText});\r\n    });\r\n  }\r\n\r\n  openGitConnection = () => {\r\n    getOpenGit(this.state.user)\r\n    .then(response=> response.text())\r\n    .then(responseText => {\r\n      return responseText;\r\n    });\r\n  }\r\n  checkDBTConnection = () => {\r\n    getCheckDBTConnection(this.state.user)\r\n    .then(response=> {\r\n      // console.log(response);\r\n      if(response.ok === true) {\r\n        // console.log(\"Success\");\r\n        toast.success(\"DBT_ Connection Successful.\");\r\n      } else {\r\n        response.text()\r\n        .then(responseText=> {\r\n          // console.log(response);\r\n          // console.log(responseText);\r\n          toast.error(\"DBT_ Connection Failed: \" + responseText, {\r\n            autoClose: 10000,\r\n            });\r\n          // toast(response);\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  toastSender = (message, toastType) => {\r\n    if(toastType === \"error\") {\r\n      toast.error(message);\r\n    } else if (toastType === \"success\") {\r\n      toast.success(message);\r\n    } else {\r\n      toast(message);\r\n    }\r\n  }\r\n  \r\n  clearUserMessages = () => {\r\n    this.setState({\"userMessages\": []})\r\n  } \r\n\r\n  LoginRoute = ({ children, ...rest }) => {\r\n    // console.log(this.state.hostVersion);\r\n    // console.log(Object.keys(this.state.user).length)\r\n    // console.log(rest);\r\n    return (\r\n      <Route\r\n        {...rest}\r\n        render={({ location }) =>\r\n          (this.state.hostVersion === 'python' || Object.keys(this.state.user).length > 0) ? (\r\n            children\r\n          ) : (\r\n            <Redirect\r\n              to={{\r\n                pathname: \"/login\"\r\n              }}\r\n            />\r\n          )\r\n        }\r\n      />\r\n    );\r\n  }\r\n  \r\n  render() {\r\n    // console.log(window.location)\r\n    // console.log(window.location.port)\r\n    var socket = null\r\n    socket = io({\r\n      auth: (cb) => {\r\n        cb({\r\n          token: this.state.user\r\n        });\r\n      }\r\n    });\r\n    socket.on(\"connect\", () => {\r\n      // either with send()\r\n      socket.send(\"Hello!\");\r\n    });\r\n    socket.on(\"toast\", (data) => {\r\n      // console.log(\"Toast received\");\r\n      this.toastSender(data.message, data.type);\r\n    });\r\n\r\n    return (\r\n      <Router>\r\n        <div id=\"main\">\r\n          <Switch>\r\n            <Route exact path=\"/\">\r\n              <Redirect to=\"/catalog\"/>\r\n            </Route>\r\n            <Route path=\"/login\">\r\n              <Login\r\n                setUser={this.setUser}\r\n                setUserConfig={this.setUserConfig}\r\n                setServerConfig={this.setServerConfig}\r\n                user={this.state.user}\r\n                appState={this.state.appState}\r\n              />\r\n            </Route>\r\n            <this.LoginRoute path={[\"/catalog\",\"/search\"]}>\r\n              <NavBar\r\n                addModel={this.addModel}\r\n                hostVersion={this.state.hostVersion}\r\n                logState={this.logState}\r\n                openSQLPanel={this.openSQLPanel}\r\n                openModelBuilder={this.openModelBuilder}\r\n                openCatalog={this.openCatalog}\r\n                openConfig={this.openConfig}\r\n                appState={this.state.appState}\r\n                openContextMenu={this.openContextMenu}\r\n                contextMenuOpen={this.state.contextMenuOpen}\r\n                selectModel={this.selectModel}\r\n                user={this.state.user}\r\n                setUser={this.setUser}\r\n                userConfig={this.state.userConfig}\r\n                setUserConfig={this.setUserConfig}\r\n              />\r\n              <div className=\"body\">\r\n                <Catalog\r\n                  appState={this.state.appState}\r\n                  catalogModel={this.state.catalogModel}\r\n                  selectModel={this.selectModel}\r\n                  user={this.state.user}\r\n                  serverConfig={this.state.serverConfig}\r\n                  hostVersion={this.state.hostVersion}\r\n                />\r\n              </div>\r\n            </this.LoginRoute>\r\n            <this.LoginRoute path=\"/config\">\r\n              <NavBar\r\n                addModel={this.addModel}\r\n                logState={this.logState}\r\n                openSQLPanel={this.openSQLPanel}\r\n                openModelBuilder={this.openModelBuilder}\r\n                openCatalog={this.openCatalog}\r\n                openConfig={this.openConfig}\r\n                appState={this.state.appState}\r\n                openContextMenu={this.openContextMenu}\r\n                contextMenuOpen={this.state.contextMenuOpen}\r\n                selectModel={this.selectModel}\r\n                user={this.state.user}\r\n                setUser={this.setUser}\r\n                userConfig={this.state.userConfig}\r\n                setUserConfig={this.setUserConfig}\r\n              />\r\n              <div className=\"body\">\r\n                <Config\r\n                  appState={this.state.appState}\r\n                  user={this.state.user}\r\n                  hostVersion={this.state.hostVersion}\r\n                  userConfig={this.state.userConfig}\r\n                  setUserConfig={this.setUserConfig}\r\n                  serverConfig={this.state.serverConfig}\r\n                  setServerConfig={this.setServerConfig}\r\n                  sshKey={this.state.sshKey}\r\n                  setSSHKey={this.setSSHKey}\r\n                  generateSSHKey={this.generateSSHKey}\r\n                  openGitConnection={this.openGitConnection}\r\n                  checkDBTConnection={this.checkDBTConnection}\r\n                  toastSender={this.toastSender}\r\n                />\r\n              </div>\r\n            </this.LoginRoute>\r\n          </Switch>\r\n          <ToastContainer\r\n            position=\"bottom-center\"\r\n            autoClose={8000}\r\n            hideProgressBar={false}\r\n            newestOnTop={false}\r\n            closeOnClick\r\n            rtl={false}\r\n            pauseOnFocusLoss\r\n            draggable\r\n            pauseOnHover\r\n          />\r\n        </div>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}